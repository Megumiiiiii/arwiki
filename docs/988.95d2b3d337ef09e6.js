"use strict";(self.webpackChunkarwiki=self.webpackChunkarwiki||[]).push([[988],{55988:(jt,K,u)=>{u.r(K),u.d(K,{ModeratorsModule:()=>Rt});var f=u(36895),X=u(37101),v=u(89299),W=u(3870),x=u(39646),m=u(63900),V=u(70262),e=u(94650),I=u(32511),y=u(68853),M=u(75501),U=u(17009),O=u(69817);let z=(()=>{class a{constructor(t,n,r,o,s){this._auth=t,this._arweave=n,this._arwikiTokenContract=r,this._snackBar=o,this._userSettings=s}canActivate(t,n){return this.isUserModerator()}canActivateChild(t,n){return this.isUserModerator()}isUserModerator(){const t=this._auth.getMainAddressSnapshot();return this._userSettings.updateMainToolbarLoading(!0),this._arwikiTokenContract.getAdminList().pipe((0,m.w)(n=>{const r=n.indexOf(t)>=0;return this._auth.setAdminList(n),this._userSettings.updateMainToolbarLoading(!1),r?(0,x.of)(!0):(this.message("You are not a moderator!","error"),(0,x.of)(!1))}),(0,V.K)(n=>(this.message(n,"error"),(0,x.of)(!1))))}message(t,n="",r){this._snackBar.open(t,"X",{duration:4e3,horizontalPosition:"center",verticalPosition:r,panelClass:n})}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(I.e),e.LFG(y.N),e.LFG(M.d),e.LFG(U.ux),e.LFG(O.s))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var h=u(15861),P=u(50727),$=u(31783),D=u(22333),w=u(65938),Z=u(4859),k=u(97392),S=u(59549),H=u(44144);let ee=(()=>{class a{constructor(t){this.data=t}ngOnInit(){}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(w.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-dialog-reject-reason"]],decls:18,vars:3,consts:[["mat-dialog-title",""],[1,"red","title-icon"],["appearance","outline",1,"txt-reason"],["matInput","",1,"txt-reason"],["reason",""],["align","end"],["mat-button","",3,"disabled","mat-dialog-close"],["mat-button","","mat-dialog-close","","cdkFocusInitial",""]],template:function(t,n){if(1&t&&(e.TgZ(0,"h2",0)(1,"mat-icon",1),e._uU(2,"delete"),e.qZA(),e.TgZ(3,"span"),e._uU(4,"Reject page"),e.qZA()(),e.TgZ(5,"mat-dialog-content")(6,"p"),e._uU(7),e.qZA(),e.TgZ(8,"mat-form-field",2)(9,"mat-label"),e._uU(10,"Reason"),e.qZA(),e._UZ(11,"textarea",3,4),e.qZA()(),e.TgZ(13,"mat-dialog-actions",5)(14,"button",6),e._uU(15,"Alright! Let's do it!"),e.qZA(),e.TgZ(16,"button",7),e._uU(17,"Cancel"),e.qZA()()),2&t){const r=e.MAs(12);e.xp6(7),e.hij("You are about to reject a page with tx id ",n.data.id,". Do you want to proceed? Please add a reason to continue."),e.xp6(7),e.Q6J("disabled",!r.value)("mat-dialog-close",r.value)}},dependencies:[w.ZT,w.uh,w.xY,w.H8,Z.lW,k.Hw,S.KE,S.hX,H.Nt],styles:[".title-icon[_ngcontent-%COMP%]{font-size:40px;line-height:40px;width:40px;height:40px;vertical-align:middle}.mat-dialog-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:12px;vertical-align:middle;font-size:26px;font-family:Roboto Mono,monospace;line-height:38px}.txt-reason[_ngcontent-%COMP%]{width:100%}"]}),a})();var N=u(51614),L=u(89716),C=u(38952),Q=u(10266),q=u(51572),R=u(73546),j=u(97134),te=u(83683),Y=u(13081);let E=(()=>{class a{constructor(t,n,r){this._location=t,this._userSettings=n,this._route=r,this.title="",this.routerLang=""}ngOnInit(){this._route.paramMap.subscribe(t=>{this.routerLang=t.get("lang")})}goBack(){this._location.back()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(f.Ye),e.Y36(O.s),e.Y36(v.gz))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-moderators-menu"]],inputs:{title:"title"},decls:17,vars:7,consts:[["color","secondary",1,"fadeIn","moderatorsBreadcrumb"],["aria-hidden","false","aria-label","Moderators"],[1,"menu-spacer"],[1,"container","mb20"],[1,"row"],[1,"page-title","col-12","col-md-9"],[1,"text-right","page-title-buttons","col-12","col-md-3"],["type","button","mat-button","","color","primary",1,"ml10","btn-toolbar2",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"mat-toolbar",0)(1,"mat-icon",1),e._uU(2,"admin_panel_settings"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e._UZ(6,"span",2),e.qZA(),e.TgZ(7,"div",3)(8,"div",4)(9,"h1",5),e._uU(10),e.qZA(),e.TgZ(11,"div",6)(12,"button",7),e.NdJ("click",function(){return n.goBack()}),e.TgZ(13,"mat-icon"),e._uU(14,"navigate_before"),e.qZA(),e._uU(15),e.ALo(16,"translate"),e.qZA()()()()),2&t&&(e.xp6(4),e.hij("\xa0",e.lcZ(5,3,"MODERATORS.LABEL_TOOLBAR_TITLE"),""),e.xp6(6),e.hij(" ",n.title," "),e.xp6(5),e.hij(" ",e.lcZ(16,5,"CREATE_PAGE.FRM_BTN_GOBACK")," "))},dependencies:[Z.lW,k.Hw,te.Ye,Y.X$],styles:[".page-title[_ngcontent-%COMP%], .page-title-buttons[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:20px}.btn-toolbar2[_ngcontent-%COMP%]{color:inherit}.moderatorsBreadcrumb[_ngcontent-%COMP%]{margin-top:54px;margin-bottom:40px}@media (min-width: 600px){.moderatorsBreadcrumb[_ngcontent-%COMP%]{margin-top:64px}}mat-toolbar[_ngcontent-%COMP%]{font-family:Roboto Mono,monospace}.mb20[_ngcontent-%COMP%]{margin-bottom:20px}"]}),a})();function ne(a,i){1&a&&e._UZ(0,"mat-spinner",5)}function ae(a,i){1&a&&(e.TgZ(0,"div",9),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"MODERATORS.LABEL_NO_RESULTS")," "))}function ie(a,i){if(1&a&&(e.TgZ(0,"mat-card",24),e._UZ(1,"img",25),e.qZA()),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(1),e.s9C("src",n.baseURL+n.pages[t].img,e.LSH)}}function oe(a,i){1&a&&(e.TgZ(0,"div",26)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&a&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_TX_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_TX_PENDING")," "))}function re(a,i){if(1&a&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_HEIGHT"),":"),e.xp6(2),e.hij(" ",n.pages[t].block.height," ")}}function se(a,i){if(1&a&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"date"),e.qZA()),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_TIMESTAMP"),":"),e.xp6(2),e.hij(" ",e.xi3(5,4,n.timestampToDate(n.pages[t].block.timestamp),"short")," ")}}function ge(a,i){if(1&a&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_ARVERIFY_SCORE"),": "),e.xp6(2),e.hij(" ",n.arverifyProcessedAddressesMap[n.pages[t].owner].percentage," % ")}}function ce(a,i){1&a&&(e.TgZ(0,"div",27)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"mat-icon"),e._uU(5,"verified_user"),e.qZA(),e._uU(6),e.ALo(7,"translate"),e.qZA()),2&a&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_OWNER_STATUS"),": "),e.xp6(4),e.hij(" ",e.lcZ(7,4,"PAGE.STATUS_ADDRESS_VERIFIED")," "))}function pe(a,i){1&a&&(e.TgZ(0,"div",26)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&a&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_OWNER_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_ADDRESS_NOTVERIFIED")," "))}function de(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"div",10)(1,"mat-card")(2,"h2",11),e._uU(3),e.qZA(),e.YNc(4,ie,2,1,"mat-card",12),e.TgZ(5,"div"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"div"),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"div"),e._uU(15),e.qZA(),e._UZ(16,"hr",13),e.YNc(17,oe,6,6,"div",14),e.TgZ(18,"div",15)(19,"app-arweave-address",16),e._uU(20),e.ALo(21,"translate"),e.qZA()(),e.TgZ(22,"div",15)(23,"app-arweave-address",17),e._uU(24),e.ALo(25,"translate"),e.qZA()(),e.YNc(26,re,5,4,"div",18),e.YNc(27,se,6,7,"div",18),e.YNc(28,ge,5,4,"div",18),e.YNc(29,ce,8,6,"div",19),e.YNc(30,pe,6,6,"div",14),e.TgZ(31,"div",20)(32,"a",21),e.NdJ("click",function(){const o=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.confirmValidateArWikiPage(s.pages[o].slug,s.pages[o].id,s.pages[o].category,s.pages[o].value,s.pages[o].owner))}),e.TgZ(33,"mat-icon"),e._uU(34,"done"),e.qZA(),e._uU(35," Approve "),e.qZA(),e._uU(36," \xa0 "),e.TgZ(37,"a",22),e.NdJ("click",function(){const o=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.confirmRejectArWikiPage(s.pages[o].slug,s.pages[o].id))}),e.TgZ(38,"mat-icon"),e._uU(39,"delete"),e.qZA(),e._uU(40," Reject "),e.qZA(),e._uU(41," \xa0 "),e.TgZ(42,"a",23)(43,"mat-icon"),e._uU(44,"visibility"),e.qZA(),e._uU(45," Preview "),e.qZA()()()()}if(2&a){const t=i.$implicit,n=e.oxw(2);e.xp6(2),e.MGl("routerLink","../../preview/",n.pages[t].id,""),e.xp6(1),e.hij(" ",n.pages[t].title," "),e.xp6(1),e.Q6J("ngIf",n.pages[t].img),e.xp6(2),e.AsE(" ",e.lcZ(7,22,"PAGE.LABEL_SLUG"),": ",n.pages[t].slug," "),e.xp6(3),e.AsE(" ",e.lcZ(10,24,"PAGE.LABEL_CATEGORY"),": ",n.pages[t].category," "),e.xp6(3),e.AsE(" ",e.lcZ(13,26,"PAGE.LABEL_LANGUAGE"),": ",n.pages[t].language," "),e.xp6(3),e.hij(" Page value: ",n.pages[t].value," $WIKI "),e.xp6(2),e.Q6J("ngIf",!n.pages[t].block||!n.pages[t].block.height),e.xp6(2),e.Q6J("address",n.pages[t].id)("isAddress",!1),e.xp6(1),e.hij("",e.lcZ(21,28,"PAGE.LABEL_ID"),": "),e.xp6(3),e.Q6J("address",n.pages[t].owner),e.xp6(1),e.hij("",e.lcZ(25,30,"PAGE.LABEL_OWNER"),": "),e.xp6(2),e.Q6J("ngIf",n.pages[t].block&&n.pages[t].block.height),e.xp6(1),e.Q6J("ngIf",n.pages[t].block&&n.pages[t].block.timestamp),e.xp6(1),e.Q6J("ngIf",n.arverifyProcessedAddressesMap[n.pages[t].owner]&&n.arverifyProcessedAddressesMap[n.pages[t].owner].percentage),e.xp6(1),e.Q6J("ngIf",n.arverifyProcessedAddressesMap[n.pages[t].owner]&&n.arverifyProcessedAddressesMap[n.pages[t].owner].verified),e.xp6(1),e.Q6J("ngIf",!n.arverifyProcessedAddressesMap[n.pages[t].owner]||!n.arverifyProcessedAddressesMap[n.pages[t].owner].verified),e.xp6(12),e.MGl("routerLink","../../preview/",n.pages[t].id,"")}}function le(a,i){if(1&a&&(e.TgZ(0,"div",6),e.YNc(1,ae,3,3,"div",7),e.YNc(2,de,46,32,"div",8),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(t.loadingPendingPages||t.pages&&t.getKeys(t.pages).length)),e.xp6(1),e.Q6J("ngForOf",t.getKeys(t.pages))}}function ue(a,i){1&a&&(e.TgZ(0,"div",28)(1,"div",29),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",30),e._uU(4,"\u{1f680} Hold on! We are almost there!"),e.qZA()()())}function _e(a,i){if(1&a&&(e.TgZ(0,"div",28)(1,"div",29)(2,"h1",30),e._uU(3,"\u{1f973} Page successfully approved!"),e.qZA(),e.TgZ(4,"p",30),e._uU(5),e.qZA(),e.TgZ(6,"a",31),e._uU(7),e.qZA()()()),2&a){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.insertPageTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.insertPageTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.insertPageTxMessage," ")}}function me(a,i){if(1&a&&(e.TgZ(0,"div",28)(1,"div",29)(2,"h1",30),e._uU(3,"Oops! something went wrong"),e.qZA(),e.TgZ(4,"p",30),e._uU(5),e.qZA()()()),2&a){const t=e.oxw();e.xp6(5),e.Oqu(t.insertPageTxErrorMessage)}}function fe(a,i){1&a&&(e.TgZ(0,"div",28)(1,"div",29),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",30),e._uU(4,"\u{1f680} Hold on! We are almost there!"),e.qZA()()())}function he(a,i){if(1&a&&(e.TgZ(0,"div",28)(1,"div",29)(2,"h1",30),e._uU(3,"\u{1f973} Page rejected successfully!"),e.qZA(),e.TgZ(4,"p",30),e._uU(5),e.qZA(),e.TgZ(6,"a",31),e._uU(7),e.qZA()()()),2&a){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.rejectPageTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.rejectPageTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.rejectPageTxMessage," ")}}function ve(a,i){if(1&a&&(e.TgZ(0,"div",28)(1,"div",29)(2,"h1",30),e._uU(3,"Oops! something went wrong"),e.qZA(),e.TgZ(4,"p",30),e._uU(5),e.qZA()()()),2&a){const t=e.oxw();e.xp6(5),e.Oqu(t.rejectPageTxErrorMessage)}}let xe=(()=>{class a{constructor(t,n,r,o,s,p,c){this._arweave=t,this._auth=n,this._snackBar=r,this._dialog=o,this._route=s,this._userSettings=p,this._arwikiTokenContract=c,this.loadingPendingPages=!1,this.pages={},this.pendingPagesSubscription=P.w0.EMPTY,this.arverifyProcessedAddressesMap={},this.loadingInsertPageIntoIndex=!1,this.insertPageTxMessage="",this.insertPageTxErrorMessage="",this.routeLang="",this.baseURL=this._arweave.baseURL,this.loadingRejectPage=!1,this.rejectPageTxMessage="",this.rejectPageTxErrorMessage=""}ngOnInit(){var t=this;return(0,h.Z)(function*(){const n=t._auth.getAdminList();t.routeLang=t._route.snapshot.paramMap.get("lang"),t._arwiki=new L.iN(t._arweave.arweave),t.arwikiQuery=new N.x(t._arweave.arweave),t.loadingPendingPages=!0;let o,s=0;try{o=yield t._arweave.arweave.network.getInfo(),s=o.height}catch(c){return void t.message(`${c}`,"error")}let p={};var c;t.pendingPagesSubscription=t._arwikiTokenContract.getCategories().pipe((0,m.w)(c=>t.arwikiQuery.getPendingPages(t.routeLang,Object.keys(c),100,s)),(0,m.w)(c=>{for(let d of c){const g=new C.default(d,t._arweave.arweave);p[g.id]={id:g.id,title:t.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Title"),slug:t.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Slug"),category:t.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Category"),language:t.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Lang"),img:t.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Img"),owner:g.owner.address,block:g.block,value:t.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Value")}}return(0,x.of)(p)}),(0,m.w)(c=>t._arwikiTokenContract.getAllPages(t.routeLang,-1).pipe((0,m.w)(d=>{let g={};const l=Object.keys(d).map(_=>d[_].content);for(let _ in c)l.indexOf(_)>=0||(g[_]=c[_]);return(0,x.of)(g)}))),(0,m.w)(c=>t.arwikiQuery.getRejectedPagesByIds(n,Object.keys(c),100,s).pipe((0,m.w)(d=>{let g=[],l={};for(let _ of d){const A=new C.default(_,t._arweave.arweave),b=t.arwikiQuery.searchKeyNameInTags(A.tags,"Arwiki-Page-Id");g.push(b)}for(let _ in c)g.indexOf(_)<0&&(l[_]=c[_]);return(0,x.of)(l)})))).subscribe({next:(c=(0,h.Z)(function*(d){t.pages=d,t.loadingPendingPages=!1,t.arverifyProcessedAddressesMap={};for(let g of Object.keys(d)){if(Object.prototype.hasOwnProperty.call(t.arverifyProcessedAddressesMap,d[g].owner))continue;const l=yield t.getArverifyVerification(d[g].owner);t.arverifyProcessedAddressesMap[d[g].owner]=l}}),function(g){return c.apply(this,arguments)}),error:c=>{t.message(c,"error"),t.loadingPendingPages=!1}})})()}message(t,n="",r){this._snackBar.open(t,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:r,panelClass:n})}ngOnDestroy(){this.pendingPagesSubscription&&this.pendingPagesSubscription.unsubscribe()}getArverifyVerification(t){return(0,h.Z)(function*(){const n=yield(0,$.Ni)(t);return{verified:n.verified,icon:n.icon,percentage:n.percentage}})()}underscoreToSpace(t){return t.replace(/[_]/gi," ")}confirmValidateArWikiPage(t,n,r,o,s){let c="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(D.f,{data:{title:"Are you sure?",content:"You are about to approve a new arwiki page. Remember to have enough balance to stake and some other in your vault! Do you want to proceed?",pageValue:o,second_content:"Please define the final page value:"},direction:c}).afterClosed().pipe((0,m.w)(g=>{const l=+g;if(Number.isInteger(l)&&l>0)return this.loadingInsertPageIntoIndex=!0,this._arwikiTokenContract.approvePage(n,s,t,r,this.routeLang,l,this._auth.getPrivateKey(),L.yh[0]);if(0===l)throw Error("Stake must be greater than 0 $WIKI tokens");return(0,x.of)(null)})).subscribe({next:g=>{g&&(this.insertPageTxMessage=`${g}`,this.message("Success!","success"))},error:g=>{this.insertPageTxErrorMessage=`${g}`,this.message(`${g}`,"error")}})}timestampToDate(t){return new Date(1e3*t)}getKeys(t){return Object.keys(t)}confirmRejectArWikiPage(t,n){let o="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(ee,{data:{id:n},direction:o}).afterClosed().pipe((0,m.w)(p=>{if(p){this.loadingRejectPage=!0;const c=this._auth.getPrivateKey();return this._arwiki.createRejectTXForArwikiPage(n,t,this.routeLang,p,c)}return(0,x.of)(null)})).subscribe({next:p=>{p&&(this.rejectPageTxMessage=`${p}`,this.message("Page rejected!","success"))},error:p=>{this.rejectPageTxErrorMessage=`${p}`,this.message(`${p}`,"error")}})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(y.N),e.Y36(I.e),e.Y36(U.ux),e.Y36(w.uw),e.Y36(v.gz),e.Y36(O.s),e.Y36(M.d))},a.\u0275cmp=e.Xpm({type:a,selectors:[["ng-component"]],decls:11,vars:11,consts:[[3,"title"],["class","spinner-center",4,"ngIf"],[1,"container","page-container","fadeIn"],["class","row",4,"ngIf"],["class","row fadeIn",4,"ngIf"],[1,"spinner-center"],[1,"row"],["class","col-12 card-page fadeIn",4,"ngIf"],["class","col-12 col-md-6 card-page fadeIn",4,"ngFor","ngForOf"],[1,"col-12","card-page","fadeIn"],[1,"col-12","col-md-6","card-page","fadeIn"],[1,"link",3,"routerLink"],["class","card-image text-center",4,"ngIf"],[1,"mbt20"],["class","red mini-text",4,"ngIf"],[1,"mini-text"],[3,"address","isAddress"],[3,"address"],["class","mini-text",4,"ngIf"],["class","green mini-text",4,"ngIf"],[1,"text-right","page-card-footer"],["mat-flat-button","","matTooltip","Approve and sponsor page",1,"approve-btn",3,"click"],["mat-flat-button","","matTooltip","Reject page","color","warn",3,"click"],["mat-flat-button","","color","primary","matTooltip","Preview",3,"routerLink"],[1,"card-image","text-center"],[3,"src"],[1,"red","mini-text"],[1,"green","mini-text"],[1,"row","fadeIn"],[1,"col","text-center"],[1,"text-center"],["mat-button","","target","_blank",1,"text-center",3,"href"]],template:function(t,n){1&t&&(e._UZ(0,"app-moderators-menu",0),e.ALo(1,"translate"),e.YNc(2,ne,1,0,"mat-spinner",1),e.TgZ(3,"div",2),e.YNc(4,le,3,2,"div",3),e.YNc(5,ue,5,0,"div",4),e.YNc(6,_e,8,3,"div",4),e.YNc(7,me,6,1,"div",4),e.YNc(8,fe,5,0,"div",4),e.YNc(9,he,8,3,"div",4),e.YNc(10,ve,6,1,"div",4),e.qZA()),2&t&&(e.s9C("title",e.lcZ(1,9,"MODERATORS.PENDING_PAGE.TITLE_PENDING")),e.xp6(2),e.Q6J("ngIf",n.loadingPendingPages),e.xp6(2),e.Q6J("ngIf",!n.loadingInsertPageIntoIndex&&!n.loadingRejectPage),e.xp6(1),e.Q6J("ngIf",n.loadingInsertPageIntoIndex&&!n.insertPageTxMessage&&!n.insertPageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",n.insertPageTxMessage),e.xp6(1),e.Q6J("ngIf",n.insertPageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",n.loadingRejectPage&&!n.rejectPageTxMessage&&!n.rejectPageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",n.rejectPageTxMessage),e.xp6(1),e.Q6J("ngIf",n.rejectPageTxErrorMessage))},dependencies:[f.sg,f.O5,v.rH,v.yS,Z.zs,Q.gM,k.Hw,q.Ou,R.a8,j.N,E,f.uU,Y.X$],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}.w70[_ngcontent-%COMP%]{width:70%}.ml10[_ngcontent-%COMP%]{margin-left:10px}.w100[_ngcontent-%COMP%]{width:100%}.w50[_ngcontent-%COMP%]{width:50%}.card-page[_ngcontent-%COMP%]{margin-bottom:40px}.approve-btn[_ngcontent-%COMP%]{background-color:#63c642;color:#fff}.link[_ngcontent-%COMP%]{cursor:pointer}.mini-text[_ngcontent-%COMP%]{font-size:12px}.mbt20[_ngcontent-%COMP%]{margin-bottom:20px;margin-top:20px}.card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.page-card-footer[_ngcontent-%COMP%]{margin-top:20px}"]}),a})();var T=u(24006),B=u(32076);let Ae=(()=>{class a{constructor(t,n,r,o){this._snackBar=t,this._arwikiTokenContract=n,this._auth=r,this._arweave=o,this.createAdminFrm=new T.nJ({newAdminAddress:new T.p4("")}),this.formLoading=!1,this.saveAdminSubscription=P.w0.EMPTY}get newAdminAddress(){return this.createAdminFrm.get("newAdminAddress")}ngOnInit(){}ngOnDestroy(){this.saveAdminSubscription&&this.saveAdminSubscription.unsubscribe()}createNewAdmin(){const t=this.newAdminAddress.value;this.formLoading=!0,this.newAdminAddress.disable(),this.saveAdminSubscription=(0,B.D)(this._arwikiTokenContract.registerAdmin(t,this._auth.getPrivateKey(),L.yh[0])).subscribe({next:n=>{this.newadminTX=n,this.message("New admin proposal created!","success"),this.formLoading=!1,this.newAdminAddress.enable(),this.newAdminAddress.setValue("")},error:n=>{this.message(n,"error"),this.formLoading=!1,this.newAdminAddress.enable()}})}message(t,n="",r){this._snackBar.open(t,"X",{duration:5e3,horizontalPosition:"center",verticalPosition:r,panelClass:n})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(U.ux),e.Y36(M.d),e.Y36(I.e),e.Y36(y.N))},a.\u0275cmp=e.Xpm({type:a,selectors:[["ng-component"]],decls:14,vars:2,consts:[["title","Add admin"],[1,"container","page-container","fadeIn"],[1,"row"],[1,"col-12","fadeIn"],[3,"formGroup","ngSubmit"],["matInput","","required","","autocomplete","off","formControlName","newAdminAddress"],[1,"text-center"],["type","submit","mat-raised-button","","color","primary",1,"go-button",3,"disabled"]],template:function(t,n){1&t&&(e._UZ(0,"app-moderators-menu",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4),e.NdJ("ngSubmit",function(){return n.createNewAdmin()}),e.TgZ(5,"mat-form-field")(6,"mat-label"),e._uU(7,"Arweave address of the new admin (moderator)"),e.qZA(),e._UZ(8,"input",5),e.qZA(),e.TgZ(9,"div",6)(10,"button",7)(11,"mat-icon"),e._uU(12,"save"),e.qZA(),e._uU(13," Add Admin! "),e.qZA()()()()()()),2&t&&(e.xp6(4),e.Q6J("formGroup",n.createAdminFrm),e.xp6(6),e.Q6J("disabled",!n.createAdminFrm.valid))},dependencies:[S.KE,S.hX,H.Nt,Z.lW,k.Hw,T._Y,T.Fj,T.JJ,T.JL,T.Q7,T.sg,T.u,E],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}.page-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),a})();function Te(a,i){if(1&a&&(e.TgZ(0,"div",4),e._uU(1),e.qZA()),2&a){const t=i.$implicit;e.xp6(1),e.hij(" ",t," ")}}function we(a,i){1&a&&(e.TgZ(0,"div",4),e._uU(1," -- "),e.qZA())}let Ze=(()=>{class a{constructor(t){this._auth=t,this.adminList=this._auth.getAdminList()}ngOnInit(){}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(I.e))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-view-admin-list"]],decls:8,vars:2,consts:[["title","Admin list"],[1,"container","page-container","fadeIn"],[1,"row"],["class","col-12 col-md-6 fadeIn",4,"ngFor","ngForOf"],[1,"col-12","col-md-6","fadeIn"]],template:function(t,n){1&t&&(e._UZ(0,"app-moderators-menu",0),e.TgZ(1,"div",1)(2,"div",2),e.YNc(3,Te,2,1,"div",3),e.qZA(),e.TgZ(4,"h1"),e._uU(5," Votes "),e.qZA(),e.TgZ(6,"div",2),e.YNc(7,we,2,0,"div",3),e.qZA()()),2&t&&(e.xp6(3),e.Q6J("ngForOf",n.adminList),e.xp6(4),e.Q6J("ngForOf",n.adminList))},dependencies:[f.sg,E],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}"]}),a})();var J=u(57762);function Pe(a,i){1&a&&(e.TgZ(0,"p"),e._uU(1,"Loading ..."),e.qZA())}function Le(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"div")(1,"p")(2,"button",6),e.NdJ("click",function(){const o=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.viewUpdates(o.slug))}),e._uU(3),e.qZA()()()}if(2&a){const t=i.$implicit;e.xp6(3),e.hij("",t.title," ")}}function ke(a,i){if(1&a&&(e.ynx(0),e.YNc(1,Le,4,1,"div",5),e.BQk()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.pages)}}let Ce=(()=>{class a{constructor(t,n,r,o,s,p){this.data=t,this._arweave=n,this._snackBar=r,this._arwikiTokenContract=o,this._router=s,this._dialogRef=p,this.loadingPendingPages=!1,this.pages=[],this.pendingPagesSubscription=P.w0.EMPTY,this.langCode=""}ngOnInit(){var t=this;return(0,h.Z)(function*(){t.langCode=t.data.langCode,t.arwikiQuery=new N.x(t._arweave.arweave),yield t.getUpdates()})()}message(t,n="",r){this._snackBar.open(t,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:r,panelClass:n})}ngOnDestroy(){this.pendingPagesSubscription&&this.pendingPagesSubscription.unsubscribe()}getUpdates(){var t=this;return(0,h.Z)(function*(){t.loadingPendingPages=!0;let r,o=0;try{r=yield t._arweave.arweave.network.getInfo(),o=r.height}catch(s){return void t.message(`${s}`,"error")}var s;t.pendingPagesSubscription=t.arwikiQuery.getPendingPagesUpdatesByLang(t.langCode,100,o).pipe((0,m.w)(s=>{let p={};for(let c of s){const d=new C.default(c,t._arweave.arweave);p[d.id]={id:d.id,title:t.arwikiQuery.searchKeyNameInTags(d.tags,"Arwiki-Page-Title"),slug:t.arwikiQuery.searchKeyNameInTags(d.tags,"Arwiki-Page-Slug"),category:t.arwikiQuery.searchKeyNameInTags(d.tags,"Arwiki-Page-Category"),language:t.arwikiQuery.searchKeyNameInTags(d.tags,"Arwiki-Page-Lang"),img:t.arwikiQuery.searchKeyNameInTags(d.tags,"Arwiki-Page-Img"),owner:d.owner.address,block:d.block,value:t.arwikiQuery.searchKeyNameInTags(d.tags,"Arwiki-Page-Value")}}return(0,x.of)(p)}),(0,m.w)(s=>t._arwikiTokenContract.getApprovedPages(t.langCode,-1,!0).pipe((0,m.w)(p=>{let c={},d=[];for(const g of Object.keys(p)){const l=p[g].updates.map(_=>_.tx);d=d.concat(l)}for(let g in s)d.indexOf(g)>=0||(c[g]=s[g]);return(0,x.of)(c)})))).subscribe({next:(s=(0,h.Z)(function*(p){t.pages=Object.values(p),t.loadingPendingPages=!1}),function(c){return s.apply(this,arguments)}),error:s=>{t.message(s,"error"),t.loadingPendingPages=!1}})})()}getKeys(t){return Object.keys(t)}viewUpdates(t){this.close(),this._router.navigate([this.langCode,"moderators","page-updates",t])}close(){this._dialogRef.close()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(w.WI),e.Y36(y.N),e.Y36(U.ux),e.Y36(M.d),e.Y36(v.F0),e.Y36(w.so))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-dialog-search-page-update"]],decls:11,vars:2,consts:[["mat-dialog-title",""],[1,"title-icon"],[4,"ngIf"],["align","end"],["mat-button","","mat-dialog-close","","cdkFocusInitial",""],[4,"ngFor","ngForOf"],["mat-button","",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"h2",0)(1,"mat-icon",1),e._uU(2,"search"),e.qZA(),e.TgZ(3,"span"),e._uU(4,"Pending updates"),e.qZA()(),e.TgZ(5,"mat-dialog-content"),e.YNc(6,Pe,2,0,"p",2),e.YNc(7,ke,2,1,"ng-container",2),e.qZA(),e.TgZ(8,"mat-dialog-actions",3)(9,"button",4),e._uU(10,"Cancel"),e.qZA()()),2&t&&(e.xp6(6),e.Q6J("ngIf",n.loadingPendingPages),e.xp6(1),e.Q6J("ngIf",!n.loadingPendingPages))},dependencies:[f.sg,f.O5,Z.lW,k.Hw,w.ZT,w.uh,w.xY,w.H8],styles:[".title-icon[_ngcontent-%COMP%]{font-size:40px;line-height:40px;width:40px;height:40px;vertical-align:middle}.mat-dialog-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:12px;vertical-align:middle;font-size:26px;font-family:Roboto Mono,monospace;line-height:38px}"]}),a})();function be(a,i){1&a&&e._UZ(0,"mat-spinner",5)}function Ie(a,i){1&a&&(e.TgZ(0,"div",10),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"MODERATORS.LABEL_NO_RESULTS")," "))}function ye(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"div",11)(1,"button",12),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.searchUpdates())}),e.TgZ(2,"mat-icon"),e._uU(3,"search"),e.qZA(),e._uU(4," Search for updates "),e.qZA()()}}function Me(a,i){if(1&a&&(e.TgZ(0,"button",31)(1,"mat-icon"),e._uU(2,"casino"),e.qZA()()),2&a){const t=e.oxw().$implicit;e.MGl("routerLink","../../",t.slug,"")}}function Ue(a,i){if(1&a&&(e.TgZ(0,"mat-card",32),e._UZ(1,"img",33),e.qZA()),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(1),e.s9C("src",n.baseURL+t.img,e.LSH)}}function Se(a,i){if(1&a&&(e.TgZ(0,"div",18)(1,"app-arweave-address",19),e._uU(2,"Sponsor: "),e.qZA()()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("address",t.sponsor)("isAddress",!1)}}function Ee(a,i){1&a&&(e.TgZ(0,"div",34)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&a&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_TX_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_TX_PENDING")," "))}function Oe(a,i){if(1&a&&(e.TgZ(0,"div",18)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_HEIGHT"),": "),e.xp6(2),e.hij(" ",t.block.height," ")}}function Ne(a,i){if(1&a&&(e.TgZ(0,"div",18)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"date"),e.qZA()),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_TIMESTAMP"),": "),e.xp6(2),e.hij(" ",e.xi3(5,4,n.timestampToDate(t.block.timestamp),"short")," ")}}function qe(a,i){1&a&&(e.TgZ(0,"strong",37),e._uU(1," - Reward unlocked! "),e.qZA())}function Ye(a,i){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&a){const t=e.oxw(2).$implicit,n=e.oxw(2);e.xp6(1),e.AsE(" - Reward unlocked in ",t.pageRewardAt-n.currentBlockHeight," blocks! (",n.formatBlocks(t.pageRewardAt-n.currentBlockHeight),") ")}}function De(a,i){if(1&a&&(e.TgZ(0,"div",18)(1,"strong"),e._uU(2,"Page reward at: "),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.qZA(),e.YNc(5,qe,2,0,"strong",35),e.YNc(6,Ye,2,2,"span",36),e.qZA()),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(4),e.hij("",t.pageRewardAt," block"),e.xp6(1),e.Q6J("ngIf",n.currentBlockHeight>=t.pageRewardAt),e.xp6(1),e.Q6J("ngIf",n.currentBlockHeight<t.pageRewardAt)}}function Qe(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"a",38),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,o=e.oxw(2);return e.KtG(o.confirmStopStake(r.slug))}),e.TgZ(1,"mat-icon"),e._uU(2,"delete"),e.qZA(),e._uU(3," Stop staking "),e.qZA()}}function Re(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"div",13)(1,"mat-card"),e.YNc(2,Me,3,1,"button",14),e.TgZ(3,"h2",15),e._uU(4),e.qZA(),e.YNc(5,Ue,2,1,"mat-card",16),e.TgZ(6,"div"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"div"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"div"),e._uU(16),e.qZA(),e._UZ(17,"hr",17),e.TgZ(18,"div",18)(19,"app-arweave-address",19),e._uU(20),e.ALo(21,"translate"),e.qZA()(),e.TgZ(22,"div",18)(23,"app-arweave-address",20),e._uU(24),e.ALo(25,"translate"),e.qZA()(),e.YNc(26,Se,3,2,"div",21),e.YNc(27,Ee,6,6,"div",22),e.YNc(28,Oe,5,4,"div",21),e.YNc(29,Ne,6,7,"div",21),e.YNc(30,De,7,3,"div",21),e.TgZ(31,"div",23),e.YNc(32,Qe,4,0,"a",24),e.TgZ(33,"a",25),e.NdJ("click",function(){const o=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.confirmSponsorArWikiPage(o.slug,o.category,o.value))}),e.TgZ(34,"mat-icon"),e._uU(35,"casino"),e.qZA(),e._uU(36," Sponsor page "),e.qZA(),e.TgZ(37,"a",26),e.NdJ("click",function(){const o=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.confirmSetMainArWikiPage(o.slug,o.id,o.category))}),e.TgZ(38,"mat-icon",27),e._uU(39,"star"),e.qZA(),e._uU(40," Set as Main Page "),e.qZA(),e.TgZ(41,"a",28)(42,"mat-icon"),e._uU(43,"archive"),e.qZA(),e._uU(44," Page updates "),e.qZA(),e.TgZ(45,"a",29)(46,"mat-icon"),e._uU(47,"sell"),e.qZA(),e._uU(48," Tags "),e.qZA(),e.TgZ(49,"a",30)(50,"mat-icon"),e._uU(51,"visibility"),e.qZA(),e._uU(52," View "),e.qZA()()()()}if(2&a){const t=i.$implicit,n=e.oxw(2);e.xp6(2),e.Q6J("ngIf",t.sponsor===n.myAddress),e.xp6(1),e.MGl("routerLink","../../",t.slug,""),e.xp6(1),e.hij(" ",t.title," "),e.xp6(1),e.Q6J("ngIf",t.img),e.xp6(2),e.AsE(" ",e.lcZ(8,25,"PAGE.LABEL_SLUG"),": ",t.slug," "),e.xp6(3),e.AsE(" ",e.lcZ(11,27,"PAGE.LABEL_CATEGORY"),": ",t.category," "),e.xp6(3),e.AsE(" ",e.lcZ(14,29,"PAGE.LABEL_LANGUAGE"),": ",t.language," "),e.xp6(3),e.hij(" Page value: ",t.value," $WIKI "),e.xp6(3),e.Q6J("address",t.id)("isAddress",!1),e.xp6(1),e.hij("",e.lcZ(21,31,"PAGE.LABEL_ID"),": "),e.xp6(3),e.Q6J("address",t.owner),e.xp6(1),e.hij("",e.lcZ(25,33,"PAGE.LABEL_OWNER"),": "),e.xp6(2),e.Q6J("ngIf",t.sponsor),e.xp6(1),e.Q6J("ngIf",!t.block||!t.block.height),e.xp6(1),e.Q6J("ngIf",t.block&&t.block.height),e.xp6(1),e.Q6J("ngIf",t.block&&t.block.timestamp),e.xp6(1),e.Q6J("ngIf",t.pageRewardAt),e.xp6(2),e.Q6J("ngIf",t.sponsor===n.myAddress),e.xp6(9),e.MGl("routerLink","../page-updates/",t.slug,""),e.xp6(4),e.MGl("routerLink","../tag-manager/",t.slug,""),e.xp6(4),e.MGl("routerLink","../../",t.slug,"")}}function je(a,i){if(1&a&&(e.TgZ(0,"div",6),e.YNc(1,Ie,3,3,"div",7),e.YNc(2,ye,5,0,"div",8),e.YNc(3,Re,53,35,"div",9),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(t.loadingApprovedPages||t.pages&&t.pages.length)),e.xp6(1),e.Q6J("ngIf",t.pages&&t.pages.length),e.xp6(1),e.Q6J("ngForOf",t.pages)}}function Je(a,i){1&a&&(e.TgZ(0,"div",39)(1,"div",40),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",41),e._uU(4,"\u{1f680} Hold on! Your transaction is processing ..."),e.qZA()()())}function Ge(a,i){if(1&a&&(e.TgZ(0,"div",39)(1,"div",40)(2,"h1",41),e._uU(3,"\u{1f4a5} Page successfully unlisted!"),e.qZA(),e.TgZ(4,"p",41),e._uU(5),e.qZA(),e.TgZ(6,"a",42),e._uU(7),e.qZA()()()),2&a){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.deleteTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.deleteTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.deleteTxMessage," ")}}function Be(a,i){1&a&&(e.TgZ(0,"div",39)(1,"div",40),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",41),e._uU(4,"\u{1f680} Hold on! Your transaction is processing ..."),e.qZA()()())}function Ke(a,i){if(1&a&&(e.TgZ(0,"div",39)(1,"div",40)(2,"h1",41),e._uU(3,"\u{1f973} Page successfully set as Main Page!"),e.qZA(),e.TgZ(4,"p",41),e._uU(5),e.qZA(),e.TgZ(6,"a",42),e._uU(7),e.qZA()()()),2&a){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.setMainTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.setMainTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.setMainTxMessage," ")}}function $e(a,i){1&a&&(e.TgZ(0,"div",39)(1,"div",40),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",41),e._uU(4,"\u{1f680} Hold on! Your transaction is processing ..."),e.qZA()()())}function He(a,i){if(1&a&&(e.TgZ(0,"div",39)(1,"div",40)(2,"h1",41),e._uU(3,"\u{1f4a5} Sponsorship successfully stopped!"),e.qZA(),e.TgZ(4,"p",41),e._uU(5),e.qZA(),e.TgZ(6,"a",42),e._uU(7),e.qZA()()()),2&a){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.stopStakeTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.stopStakeTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.stopStakeTxMessage," ")}}function Fe(a,i){1&a&&(e.TgZ(0,"div",39)(1,"div",40),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",41),e._uU(4,"\u{1f680} Hold on! Your transaction is processing ..."),e.qZA()()())}function Xe(a,i){if(1&a&&(e.TgZ(0,"div",39)(1,"div",40)(2,"h1",41),e._uU(3,"\u{1f973} Page successfully updated!"),e.qZA(),e.TgZ(4,"p",41),e._uU(5),e.qZA(),e.TgZ(6,"a",42),e._uU(7),e.qZA()()()),2&a){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.updateSponsorPageTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.updateSponsorPageTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.updateSponsorPageTxMessage," ")}}function We(a,i){if(1&a&&(e.TgZ(0,"div",39)(1,"div",40)(2,"h1",41),e._uU(3,"Oops! something went wrong"),e.qZA(),e.TgZ(4,"p",41),e._uU(5),e.qZA()()()),2&a){const t=e.oxw();e.xp6(5),e.Oqu(t.updateSponsorPageTxErrorMessage)}}let Ve=(()=>{class a{constructor(t,n,r,o,s,p,c){this._arweave=t,this._auth=n,this._snackBar=r,this._dialog=o,this._route=s,this._userSettings=p,this._arwikiToken=c,this.loadingApprovedPages=!1,this.pages=[],this.approvedPagesSubscription=P.w0.EMPTY,this.routeLang="",this.loadingDeletePage=!1,this.deleteTxMessage="",this.stopStakeTxMessage="",this.loadingStopStake=!1,this.loadingSetMainPage=!1,this.setMainTxMessage="",this.myAddress="",this.currentBlockHeight=0,this.heightSubscription=P.w0.EMPTY,this.baseURL=this._arweave.baseURL,this.updateSponsorPageTxMessage="",this.updateSponsorPageTxErrorMessage="",this.loadingUpdateSponsorPageIntoIndex=!1,this.loadingPendingUpdates=!1}ngOnInit(){var t=this;return(0,h.Z)(function*(){t.myAddress=t._auth.getMainAddressSnapshot(),t._auth.getAdminList(),t.routeLang=t._route.snapshot.paramMap.get("lang"),t._arwiki=new L.iN(t._arweave.arweave),t.arwikiQuery=new N.x(t._arweave.arweave),t.loadingApprovedPages=!0;let o,s=0;try{o=yield t._arweave.arweave.network.getInfo(),s=o.height}catch(g){return void t.message(`${g}`,"error")}t._auth.getAdminList();let c=[],d={};var g;t.approvedPagesSubscription=t._arwikiToken.getCategories().pipe((0,m.w)(g=>t._arwikiToken.getApprovedPages(t.routeLang,-1,!0)),(0,m.w)(g=>(d=g,c=Object.keys(g).map(l=>g[l].content),t.arwikiQuery.getTXsData(c))),(0,m.w)(g=>{let l=[];for(let _ of g){const A=new C.default(_,t._arweave.arweave),b=t.arwikiQuery.searchKeyNameInTags(A.tags,"Arwiki-Page-Slug");l.push({id:A.id,title:t.arwikiQuery.searchKeyNameInTags(A.tags,"Arwiki-Page-Title"),slug:b,category:t.arwikiQuery.searchKeyNameInTags(A.tags,"Arwiki-Page-Category"),language:t.arwikiQuery.searchKeyNameInTags(A.tags,"Arwiki-Page-Lang"),value:d[b].value,img:t.arwikiQuery.searchKeyNameInTags(A.tags,"Arwiki-Page-Img"),owner:A.owner.address,block:A.block,start:d[b].start,sponsor:d[b].sponsor,pageRewardAt:d[b].pageRewardAt})}return(0,x.of)(l)})).subscribe({next:(g=(0,h.Z)(function*(l){t.pages=l,t.loadingApprovedPages=!1}),function(_){return g.apply(this,arguments)}),error:g=>{t.message(g,"error"),t.loadingApprovedPages=!1}}),t.heightSubscription=(0,B.D)(t.getCurrentHeight()).subscribe({next:g=>{t.currentBlockHeight=g},error:g=>{t.message(g,"error")}})})()}message(t,n="",r){this._snackBar.open(t,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:r,panelClass:n})}ngOnDestroy(){this.approvedPagesSubscription&&this.approvedPagesSubscription.unsubscribe()}underscoreToSpace(t){return t.replace(/[_]/gi," ")}timestampToDate(t){return new Date(1e3*t)}confirmDeleteArWikiPage(t,n,r){var o=this;let p="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(J.p,{data:{title:"Are you sure?",content:"You are about to unlist (hide) an arwiki page from the index. Do you want to proceed?"},direction:p}).afterClosed().subscribe(function(){var d=(0,h.Z)(function*(g){if(g){o.loadingDeletePage=!0;try{const l=yield o._arwiki.createDeleteTXForArwikiPage(n,t,r,o.routeLang,o._auth.getPrivateKey());o.deleteTxMessage=l,o.message("Success!","success")}catch(l){o.message(`${l}`,"error")}}});return function(g){return d.apply(this,arguments)}}())}confirmSetMainArWikiPage(t,n,r){var o=this;let p="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(J.p,{data:{title:"Are you sure?",content:`You are about to set ${t} as the main page. Do you want to proceed?`},direction:p}).afterClosed().subscribe(function(){var d=(0,h.Z)(function*(g){if(g){o.loadingSetMainPage=!0;try{const l=yield o._arwiki.createMainPageTXForArwikiPage(n,t,r,o.routeLang,o._auth.getPrivateKey());o.setMainTxMessage=l,o.message("Success!","success")}catch(l){o.message(`${l}`,"error")}}});return function(g){return d.apply(this,arguments)}}())}getCurrentHeight(){var t=this;return(0,h.Z)(function*(){let n={},r=0;try{n=yield t._arweave.arweave.network.getInfo(),r=n.height?n.height:0}catch(o){throw Error(`${o}`)}return r})()}confirmStopStake(t){let r="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(J.p,{data:{title:"Are you sure?",content:"You are about to stop your stake and sponsorship for this page. This will unlist the page. Do you want to proceed?"},direction:r}).afterClosed().pipe((0,m.w)(s=>s?(this.loadingStopStake=!0,this._arwikiToken.stopStaking(t,this.routeLang,this._auth.getPrivateKey(),L.yh[0])):(0,x.of)(null))).subscribe({next:s=>{s&&(this.stopStakeTxMessage=`${s}`,this.message("Success!","success"))},error:s=>{this.message(`${s}`,"error")}})}formatBlocks(t){return`${this._arweave.formatBlocks(t)}`}confirmSponsorArWikiPage(t,n,r){let s="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(D.f,{data:{title:"Are you sure?",content:"You are about to be the new sponsor for this arwiki page. Do you want to proceed?",pageValue:r+1,second_content:"Please define the amount of $WIKI tokens to stake:"},direction:s}).afterClosed().pipe((0,m.w)(c=>{const d=+c;if(Number.isInteger(d)&&d>0)return this.loadingUpdateSponsorPageIntoIndex=!0,this._arwikiToken.updatePageSponsor(t,n,this.routeLang,d,this._auth.getPrivateKey(),L.yh[0]);if(0===d)throw Error("Stake must be greater than 0 $WIKI tokens");return(0,x.of)(null)})).subscribe({next:c=>{c&&(this.updateSponsorPageTxMessage=`${c}`,this.message("Success!","success"))},error:c=>{this.updateSponsorPageTxErrorMessage=`${c}`,this.message(`${c}`,"error")}})}searchUpdates(){const t=this._userSettings.getDefaultLang();this._dialog.open(Ce,{data:{langCode:t.code},direction:"LTR"===t.writing_system?"ltr":"rtl",disableClose:!0}).afterClosed().subscribe(function(){var o=(0,h.Z)(function*(s){});return function(s){return o.apply(this,arguments)}}())}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(y.N),e.Y36(I.e),e.Y36(U.ux),e.Y36(w.uw),e.Y36(v.gz),e.Y36(O.s),e.Y36(M.d))},a.\u0275cmp=e.Xpm({type:a,selectors:[["ng-component"]],decls:13,vars:11,consts:[["title","Approved list"],["class","spinner-center",4,"ngIf"],[1,"container","page-container","fadeIn"],["class","row",4,"ngIf"],["class","row fadeIn",4,"ngIf"],[1,"spinner-center"],[1,"row"],["class","col-12 card-page fadeIn",4,"ngIf"],["class","col-12 text-right sec-toolbar",4,"ngIf"],["class","col-12 col-md-6 card-page fadeIn",4,"ngFor","ngForOf"],[1,"col-12","card-page","fadeIn"],[1,"col-12","text-right","sec-toolbar"],["mat-button","","color","primary","matTooltip","Search for updates",1,"btn-toolbar2",3,"click"],[1,"col-12","col-md-6","card-page","fadeIn"],["mat-icon-button","","class","card-header-icon green","matTooltip","You are the sponsor!","aria-label","You are the sponsor!",3,"routerLink",4,"ngIf"],[1,"link","ellipsis","card-header-title",3,"routerLink"],["class","card-image text-center",4,"ngIf"],[1,"mbt20"],[1,"mini-text"],[3,"address","isAddress"],[3,"address"],["class","mini-text",4,"ngIf"],["class","red mini-text",4,"ngIf"],[1,"text-right","mt20","card-footer"],["mat-flat-button","","color","warn","matTooltip","Stop staking",3,"click",4,"ngIf"],["mat-flat-button","","color","primary","matTooltip","Sponsor page",3,"click"],["mat-flat-button","","color","primary","matTooltip","Set as Main Page",3,"click"],[1,"yellow"],["mat-flat-button","","color","primary","matTooltip","Page updates",3,"routerLink"],["mat-flat-button","","color","primary","matTooltip","Add tags",3,"routerLink"],["mat-flat-button","","color","primary","matTooltip","View",3,"routerLink"],["mat-icon-button","","matTooltip","You are the sponsor!","aria-label","You are the sponsor!",1,"card-header-icon","green",3,"routerLink"],[1,"card-image","text-center"],[3,"src"],[1,"red","mini-text"],["class","green",4,"ngIf"],[4,"ngIf"],[1,"green"],["mat-flat-button","","color","warn","matTooltip","Stop staking",3,"click"],[1,"row","fadeIn"],[1,"col","text-center"],[1,"text-center"],["mat-button","","target","_blank",1,"text-center",3,"href"]],template:function(t,n){1&t&&(e._UZ(0,"app-moderators-menu",0),e.YNc(1,be,1,0,"mat-spinner",1),e.TgZ(2,"div",2),e.YNc(3,je,4,3,"div",3),e.YNc(4,Je,5,0,"div",4),e.YNc(5,Ge,8,3,"div",4),e.YNc(6,Be,5,0,"div",4),e.YNc(7,Ke,8,3,"div",4),e.YNc(8,$e,5,0,"div",4),e.YNc(9,He,8,3,"div",4),e.YNc(10,Fe,5,0,"div",4),e.YNc(11,Xe,8,3,"div",4),e.YNc(12,We,6,1,"div",4),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.loadingApprovedPages),e.xp6(2),e.Q6J("ngIf",!(n.loadingDeletePage||n.loadingSetMainPage||n.loadingStopStake||n.loadingUpdateSponsorPageIntoIndex)),e.xp6(1),e.Q6J("ngIf",n.loadingDeletePage&&!n.deleteTxMessage),e.xp6(1),e.Q6J("ngIf",n.deleteTxMessage),e.xp6(1),e.Q6J("ngIf",n.loadingSetMainPage&&!n.setMainTxMessage),e.xp6(1),e.Q6J("ngIf",n.setMainTxMessage),e.xp6(1),e.Q6J("ngIf",n.loadingStopStake&&!n.stopStakeTxMessage),e.xp6(1),e.Q6J("ngIf",n.stopStakeTxMessage),e.xp6(1),e.Q6J("ngIf",n.loadingUpdateSponsorPageIntoIndex&&!n.updateSponsorPageTxMessage&&!n.updateSponsorPageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",n.updateSponsorPageTxMessage),e.xp6(1),e.Q6J("ngIf",n.updateSponsorPageTxErrorMessage))},dependencies:[f.sg,f.O5,v.rH,v.yS,Z.lW,Z.zs,Q.gM,k.Hw,q.Ou,R.a8,j.N,E,f.uU,Y.X$],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}.w70[_ngcontent-%COMP%]{width:70%}.ml10[_ngcontent-%COMP%]{margin-left:10px}.w100[_ngcontent-%COMP%]{width:100%}.w50[_ngcontent-%COMP%]{width:50%}.card-page[_ngcontent-%COMP%]{margin-bottom:40px}.mt20[_ngcontent-%COMP%]{margin-top:20px}.link[_ngcontent-%COMP%]{cursor:pointer}.mbt20[_ngcontent-%COMP%]{margin-bottom:20px;margin-top:20px}.card-footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:10px}.card-header-icon[_ngcontent-%COMP%]{float:right}.card-header-title[_ngcontent-%COMP%]{margin-top:0}.card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.approve-btn[_ngcontent-%COMP%]{background-color:#63c642;color:#fff}.sec-toolbar[_ngcontent-%COMP%]{margin-bottom:20px}.btn-toolbar2[_ngcontent-%COMP%]{color:inherit}"]}),a})();function ze(a,i){1&a&&e._UZ(0,"mat-spinner",4)}function et(a,i){1&a&&(e.TgZ(0,"div",8),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"MODERATORS.LABEL_NO_RESULTS")," "))}function tt(a,i){if(1&a&&(e.TgZ(0,"div",12)(1,"app-arweave-address",13),e._uU(2,"Sponsor: "),e.qZA()()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("address",t.sponsor)("isAddress",!1)}}function nt(a,i){1&a&&(e.TgZ(0,"div",20)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&a&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_TX_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_TX_PENDING")," "))}function at(a,i){if(1&a&&(e.TgZ(0,"div",12)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_HEIGHT"),": "),e.xp6(2),e.hij(" ",t.block.height," ")}}function it(a,i){if(1&a&&(e.TgZ(0,"div",12)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"date"),e.qZA()),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_TIMESTAMP"),": "),e.xp6(2),e.hij(" ",e.xi3(5,4,n.timestampToDate(t.block.timestamp),"short")," ")}}function ot(a,i){1&a&&(e.TgZ(0,"strong",23),e._uU(1," - Reward unlocked! "),e.qZA())}function rt(a,i){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&a){const t=e.oxw(2).$implicit,n=e.oxw(2);e.xp6(1),e.hij(" - Reward unlocked in ",t.pageRewardAt-n.currentBlockHeight," blocks! ")}}function st(a,i){if(1&a&&(e.TgZ(0,"div",12)(1,"strong"),e._uU(2,"Page reward at: "),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.qZA(),e.YNc(5,ot,2,0,"strong",21),e.YNc(6,rt,2,1,"span",22),e.qZA()),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(4),e.hij("",t.pageRewardAt," block"),e.xp6(1),e.Q6J("ngIf",n.currentBlockHeight>=t.pageRewardAt),e.xp6(1),e.Q6J("ngIf",n.currentBlockHeight<t.pageRewardAt)}}function gt(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"div",9)(1,"mat-card")(2,"h2",10),e._uU(3),e.qZA(),e.TgZ(4,"div"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"div"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"div"),e._uU(14),e.qZA(),e._UZ(15,"hr",11),e.TgZ(16,"div",12)(17,"app-arweave-address",13),e._uU(18),e.ALo(19,"translate"),e.qZA()(),e.TgZ(20,"div",12)(21,"app-arweave-address",14),e._uU(22),e.ALo(23,"translate"),e.qZA()(),e.YNc(24,tt,3,2,"div",15),e.YNc(25,nt,6,6,"div",16),e.YNc(26,at,5,4,"div",15),e.YNc(27,it,6,7,"div",15),e.YNc(28,st,7,3,"div",15),e.TgZ(29,"div",17)(30,"a",18),e.NdJ("click",function(){const o=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.confirmReactivateArWikiPage(o.slug,o.category,o.value))}),e.TgZ(31,"mat-icon"),e._uU(32,"done"),e.qZA(),e._uU(33," Reactivate and sponsor page "),e.qZA(),e._uU(34," \xa0 "),e.TgZ(35,"a",19)(36,"mat-icon"),e._uU(37,"visibility"),e.qZA(),e._uU(38," Preview "),e.qZA()()()()}if(2&a){const t=i.$implicit;e.xp6(2),e.MGl("routerLink","../../preview/",t.id,""),e.xp6(1),e.hij(" ",t.title," "),e.xp6(2),e.AsE(" ",e.lcZ(6,20,"PAGE.LABEL_SLUG"),": ",t.slug," "),e.xp6(3),e.AsE(" ",e.lcZ(9,22,"PAGE.LABEL_CATEGORY"),": ",t.category," "),e.xp6(3),e.AsE(" ",e.lcZ(12,24,"PAGE.LABEL_LANGUAGE"),": ",t.language," "),e.xp6(3),e.hij(" Page value: ",t.value," $WIKI "),e.xp6(3),e.Q6J("address",t.id)("isAddress",!1),e.xp6(1),e.hij("",e.lcZ(19,26,"PAGE.LABEL_ID"),": "),e.xp6(3),e.Q6J("address",t.owner),e.xp6(1),e.hij("",e.lcZ(23,28,"PAGE.LABEL_OWNER"),": "),e.xp6(2),e.Q6J("ngIf",t.sponsor),e.xp6(1),e.Q6J("ngIf",!t.block||!t.block.height),e.xp6(1),e.Q6J("ngIf",t.block&&t.block.height),e.xp6(1),e.Q6J("ngIf",t.block&&t.block.timestamp),e.xp6(1),e.Q6J("ngIf",t.pageRewardAt),e.xp6(7),e.MGl("routerLink","../../preview/",t.id,"")}}function ct(a,i){if(1&a&&(e.TgZ(0,"div",5),e.YNc(1,et,3,3,"div",6),e.YNc(2,gt,39,30,"div",7),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(t.loadingPages||t.pages&&t.pages.length)),e.xp6(1),e.Q6J("ngForOf",t.pages)}}function pt(a,i){1&a&&(e.TgZ(0,"div",5)(1,"div",24),e._UZ(2,"mat-spinner",4),e.TgZ(3,"h1",25),e._uU(4,"\u{1f680} Hold on! Your transaction is processing ..."),e.qZA()()())}function dt(a,i){if(1&a&&(e.TgZ(0,"div",5)(1,"div",24)(2,"h1",25),e._uU(3,"\u{1f973} Page successfully updated!"),e.qZA(),e.TgZ(4,"p",25),e._uU(5),e.qZA(),e.TgZ(6,"a",26),e._uU(7),e.qZA()()()),2&a){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.updatePageTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.updatePageTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.updatePageTxMessage," ")}}function lt(a,i){if(1&a&&(e.TgZ(0,"div",5)(1,"div",24)(2,"h1",25),e._uU(3,"Oops! something went wrong"),e.qZA(),e.TgZ(4,"p",25),e._uU(5),e.qZA()()()),2&a){const t=e.oxw();e.xp6(5),e.Oqu(t.updatePageTxErrorMessage)}}let ut=(()=>{class a{constructor(t,n,r,o,s,p,c){this._arweave=t,this._auth=n,this._snackBar=r,this._dialog=o,this._route=s,this._userSettings=p,this._arwikiToken=c,this.loadingPages=!1,this.pages=[],this.pagesSubscription=P.w0.EMPTY,this.routeLang="",this.myAddress="",this.currentBlockHeight=0,this.heightSubscription=P.w0.EMPTY,this.loadingReactivatePageIntoIndex=!1,this.updatePageTxMessage="",this.updatePageTxErrorMessage=""}ngOnInit(){var t=this;return(0,h.Z)(function*(){t.myAddress=t._auth.getMainAddressSnapshot(),t._auth.getAdminList(),t.routeLang=t._route.snapshot.paramMap.get("lang"),t._arwiki=new L.iN(t._arweave.arweave),t.arwikiQuery=new N.x(t._arweave.arweave),t.loadingPages=!0;let o,s=0;try{o=yield t._arweave.arweave.network.getInfo(),s=o.height}catch(p){return void t.message(`${p}`,"error")}var p;t.pagesSubscription=t.getDeletedPages(100,s).subscribe({next:(p=(0,h.Z)(function*(c){t.pages=c,t.loadingPages=!1}),function(d){return p.apply(this,arguments)}),error:p=>{t.message(p,"error"),t.loadingPages=!1}}),t.heightSubscription=(0,B.D)(t.getCurrentHeight()).subscribe({next:p=>{t.currentBlockHeight=p},error:p=>{t.message(p,"error")}})})()}message(t,n="",r){this._snackBar.open(t,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:r,panelClass:n})}ngOnDestroy(){this.pagesSubscription&&this.pagesSubscription.unsubscribe()}underscoreToSpace(t){return t.replace(/[_]/gi," ")}timestampToDate(t){return new Date(1e3*t)}getCurrentHeight(){var t=this;return(0,h.Z)(function*(){let n={},r=0;try{n=yield t._arweave.arweave.network.getInfo(),r=n.height?n.height:0}catch(o){throw Error(`${o}`)}return r})()}getDeletedPages(t,n){const r=this._auth.getAdminList();let o=[],s={},p=[];return this._arwikiToken.getCategories().pipe((0,m.w)(c=>this._arwikiToken.getAllPages(this.routeLang,-1)),(0,m.w)(c=>(s=c,o=Object.keys(s).map(d=>s[d].content),p=Object.keys(s).filter(d=>!s[d].active).map(d=>s[d].content),this.arwikiQuery.getAllDeletedPages(r,this.routeLang,t,n))),(0,m.w)(c=>{const d={};for(const l of c){const _=new C.default(l,this._arweave.arweave),A=this.arwikiQuery.searchKeyNameInTags(_.tags,"Arwiki-Page-Id");d[A]=!0}let g=o.filter(l=>d[l]);return g=g.concat(p),this.arwikiQuery.getTXsData(g)}),(0,m.w)(c=>{let d=[];for(let g of c){const l=new C.default(g,this._arweave.arweave),_=this.arwikiQuery.searchKeyNameInTags(l.tags,"Arwiki-Page-Slug");d.push({id:l.id,title:this.arwikiQuery.searchKeyNameInTags(l.tags,"Arwiki-Page-Title"),slug:_,category:this.arwikiQuery.searchKeyNameInTags(l.tags,"Arwiki-Page-Category"),language:this.arwikiQuery.searchKeyNameInTags(l.tags,"Arwiki-Page-Lang"),value:s[_].value,owner:l.owner.address,block:l.block,start:s[_].start,sponsor:s[_].sponsor,pageRewardAt:s[_].pageRewardAt})}return(0,x.of)(d)}))}confirmReactivateArWikiPage(t,n,r){let s="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(D.f,{data:{title:"Are you sure?",content:"You are about to reactivate an old arwiki page. Do you want to proceed?",pageValue:r+1,second_content:"Please define the amount of $WIKI tokens to stake:"},direction:s}).afterClosed().pipe((0,m.w)(c=>{const d=+c;if(Number.isInteger(d)&&d>0)return this.loadingReactivatePageIntoIndex=!0,this._arwikiToken.updatePageSponsor(t,n,this.routeLang,d,this._auth.getPrivateKey(),L.yh[0]);if(0===d)throw Error("Stake must be greater than 0 $WIKI tokens");return(0,x.of)(null)})).subscribe({next:c=>{c&&(this.updatePageTxMessage=`${c}`,this.message("Success!","success"))},error:c=>{this.updatePageTxErrorMessage=`${c}`,this.message(`${c}`,"error")}})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(y.N),e.Y36(I.e),e.Y36(U.ux),e.Y36(w.uw),e.Y36(v.gz),e.Y36(O.s),e.Y36(M.d))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-deleted-list"]],decls:7,vars:5,consts:[["title","Deleted pages"],["class","spinner-center",4,"ngIf"],[1,"container","page-container"],["class","row fadeIn",4,"ngIf"],[1,"spinner-center"],[1,"row","fadeIn"],["class","col-12 card-page fadeIn",4,"ngIf"],["class","col-12 col-md-6 card-page fadeIn",4,"ngFor","ngForOf"],[1,"col-12","card-page","fadeIn"],[1,"col-12","col-md-6","card-page","fadeIn"],[1,"link","ellipsis","card-header-title",3,"routerLink"],[1,"mbt20"],[1,"mini-text"],[3,"address","isAddress"],[3,"address"],["class","mini-text",4,"ngIf"],["class","red mini-text",4,"ngIf"],[1,"text-right","mt20","card-footer"],["mat-flat-button","","matTooltip","Reactivate and sponsor page",1,"approve-btn",3,"click"],["mat-flat-button","","color","primary","matTooltip","View",3,"routerLink"],[1,"red","mini-text"],["class","green",4,"ngIf"],[4,"ngIf"],[1,"green"],[1,"col","text-center"],[1,"text-center"],["mat-button","","target","_blank",1,"text-center",3,"href"]],template:function(t,n){1&t&&(e._UZ(0,"app-moderators-menu",0),e.YNc(1,ze,1,0,"mat-spinner",1),e.TgZ(2,"div",2),e.YNc(3,ct,3,2,"div",3),e.YNc(4,pt,5,0,"div",3),e.YNc(5,dt,8,3,"div",3),e.YNc(6,lt,6,1,"div",3),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.loadingPages),e.xp6(2),e.Q6J("ngIf",!n.loadingReactivatePageIntoIndex),e.xp6(1),e.Q6J("ngIf",n.loadingReactivatePageIntoIndex&&!n.updatePageTxMessage&&!n.updatePageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",n.updatePageTxMessage),e.xp6(1),e.Q6J("ngIf",n.updatePageTxErrorMessage))},dependencies:[f.sg,f.O5,v.rH,v.yS,Z.zs,Q.gM,k.Hw,q.Ou,R.a8,j.N,E,f.uU,Y.X$],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}.w70[_ngcontent-%COMP%]{width:70%}.ml10[_ngcontent-%COMP%]{margin-left:10px}.w100[_ngcontent-%COMP%]{width:100%}.w50[_ngcontent-%COMP%]{width:50%}.card-page[_ngcontent-%COMP%]{margin-bottom:40px}.mt20[_ngcontent-%COMP%]{margin-top:20px}.link[_ngcontent-%COMP%]{cursor:pointer}.mbt20[_ngcontent-%COMP%]{margin-bottom:20px;margin-top:20px}.card-footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:5px;margin-bottom:10px}.card-header-icon[_ngcontent-%COMP%]{float:right}.card-header-title[_ngcontent-%COMP%]{margin-top:0}.approve-btn[_ngcontent-%COMP%]{background-color:#63c642;color:#fff}"]}),a})();var F=u(29521),G=u(77331);function _t(a,i){1&a&&e._UZ(0,"mat-spinner",4)}function mt(a,i){if(1&a&&(e.TgZ(0,"mat-chip",11),e._uU(1),e.qZA()),2&a){const t=i.$implicit;e.xp6(1),e.hij(" ",t," ")}}function ft(a,i){1&a&&(e.TgZ(0,"mat-icon",25),e._uU(1,"cancel"),e.qZA())}function ht(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"mat-chip",23),e.NdJ("removed",function(){const o=e.CHM(t).$implicit,s=e.oxw(3);return e.KtG(s.remove(o))}),e._uU(1),e.YNc(2,ft,2,0,"mat-icon",24),e.qZA()}if(2&a){const t=i.$implicit,n=e.oxw(3);e.Q6J("selectable",n.selectable)("removable",n.removable),e.xp6(1),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",n.removable)}}function vt(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"div",12)(1,"h3",13),e._uU(2,"Create tags:"),e.qZA(),e.TgZ(3,"form",14),e.NdJ("ngSubmit",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onSubmit())}),e.TgZ(4,"mat-form-field",15)(5,"mat-label"),e._uU(6,"Tags"),e.qZA(),e.TgZ(7,"mat-chip-list",16,17),e.YNc(9,ht,3,4,"mat-chip",18),e.TgZ(10,"input",19),e.NdJ("matChipInputTokenEnd",function(r){e.CHM(t);const o=e.oxw(2);return e.KtG(o.add(r))}),e.qZA()(),e.TgZ(11,"mat-hint",20),e._uU(12,"Separate tags by comma"),e.qZA()(),e.TgZ(13,"div",21)(14,"button",22)(15,"mat-icon"),e._uU(16,"save"),e.qZA(),e._uU(17," Save "),e.qZA()()()()}if(2&a){const t=e.MAs(8),n=e.oxw(2);e.xp6(3),e.Q6J("formGroup",n.frmTags),e.xp6(6),e.Q6J("ngForOf",n.tags),e.xp6(1),e.Q6J("matChipInputFor",t)("matChipInputSeparatorKeyCodes",n.separatorKeysCodes)("matChipInputAddOnBlur",n.addOnBlur),e.xp6(4),e.Q6J("disabled",!n.tags.length||n.loadingSavingTags)}}function xt(a,i){1&a&&e._UZ(0,"mat-spinner",4)}function At(a,i){if(1&a&&(e.TgZ(0,"div",12),e._uU(1),e.ALo(2,"json"),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.hij(" The following TX were created: ",e.lcZ(2,1,t.savingTagsTX)," ")}}function Tt(a,i){if(1&a&&(e.TgZ(0,"div",5)(1,"div",6)(2,"strong"),e._uU(3,"Title:"),e.qZA(),e._uU(4),e._UZ(5,"br"),e.TgZ(6,"strong"),e._uU(7,"Slug:"),e.qZA(),e.TgZ(8,"a",7)(9,"mat-icon"),e._uU(10,"visibility"),e.qZA(),e._uU(11),e.qZA(),e._UZ(12,"br"),e.TgZ(13,"strong"),e._uU(14,"Category"),e.qZA(),e._uU(15),e._UZ(16,"br"),e.TgZ(17,"strong"),e._uU(18,"Language:"),e.qZA(),e._uU(19),e.qZA(),e.TgZ(20,"div",6)(21,"strong"),e._uU(22,"Owner:"),e.qZA(),e._uU(23),e.qZA(),e.TgZ(24,"div",6)(25,"strong"),e._uU(26,"Current tags:"),e.qZA(),e.TgZ(27,"mat-chip-list",8),e.YNc(28,mt,2,1,"mat-chip",9),e.qZA()(),e.YNc(29,vt,18,6,"div",10),e.YNc(30,xt,1,0,"mat-spinner",1),e.YNc(31,At,3,3,"div",10),e.qZA()),2&a){const t=e.oxw();e.xp6(4),e.hij(" ",t.page.title," "),e.xp6(4),e.MGl("routerLink","../../../",t.page.slug,""),e.xp6(3),e.hij(" ",t.page.slug," "),e.xp6(4),e.hij(": ",t.page.category," "),e.xp6(4),e.hij(" ",t.page.language," "),e.xp6(4),e.hij(" ",t.page.owner," "),e.xp6(5),e.Q6J("ngForOf",t.currentTags),e.xp6(1),e.Q6J("ngIf",!t.loadingSavingTags&&!t.savingTagsTX.length),e.xp6(1),e.Q6J("ngIf",t.loadingSavingTags),e.xp6(1),e.Q6J("ngIf",t.savingTagsTX.length)}}let wt=(()=>{class a{constructor(t,n,r,o,s,p,c){this.route=t,this._arweave=n,this._snackBar=r,this._location=o,this._dialog=s,this._auth=p,this._arwikiToken=c,this.pageSubscription=P.w0.EMPTY,this.tagsSubscription=P.w0.EMPTY,this.loadingPage=!1,this.baseURL=this._arweave.baseURL,this.visible=!0,this.selectable=!0,this.removable=!0,this.addOnBlur=!0,this.separatorKeysCodes=[F.K5,F.OC],this.tags=[],this.currentTags=[],this.frmTags=new T.nJ({newTags:new T.p4("")}),this.loadingSavingTags=!1,this.savingTagsTX=[],this.routeLang=""}get newTags(){return this.frmTags.get("tags")}ngOnInit(){var t=this;return(0,h.Z)(function*(){t.routeLang=t.route.snapshot.paramMap.get("lang"),t._arwiki=new L.iN(t._arweave.arweave);const n=t.route.snapshot.paramMap.get("slug");t.arwikiQuery=new N.x(t._arweave.arweave),t.loadPageTXData(n),yield t.loadTags(n)})()}ngOnDestroy(){this.pageSubscription&&this.pageSubscription.unsubscribe(),this.tagsSubscription&&this.tagsSubscription.unsubscribe()}loadPageTXData(t){this.loadingPage=!0,this.pageSubscription=this._arwikiToken.getApprovedPages(this.routeLang).pipe((0,m.w)(n=>this.arwikiQuery.getTXsData([n&&n[t]?n[t].content:""]))).subscribe({next:n=>{if(n&&n.length){const o=new C.default(n[0],this._arweave.arweave);this.page={id:o.id,title:this.searchKeyNameInTags(o.tags,"Arwiki-Page-Title"),slug:this.searchKeyNameInTags(o.tags,"Arwiki-Page-Slug"),category:this.searchKeyNameInTags(o.tags,"Arwiki-Page-Category"),language:this.searchKeyNameInTags(o.tags,"Arwiki-Page-Lang"),img:this.searchKeyNameInTags(o.tags,"Arwiki-Page-Img"),owner:o.owner.address,block:o.block}}this.loadingPage=!1},error:n=>{this.message(n,"error"),this.loadingPage=!1}})}loadTags(t){var n=this;return(0,h.Z)(function*(){let o,s=0;try{o=yield n._arweave.arweave.network.getInfo(),s=o.height}catch(p){return void n.message(`${p}`,"error")}n.tagsSubscription=n.arwikiQuery.getVerifiedTagsFromSlug(n._auth.getAdminList(),t,n.routeLang,100,s).subscribe({next:p=>{n.currentTags=[];for(let c of p){const d=new C.default(c,n._arweave.arweave);n.currentTags.push(n.searchKeyNameInTags(d.tags,"Arwiki-Page-Tag"))}},error:p=>{n.message(p,"error")}})})()}message(t,n="",r){this._snackBar.open(t,"X",{duration:5e3,horizontalPosition:"center",verticalPosition:r,panelClass:n})}goBack(){this._location.back()}searchKeyNameInTags(t,n){for(const o of t)if(o.name.toUpperCase()===n.toUpperCase())return o.value;return""}add(t){const n=t.input,r=t.value;(r||"").trim()&&this.tags.push({name:r.trim()}),n&&(n.value="")}remove(t){const n=this.tags.indexOf(t);n>=0&&this.tags.splice(n,1)}onSubmit(){this.confirmSaveTags(this.tags,this.page.category,this.page.id,this.page.language,this.page.slug)}confirmSaveTags(t,n,r,o,s){var p=this;const c=t.map(l=>l.name),d=`You are about to create the next tags: ${c.join()}. Do you want to proceed?`;this._dialog.open(J.p,{data:{title:"Are you sure?",content:d}}).afterClosed().subscribe(function(){var l=(0,h.Z)(function*(_){if(_){p.loadingSavingTags=!0;try{p.savingTagsTX=[];for(let A of c){const b=yield p._arwiki.createTagTXForArwikiPage(r,A,n,p.routeLang,s,p._auth.getPrivateKey());p.savingTagsTX.push(b)}p.message("Success!","success")}catch(A){p.message(`${A}`,"error")}p.loadingSavingTags=!1}});return function(_){return l.apply(this,arguments)}}())}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(v.gz),e.Y36(y.N),e.Y36(U.ux),e.Y36(f.Ye),e.Y36(w.uw),e.Y36(I.e),e.Y36(M.d))},a.\u0275cmp=e.Xpm({type:a,selectors:[["ng-component"]],decls:4,vars:2,consts:[["title","Tag manager"],["class","spinner-center",4,"ngIf"],[1,"container","tagm-page-container"],["class","row",4,"ngIf"],[1,"spinner-center"],[1,"row"],[1,"col-12"],["mat-flat-button","",3,"routerLink"],["aria-label","Current tags"],["color","primary","selected","",4,"ngFor","ngForOf"],["class","col-12 text-center",4,"ngIf"],["color","primary","selected",""],[1,"col-12","text-center"],[1,"text-left"],[3,"formGroup","ngSubmit"],["id","tags-input-container",1,"w70"],["aria-label","Add tags",1,"tags-input"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["placeholder","Add tag...","formControlName","newTags",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["align","start"],[1,"text-center"],["mat-flat-button","","color","primary",3,"disabled"],[3,"selectable","removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""]],template:function(t,n){1&t&&(e._UZ(0,"app-moderators-menu",0),e.YNc(1,_t,1,0,"mat-spinner",1),e.TgZ(2,"div",2),e.YNc(3,Tt,32,10,"div",3),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.loadingPage),e.xp6(2),e.Q6J("ngIf",n.page&&!n.loadingPage))},dependencies:[f.sg,f.O5,v.yS,S.KE,S.bx,S.hX,Z.lW,Z.zs,k.Hw,T._Y,T.Fj,T.JJ,T.JL,T.sg,T.u,q.Ou,G.qn,G.HS,G.oH,G.qH,E,f.Ts],styles:[".tagm-page-container[_ngcontent-%COMP%]{min-height:600px}.page-title[_ngcontent-%COMP%], .page-title-buttons[_ngcontent-%COMP%]{margin-top:50px;margin-bottom:50px}.page-img[_ngcontent-%COMP%]{max-width:100%}.w70[_ngcontent-%COMP%]{width:70%}.ml10[_ngcontent-%COMP%]{margin-left:10px}.w100[_ngcontent-%COMP%]{width:100%}"]}),a})();var Zt=u(12190);function Pt(a,i){1&a&&e._UZ(0,"mat-spinner",5)}function Lt(a,i){1&a&&(e.TgZ(0,"div",9),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"MODERATORS.LABEL_NO_RESULTS")," "))}function kt(a,i){if(1&a&&(e.TgZ(0,"mat-card",25),e._UZ(1,"img",26),e.qZA()),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(1),e.s9C("src",n.baseURL+n.pages[t].img,e.LSH)}}function Ct(a,i){1&a&&(e.TgZ(0,"div",27)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&a&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_TX_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_TX_PENDING")," "))}function bt(a,i){if(1&a&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_HEIGHT"),":"),e.xp6(2),e.hij(" ",n.pages[t].block.height," ")}}function It(a,i){if(1&a&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"date"),e.qZA()),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_TIMESTAMP"),":"),e.xp6(2),e.hij(" ",e.xi3(5,4,n.timestampToDate(n.pages[t].block.timestamp),"short")," ")}}function yt(a,i){if(1&a&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_ARVERIFY_SCORE"),": "),e.xp6(2),e.hij(" ",n.arverifyProcessedAddressesMap[n.pages[t].owner].percentage," % ")}}function Mt(a,i){1&a&&(e.TgZ(0,"div",28)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"mat-icon"),e._uU(5,"verified_user"),e.qZA(),e._uU(6),e.ALo(7,"translate"),e.qZA()),2&a&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_OWNER_STATUS"),": "),e.xp6(4),e.hij(" ",e.lcZ(7,4,"PAGE.STATUS_ADDRESS_VERIFIED")," "))}function Ut(a,i){1&a&&(e.TgZ(0,"div",27)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&a&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_OWNER_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_ADDRESS_NOTVERIFIED")," "))}function St(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"div",10)(1,"mat-card")(2,"h2",11),e._uU(3),e.qZA(),e.YNc(4,kt,2,1,"mat-card",12),e.TgZ(5,"div"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"div"),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"div"),e._uU(15),e.qZA(),e._UZ(16,"hr",13),e.YNc(17,Ct,6,6,"div",14),e.TgZ(18,"div",15)(19,"app-arweave-address",16),e._uU(20),e.ALo(21,"translate"),e.qZA()(),e.TgZ(22,"div",15)(23,"app-arweave-address",17),e._uU(24),e.ALo(25,"translate"),e.qZA()(),e.YNc(26,bt,5,4,"div",18),e.YNc(27,It,6,7,"div",18),e.YNc(28,yt,5,4,"div",18),e.YNc(29,Mt,8,6,"div",19),e.YNc(30,Ut,6,6,"div",14),e.TgZ(31,"div",20)(32,"a",21),e.NdJ("click",function(){const o=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.confirmValidateArWikiPage(s.pages[o].slug,s.pages[o].id,s.pages[o].category,s.pages[o].value,s.pages[o].owner))}),e.TgZ(33,"mat-icon"),e._uU(34,"done"),e.qZA(),e._uU(35," Approve "),e.qZA(),e.TgZ(36,"a",22)(37,"mat-icon"),e._uU(38,"visibility"),e.qZA(),e._uU(39," Preview "),e.qZA(),e.TgZ(40,"a",23)(41,"mat-icon"),e._uU(42,"visibility"),e.qZA(),e._uU(43," Original "),e.qZA(),e.TgZ(44,"a",24),e.NdJ("click",function(){const o=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.compare(s.pages[o].id,s.pages[o].slug))}),e.TgZ(45,"mat-icon"),e._uU(46,"difference"),e.qZA(),e._uU(47," Differences "),e.qZA()()()()}if(2&a){const t=i.$implicit,n=e.oxw(2);e.xp6(2),e.MGl("routerLink","../../../preview/",n.pages[t].id,""),e.xp6(1),e.hij(" ",n.pages[t].title," "),e.xp6(1),e.Q6J("ngIf",n.pages[t].img),e.xp6(2),e.AsE(" ",e.lcZ(7,23,"PAGE.LABEL_SLUG"),": ",n.pages[t].slug," "),e.xp6(3),e.AsE(" ",e.lcZ(10,25,"PAGE.LABEL_CATEGORY"),": ",n.pages[t].category," "),e.xp6(3),e.AsE(" ",e.lcZ(13,27,"PAGE.LABEL_LANGUAGE"),": ",n.pages[t].language," "),e.xp6(3),e.hij(" Page value: ",n.pages[t].value," $WIKI "),e.xp6(2),e.Q6J("ngIf",!n.pages[t].block||!n.pages[t].block.height),e.xp6(2),e.Q6J("address",n.pages[t].id)("isAddress",!1),e.xp6(1),e.hij("",e.lcZ(21,29,"PAGE.LABEL_ID"),": "),e.xp6(3),e.Q6J("address",n.pages[t].owner),e.xp6(1),e.hij("",e.lcZ(25,31,"PAGE.LABEL_OWNER"),": "),e.xp6(2),e.Q6J("ngIf",n.pages[t].block&&n.pages[t].block.height),e.xp6(1),e.Q6J("ngIf",n.pages[t].block&&n.pages[t].block.timestamp),e.xp6(1),e.Q6J("ngIf",n.arverifyProcessedAddressesMap[n.pages[t].owner]&&n.arverifyProcessedAddressesMap[n.pages[t].owner].percentage),e.xp6(1),e.Q6J("ngIf",n.arverifyProcessedAddressesMap[n.pages[t].owner]&&n.arverifyProcessedAddressesMap[n.pages[t].owner].verified),e.xp6(1),e.Q6J("ngIf",!n.arverifyProcessedAddressesMap[n.pages[t].owner]||!n.arverifyProcessedAddressesMap[n.pages[t].owner].verified),e.xp6(6),e.MGl("routerLink","../../../preview/",n.pages[t].id,""),e.xp6(4),e.MGl("routerLink","../../../",n.pages[t].slug,"")}}function Et(a,i){if(1&a&&(e.TgZ(0,"div",6),e.YNc(1,Lt,3,3,"div",7),e.YNc(2,St,48,33,"div",8),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(t.loadingPendingPages||t.pages&&t.getKeys(t.pages).length)),e.xp6(1),e.Q6J("ngForOf",t.getKeys(t.pages))}}function Ot(a,i){1&a&&(e.TgZ(0,"div",29)(1,"div",30),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",31),e._uU(4,"\u{1f680} Hold on! We are almost there!"),e.qZA()()())}function Nt(a,i){if(1&a&&(e.TgZ(0,"div",29)(1,"div",30)(2,"h1",31),e._uU(3,"\u{1f973} Page successfully approved!"),e.qZA(),e.TgZ(4,"p",31),e._uU(5),e.qZA(),e.TgZ(6,"a",32),e._uU(7),e.qZA()()()),2&a){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.insertPageTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.insertPageTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.insertPageTxMessage," ")}}function qt(a,i){if(1&a&&(e.TgZ(0,"div",29)(1,"div",30)(2,"h1",31),e._uU(3,"Oops! something went wrong"),e.qZA(),e.TgZ(4,"p",31),e._uU(5),e.qZA()()()),2&a){const t=e.oxw();e.xp6(5),e.Oqu(t.insertPageTxErrorMessage)}}const Dt=[{path:"",canActivateChild:[W.a,z],children:[{path:"pending",component:xe},{path:"approved",component:Ve},{path:"deleted",component:ut},{path:"tag-manager/:slug",component:wt},{path:"page-updates/:slug",component:(()=>{class a{constructor(t,n,r,o,s,p,c){this._arweave=t,this._auth=n,this._snackBar=r,this._dialog=o,this._route=s,this._userSettings=p,this._arwikiTokenContract=c,this.loadingPendingPages=!1,this.pages={},this.pendingPagesSubscription=P.w0.EMPTY,this.arverifyProcessedAddressesMap={},this.loadingInsertPageIntoIndex=!1,this.insertPageTxMessage="",this.insertPageTxErrorMessage="",this.routeLang="",this.baseURL=this._arweave.baseURL,this.pageSlug=""}ngOnInit(){var t=this;return(0,h.Z)(function*(){t._auth.getAdminList(),t.routeLang=t._route.snapshot.paramMap.get("lang"),t.pageSlug=t._route.snapshot.paramMap.get("slug"),t.arwikiQuery=new N.x(t._arweave.arweave),t.loadingPendingPages=!0;let o,s=0;try{o=yield t._arweave.arweave.network.getInfo(),s=o.height}catch(p){return void t.message(`${p}`,"error")}var p;t.pendingPagesSubscription=t.arwikiQuery.getPendingPagesUpdates(t.routeLang,t.pageSlug,100,s).pipe((0,m.w)(p=>{let c={};for(let d of p){const g=new C.default(d,t._arweave.arweave);c[g.id]={id:g.id,title:t.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Title"),slug:t.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Slug"),category:t.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Category"),language:t.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Lang"),img:t.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Img"),owner:g.owner.address,block:g.block,value:t.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Value")}}return(0,x.of)(c)}),(0,m.w)(p=>t._arwikiTokenContract.getApprovedPages(t.routeLang,-1,!0).pipe((0,m.w)(c=>{let d={},g=[];for(const l of Object.keys(c)){const _=c[l].updates.map(A=>A.tx);g=g.concat(_)}for(let l in p)g.indexOf(l)>=0||(d[l]=p[l]);return(0,x.of)(d)})))).subscribe({next:(p=(0,h.Z)(function*(c){t.pages=c,t.loadingPendingPages=!1,t.arverifyProcessedAddressesMap={};for(let d of Object.keys(c)){if(Object.prototype.hasOwnProperty.call(t.arverifyProcessedAddressesMap,c[d].owner))continue;const g=yield t.getArverifyVerification(c[d].owner);t.arverifyProcessedAddressesMap[c[d].owner]=g}}),function(d){return p.apply(this,arguments)}),error:p=>{t.message(p,"error"),t.loadingPendingPages=!1}})})()}message(t,n="",r){this._snackBar.open(t,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:r,panelClass:n})}ngOnDestroy(){this.pendingPagesSubscription&&this.pendingPagesSubscription.unsubscribe()}getArverifyVerification(t){return(0,h.Z)(function*(){const n=yield(0,$.Ni)(t);return{verified:n.verified,icon:n.icon,percentage:n.percentage}})()}underscoreToSpace(t){return t.replace(/[_]/gi," ")}confirmValidateArWikiPage(t,n,r,o,s){let c="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(D.f,{data:{title:"Are you sure?",content:"You are about to approve a new arwiki page update. Do you want to proceed?",second_content:"Please define the page update value in $WIKI tokens:",pageValue:o},direction:c}).afterClosed().pipe((0,m.w)(g=>{const l=+g;if(Number.isInteger(l)&&l>0)return this.loadingInsertPageIntoIndex=!0,this._arwikiTokenContract.approvePageUpdate(n,s,t,r,this.routeLang,l,this._auth.getPrivateKey(),L.yh[0]);if(0===l)throw Error("Stake must be greater than 0 $WIKI tokens");return(0,x.of)(null)})).subscribe({next:g=>{g&&(this.insertPageTxMessage=`${g}`,this.message("Success!","success"))},error:g=>{this.insertPageTxErrorMessage=`${g}`,this.message(`${g}`,"error")}})}timestampToDate(t){return new Date(1e3*t)}getKeys(t){return Object.keys(t)}compare(t,n){let o="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(Zt.e,{data:{newPage:t,slug:n,lang:this.routeLang},direction:o}).afterClosed().subscribe({next:()=>{},error:p=>{this.message(`${p}`,"error")}})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(y.N),e.Y36(I.e),e.Y36(U.ux),e.Y36(w.uw),e.Y36(v.gz),e.Y36(O.s),e.Y36(M.d))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-page-updates"]],decls:7,vars:5,consts:[["title","Pending updates"],["class","spinner-center",4,"ngIf"],[1,"container","page-container","fadeIn"],["class","row",4,"ngIf"],["class","row fadeIn",4,"ngIf"],[1,"spinner-center"],[1,"row"],["class","col-12 card-page fadeIn",4,"ngIf"],["class","col-12 col-md-6 card-page fadeIn",4,"ngFor","ngForOf"],[1,"col-12","card-page","fadeIn"],[1,"col-12","col-md-6","card-page","fadeIn"],[1,"link",3,"routerLink"],["class","card-image text-center",4,"ngIf"],[1,"mbt20"],["class","red mini-text",4,"ngIf"],[1,"mini-text"],[3,"address","isAddress"],[3,"address"],["class","mini-text",4,"ngIf"],["class","green mini-text",4,"ngIf"],[1,"text-right"],["mat-flat-button","","matTooltip","Approve page update",1,"approve-btn","card-btn",3,"click"],["mat-flat-button","","color","primary","matTooltip","Preview",1,"card-btn",3,"routerLink"],["mat-flat-button","","color","primary","matTooltip","Original",1,"card-btn",3,"routerLink"],["mat-flat-button","","color","primary","matTooltip","Compare versions",1,"card-btn",3,"click"],[1,"card-image","text-center"],[3,"src"],[1,"red","mini-text"],[1,"green","mini-text"],[1,"row","fadeIn"],[1,"col","text-center"],[1,"text-center"],["mat-button","","target","_blank",1,"text-center",3,"href"]],template:function(t,n){1&t&&(e._UZ(0,"app-moderators-menu",0),e.YNc(1,Pt,1,0,"mat-spinner",1),e.TgZ(2,"div",2),e.YNc(3,Et,3,2,"div",3),e.YNc(4,Ot,5,0,"div",4),e.YNc(5,Nt,8,3,"div",4),e.YNc(6,qt,6,1,"div",4),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.loadingPendingPages),e.xp6(2),e.Q6J("ngIf",!n.loadingInsertPageIntoIndex),e.xp6(1),e.Q6J("ngIf",n.loadingInsertPageIntoIndex&&!n.insertPageTxMessage&&!n.insertPageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",n.insertPageTxMessage),e.xp6(1),e.Q6J("ngIf",n.insertPageTxErrorMessage))},dependencies:[f.sg,f.O5,v.rH,v.yS,Z.zs,Q.gM,k.Hw,q.Ou,R.a8,j.N,E,f.uU,Y.X$],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}.w70[_ngcontent-%COMP%]{width:70%}.ml10[_ngcontent-%COMP%]{margin-left:10px}.w100[_ngcontent-%COMP%]{width:100%}.w50[_ngcontent-%COMP%]{width:50%}.card-page[_ngcontent-%COMP%]{margin-bottom:40px}.approve-btn[_ngcontent-%COMP%]{background-color:#63c642;color:#fff}.link[_ngcontent-%COMP%]{cursor:pointer}.mini-text[_ngcontent-%COMP%]{font-size:12px}.mbt20[_ngcontent-%COMP%]{margin-bottom:20px;margin-top:20px}.card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.card-btn[_ngcontent-%COMP%]{margin-left:5px;margin-bottom:5px}"]}),a})()},{path:"add-admin",component:Ae},{path:"view-admin-list",component:Ze},{path:"",redirectTo:"pending",pathMatch:"full"}]}];let Qt=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[v.Bz.forChild(Dt),v.Bz]}),a})(),Rt=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[f.ez,Qt,X.m]}),a})()}}]);