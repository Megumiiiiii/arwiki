"use strict";(self.webpackChunkarwiki=self.webpackChunkarwiki||[]).push([[121],{16666:(et,v,i)=>{i.r(v),i.d(v,{CategoryModule:()=>K});var f=i(36895),y=i(37101),m=i(89299),d=i(15861),C=i(51614),T=i(50727),P=i(39646),I=i(31783),h=i(63900),L=i(38952),t=i(94650),A=i(68853),S=i(75501),Z=i(17009),M=i(69817),O=i(4859),z=i(97392),b=i(51572),N=i(65503),D=i(98739),k=i(13081);function B(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",8)(1,"h1",9),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",10)(6,"button",11),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.goBack())}),t.TgZ(7,"mat-icon"),t._uU(8,"navigate_before"),t.qZA(),t._uU(9),t.ALo(10,"translate"),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(2),t.AsE(" ",t.lcZ(3,3,"CATEGORY.BREADCRUMB_LABEL")," ",t.lcZ(4,5,"MAIN_MENU."+e.category)," "),t.xp6(7),t.hij(" ",t.lcZ(10,7,"GENERAL.BUTTONS.GO_BACK")," ")}}function E(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",8)(1,"div",3)(2,"mat-paginator",12),t.NdJ("page",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.paginatorEvent(o))}),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("length",e.paginatorLength)("pageSize",e.paginatorPageSize)("showFirstLastButtons",!0)("pageSizeOptions",e.paginatorPageSizeOptions)("pageIndex",e.paginatorPageIndex)}}function R(n,r){1&n&&t._UZ(0,"mat-spinner",13)}function Q(n,r){1&n&&(t.TgZ(0,"div",15),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"GENERAL.LABELS.NO_RESULTS")," "))}function V(n,r){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,Q,3,3,"div",14),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.pages.length)}}function Y(n,r){if(1&n&&(t.TgZ(0,"div",17),t._UZ(1,"app-article-card",18),t.qZA()),2&n){const e=r.$implicit,a=t.oxw(2);t.xp6(1),t.Q6J("article",e)("routeLang",a.routeLang)("baseURL",a.baseURL)("defaultTheme",a.defaultTheme)}}function J(n,r){if(1&n&&(t.TgZ(0,"div",2),t.YNc(1,Y,2,4,"div",16),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.paginatedResults())}}function U(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",19)(1,"div",3)(2,"mat-paginator",12),t.NdJ("page",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.paginatorEvent(o))}),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("length",e.paginatorLength)("pageSize",e.paginatorPageSize)("showFirstLastButtons",!0)("pageSizeOptions",e.paginatorPageSizeOptions)("pageIndex",e.paginatorPageIndex)}}const _=[{path:":category",component:(()=>{class n{constructor(e,a,o,s,l,u){this._arweave=e,this._arwikiTokenContract=a,this._snackBar=o,this._route=s,this._location=l,this._userSettings=u,this.pagesSubscription=T.w0.EMPTY,this.loadingPages=!1,this.category="",this.pages=[],this.routeLang="",this.baseURL=this._arweave.baseURL,this.arverifyProcessedAddressesMap={},this.defaultTheme="",this.errorLoadingCategory=!1,this.paginatorLength=0,this.paginatorPageSize=4,this.paginatorPageIndex=0,this.paginatorPageSizeOptions=[4,12,24]}ngOnInit(){var e=this;return(0,d.Z)(function*(){e.arwikiQuery=new C.x(e._arweave.arweave),e.category=e._route.snapshot.paramMap.get("category"),e.routeLang=e._route.snapshot.paramMap.get("lang"),e.getDefaultTheme(),e._route.paramMap.subscribe(function(){var a=(0,d.Z)(function*(o){e.routeLang=o.get("lang"),e.category=o.get("category"),yield e._loadContent()});return function(o){return a.apply(this,arguments)}}())})()}_loadContent(){var e=this;return(0,d.Z)(function*(){e.loadingPages=!0;let a,o=0;e.paginatorPageIndex=0;try{a=yield e._arweave.arweave.network.getInfo(),o=a.height}catch(s){return void e.message(`${s}`,"error")}var s;e.pagesSubscription=e.getPagesByCategory(e.category,e.routeLang,o).subscribe({next:(s=(0,d.Z)(function*(l){e.pages=l,e.loadingPages=!1,e.paginatorLength=e.pages?e.pages.length:0}),function(u){return s.apply(this,arguments)}),error:s=>{e.message(s,"error"),e.loadingPages=!1,e.errorLoadingCategory=!0}})})()}slugToLabel(e){return e.replace(/_/gi," ")}message(e,a="",o){this._snackBar.open(e,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:o,panelClass:a})}ngOnDestroy(){this.pagesSubscription&&this.pagesSubscription.unsubscribe()}getArverifyVerification(e){return(0,d.Z)(function*(){const a=yield(0,I.Ni)(e);return{verified:a.verified,icon:a.icon,percentage:a.percentage}})()}sanitizeMarkdown(e){return`${(e=e.replace(/[#*=\[\]]/gi,"")).substring(0,250)} ...`}sanitizeImg(e){return e.indexOf("http")>=0?e:e?`${this.baseURL}${e}`:""}goBack(){this._location.back()}getPagesByCategory(e,a,o,s=100){let l=[],u=[],x={};return this._arwikiTokenContract.getAdminList().pipe((0,h.w)(g=>(l=g,this._arwikiTokenContract.getCategories())),(0,h.w)(g=>{if(!(e in g))throw new Error("Invalid category!");return this._arwikiTokenContract.getApprovedPages(a,-1,!0)}),(0,h.w)(g=>(x=g,u=Object.keys(g).filter(p=>g[p].category===e).map(p=>g[p].content),this.arwikiQuery.getTXsData(u))),(0,h.w)(g=>{const p=[];for(let G of g){const c=new L.default(G,this._arweave.arweave),j=this.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Title"),w=this.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Slug"),H=this.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Category"),$=this.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Img"),X=this.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Lang");p.push({title:j,slug:w,category:H,img:$,owner:c.owner.address,id:c.id,language:X,sponsor:x[w].sponsor})}return(0,P.of)(p)}))}getDefaultTheme(){this.defaultTheme=this._userSettings.getDefaultTheme(),this._userSettings.defaultThemeStream.subscribe(e=>{this.defaultTheme=e})}validateObj(e){return!!Object.keys(e).length}paginatorEvent(e){this.paginatorPageSize=e.pageSize,this.paginatorPageIndex=e.pageIndex}paginatedResults(){return this.pages.slice(this.paginatorPageIndex*this.paginatorPageSize,this.paginatorPageIndex*this.paginatorPageSize+this.paginatorPageSize)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(A.N),t.Y36(S.d),t.Y36(Z.ux),t.Y36(m.gz),t.Y36(f.Ye),t.Y36(M.s))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],decls:9,vars:6,consts:[[1,"container","category-page-container"],["class","row fadeIn",4,"ngIf"],[1,"row"],[1,"col-12"],["class","spinner-center",4,"ngIf"],[4,"ngIf"],["class","row",4,"ngIf"],["class","row fadeIn footer-paginator",4,"ngIf"],[1,"row","fadeIn"],[1,"page-title","col-12","col-md-9"],[1,"text-right","page-title-buttons","col-12","col-md-3"],["type","button","mat-button","","color","primary",1,"btn-toolbar",3,"click"],["aria-label","Select page",3,"length","pageSize","showFirstLastButtons","pageSizeOptions","pageIndex","page"],[1,"spinner-center"],["class","text-left fadeIn no-results",4,"ngIf"],[1,"text-left","fadeIn","no-results"],["class","col-12 col-md-6 card-page fadeIn",4,"ngFor","ngForOf"],[1,"col-12","col-md-6","card-page","fadeIn"],[3,"article","routeLang","baseURL","defaultTheme"],[1,"row","fadeIn","footer-paginator"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0),t.YNc(1,B,11,9,"div",1),t.YNc(2,E,3,5,"div",1),t.TgZ(3,"div",2)(4,"div",3),t.YNc(5,R,1,0,"mat-spinner",4),t.YNc(6,V,2,1,"div",5),t.qZA()(),t.YNc(7,J,2,1,"div",6),t.YNc(8,U,3,5,"div",7),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",!a.loadingPages&&!a.errorLoadingCategory),t.xp6(1),t.Q6J("ngIf",!a.loadingPages&&!a.errorLoadingCategory),t.xp6(3),t.Q6J("ngIf",a.loadingPages),t.xp6(1),t.Q6J("ngIf",!a.loadingPages),t.xp6(1),t.Q6J("ngIf",!a.loadingPages),t.xp6(1),t.Q6J("ngIf",!a.loadingPages&&!a.errorLoadingCategory))},dependencies:[f.sg,f.O5,O.lW,z.Hw,b.Ou,N.y,D.NW,k.X$],styles:[".category-page-container[_ngcontent-%COMP%]{min-height:600px;margin-top:100px}.card-title[_ngcontent-%COMP%]{font-size:2.5rem;font-family:Roboto Mono,monospace;margin-bottom:20px;cursor:pointer}.card-page[_ngcontent-%COMP%]{margin-bottom:20px;margin-top:20px}.card-preview[_ngcontent-%COMP%]{margin-bottom:20px}.mini-text[_ngcontent-%COMP%]{font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.page-title[_ngcontent-%COMP%], .page-title-buttons[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}.btn-toolbar[_ngcontent-%COMP%]{color:inherit}.footer-paginator[_ngcontent-%COMP%]{margin-bottom:40px}.no-results[_ngcontent-%COMP%]{padding:20px;height:400px}"]}),n})()}];let F=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.Bz.forChild(_),m.Bz]}),n})(),K=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[f.ez,F,y.m]}),n})()}}]);