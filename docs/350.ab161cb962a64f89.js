"use strict";(self.webpackChunkarwiki=self.webpackChunkarwiki||[]).push([[350],{42350:(Wn,K,u)=>{u.r(K),u.d(K,{ModeratorsModule:()=>Xn});var f=u(36895),V=u(37101),A=u(89299),ee=u(3870),T=u(39646),m=u(63900),te=u(70262),e=u(94650),k=u(32511),M=u(68853),C=u(75501),L=u(17009),O=u(69817);let ne=(()=>{class n{constructor(t,i,o,s,r){this._auth=t,this._arweave=i,this._arwikiTokenContract=o,this._snackBar=s,this._userSettings=r}canActivate(t,i){return this.isUserModerator()}canActivateChild(t,i){return this.isUserModerator()}isUserModerator(){const t=this._auth.getMainAddressSnapshot();return this._userSettings.updateMainToolbarLoading(!0),this._arwikiTokenContract.getAdminList().pipe((0,m.w)(i=>{const o=i.indexOf(t)>=0;return this._auth.setAdminList(i),this._userSettings.updateMainToolbarLoading(!1),o?(0,T.of)(!0):(this.message("You are not a moderator!","error"),(0,T.of)(!1))}),(0,te.K)(i=>(this.message(i,"error"),(0,T.of)(!1))))}message(t,i="",o){this._snackBar.open(t,"X",{duration:4e3,horizontalPosition:"center",verticalPosition:o,panelClass:i})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(k.e),e.LFG(M.N),e.LFG(C.d),e.LFG(L.ux),e.LFG(O.s))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var h=u(15861),y=u(50727),F=u(31783),j=u(22333),w=u(65938),P=u(4859),b=u(97392),E=u(59549),X=u(44144),Y=u(13081);let ie=(()=>{class n{constructor(t){this.data=t}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(w.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dialog-reject-reason"]],decls:21,vars:12,consts:[["mat-dialog-title",""],[1,"red","title-icon"],["appearance","outline",1,"txt-reason"],["matInput","",1,"txt-reason"],["reason",""],["align","end"],["mat-button","",3,"disabled","mat-dialog-close"],["mat-button","","mat-dialog-close","","cdkFocusInitial",""]],template:function(t,i){if(1&t&&(e.TgZ(0,"h2",0)(1,"mat-icon",1),e._uU(2,"delete"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()(),e.TgZ(6,"mat-dialog-content")(7,"p"),e._uU(8),e.qZA(),e.TgZ(9,"mat-form-field",2)(10,"mat-label"),e._uU(11,"Reason"),e.qZA(),e._UZ(12,"textarea",3,4),e.qZA()(),e.TgZ(14,"mat-dialog-actions",5)(15,"button",6),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"button",7),e._uU(19),e.ALo(20,"translate"),e.qZA()()),2&t){const o=e.MAs(13);e.xp6(4),e.hij("",e.lcZ(5,6,"DIALOGS.TXT_CLOSE"),"Reject page"),e.xp6(4),e.hij("You are about to reject a page with tx id ",i.data.id,". Do you want to proceed? Please add a reason to continue."),e.xp6(7),e.Q6J("disabled",!o.value)("mat-dialog-close",o.value),e.xp6(1),e.Oqu(e.lcZ(17,8,"DIALOGS.TXT_CONFIRM")),e.xp6(3),e.Oqu(e.lcZ(20,10,"DIALOGS.TXT_CLOSE"))}},dependencies:[w.ZT,w.uh,w.xY,w.H8,P.lW,b.Hw,E.KE,E.hX,X.Nt,Y.X$],styles:[".title-icon[_ngcontent-%COMP%]{font-size:40px;line-height:40px;width:40px;height:40px;vertical-align:middle}.mat-dialog-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:12px;vertical-align:middle;font-size:26px;font-family:Roboto Mono,monospace;line-height:38px}.txt-reason[_ngcontent-%COMP%]{width:100%}"]}),n})();var N=u(51614),S=u(89716),U=u(38952),J=u(10266),Q=u(51572),R=u(73546),q=u(97134),ae=u(83683);let D=(()=>{class n{constructor(t,i,o){this._location=t,this._userSettings=i,this._route=o,this.title="",this.routerLang=""}ngOnInit(){this._route.paramMap.subscribe(t=>{this.routerLang=t.get("lang")})}goBack(){this._location.back()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f.Ye),e.Y36(O.s),e.Y36(A.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-moderators-menu"]],inputs:{title:"title"},decls:17,vars:7,consts:[["color","secondary",1,"fadeIn","moderatorsBreadcrumb"],["aria-hidden","false","aria-label","Moderators"],[1,"menu-spacer"],[1,"container","mb20"],[1,"row"],[1,"page-title","col-12","col-md-9"],[1,"text-right","page-title-buttons","col-12","col-md-3"],["type","button","mat-button","","color","primary",1,"ml10","btn-toolbar2",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"mat-toolbar",0)(1,"mat-icon",1),e._uU(2,"admin_panel_settings"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e._UZ(6,"span",2),e.qZA(),e.TgZ(7,"div",3)(8,"div",4)(9,"h1",5),e._uU(10),e.qZA(),e.TgZ(11,"div",6)(12,"button",7),e.NdJ("click",function(){return i.goBack()}),e.TgZ(13,"mat-icon"),e._uU(14,"navigate_before"),e.qZA(),e._uU(15),e.ALo(16,"translate"),e.qZA()()()()),2&t&&(e.xp6(4),e.hij("\xa0",e.lcZ(5,3,"MODERATORS.LABEL_TOOLBAR_TITLE"),""),e.xp6(6),e.hij(" ",i.title," "),e.xp6(5),e.hij(" ",e.lcZ(16,5,"CREATE_PAGE.FRM_BTN_GOBACK")," "))},dependencies:[P.lW,b.Hw,ae.Ye,Y.X$],styles:[".page-title[_ngcontent-%COMP%], .page-title-buttons[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:20px}.btn-toolbar2[_ngcontent-%COMP%]{color:inherit}.moderatorsBreadcrumb[_ngcontent-%COMP%]{margin-top:54px;margin-bottom:40px}@media (min-width: 600px){.moderatorsBreadcrumb[_ngcontent-%COMP%]{margin-top:64px}}mat-toolbar[_ngcontent-%COMP%]{font-family:Roboto Mono,monospace}.mb20[_ngcontent-%COMP%]{margin-bottom:20px}"]}),n})();function oe(n,a){1&n&&e._UZ(0,"mat-spinner",5)}function se(n,a){1&n&&(e.TgZ(0,"div",9),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"MODERATORS.LABEL_NO_RESULTS")," "))}function re(n,a){if(1&n&&(e.TgZ(0,"mat-card",24),e._UZ(1,"img",25),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.s9C("src",i.baseURL+i.pages[t].img,e.LSH)}}function ge(n,a){1&n&&(e.TgZ(0,"div",26)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&n&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_TX_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_TX_PENDING")," "))}function ce(n,a){if(1&n&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_HEIGHT"),":"),e.xp6(2),e.hij(" ",i.pages[t].block.height," ")}}function pe(n,a){if(1&n&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"date"),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_TIMESTAMP"),":"),e.xp6(2),e.hij(" ",e.xi3(5,4,i.timestampToDate(i.pages[t].block.timestamp),"short")," ")}}function de(n,a){if(1&n&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_ARVERIFY_SCORE"),": "),e.xp6(2),e.hij(" ",i.arverifyProcessedAddressesMap[i.pages[t].owner].percentage," % ")}}function le(n,a){1&n&&(e.TgZ(0,"div",27)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"mat-icon"),e._uU(5,"verified_user"),e.qZA(),e._uU(6),e.ALo(7,"translate"),e.qZA()),2&n&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_OWNER_STATUS"),": "),e.xp6(4),e.hij(" ",e.lcZ(7,4,"PAGE.STATUS_ADDRESS_VERIFIED")," "))}function ue(n,a){1&n&&(e.TgZ(0,"div",26)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&n&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_OWNER_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_ADDRESS_NOTVERIFIED")," "))}function _e(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",10)(1,"mat-card")(2,"h2",11),e._uU(3),e.qZA(),e.YNc(4,re,2,1,"mat-card",12),e.TgZ(5,"div"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"div"),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"div"),e._uU(15),e.qZA(),e._UZ(16,"hr",13),e.YNc(17,ge,6,6,"div",14),e.TgZ(18,"div",15)(19,"app-arweave-address",16),e._uU(20),e.ALo(21,"translate"),e.qZA()(),e.TgZ(22,"div",15)(23,"app-arweave-address",17),e._uU(24),e.ALo(25,"translate"),e.qZA()(),e.YNc(26,ce,5,4,"div",18),e.YNc(27,pe,6,7,"div",18),e.YNc(28,de,5,4,"div",18),e.YNc(29,le,8,6,"div",19),e.YNc(30,ue,6,6,"div",14),e.TgZ(31,"div",20)(32,"a",21),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.confirmValidateArWikiPage(r.pages[s].slug,r.pages[s].id,r.pages[s].category,r.pages[s].value,r.pages[s].owner))}),e.TgZ(33,"mat-icon"),e._uU(34,"done"),e.qZA(),e._uU(35," Approve "),e.qZA(),e._uU(36," \xa0 "),e.TgZ(37,"a",22),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.confirmRejectArWikiPage(r.pages[s].slug,r.pages[s].id))}),e.TgZ(38,"mat-icon"),e._uU(39,"delete"),e.qZA(),e._uU(40," Reject "),e.qZA(),e._uU(41," \xa0 "),e.TgZ(42,"a",23)(43,"mat-icon"),e._uU(44,"visibility"),e.qZA(),e._uU(45," Preview "),e.qZA()()()()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(2),e.MGl("routerLink","../../preview/",i.pages[t].id,""),e.xp6(1),e.hij(" ",i.pages[t].title," "),e.xp6(1),e.Q6J("ngIf",i.pages[t].img),e.xp6(2),e.AsE(" ",e.lcZ(7,22,"PAGE.LABEL_SLUG"),": ",i.pages[t].slug," "),e.xp6(3),e.AsE(" ",e.lcZ(10,24,"PAGE.LABEL_CATEGORY"),": ",i.pages[t].category," "),e.xp6(3),e.AsE(" ",e.lcZ(13,26,"PAGE.LABEL_LANGUAGE"),": ",i.pages[t].language," "),e.xp6(3),e.hij(" Page value: ",i.pages[t].value," $WIKI "),e.xp6(2),e.Q6J("ngIf",!i.pages[t].block||!i.pages[t].block.height),e.xp6(2),e.Q6J("address",i.pages[t].id)("isAddress",!1),e.xp6(1),e.hij("",e.lcZ(21,28,"PAGE.LABEL_ID"),": "),e.xp6(3),e.Q6J("address",i.pages[t].owner),e.xp6(1),e.hij("",e.lcZ(25,30,"PAGE.LABEL_OWNER"),": "),e.xp6(2),e.Q6J("ngIf",i.pages[t].block&&i.pages[t].block.height),e.xp6(1),e.Q6J("ngIf",i.pages[t].block&&i.pages[t].block.timestamp),e.xp6(1),e.Q6J("ngIf",i.arverifyProcessedAddressesMap[i.pages[t].owner]&&i.arverifyProcessedAddressesMap[i.pages[t].owner].percentage),e.xp6(1),e.Q6J("ngIf",i.arverifyProcessedAddressesMap[i.pages[t].owner]&&i.arverifyProcessedAddressesMap[i.pages[t].owner].verified),e.xp6(1),e.Q6J("ngIf",!i.arverifyProcessedAddressesMap[i.pages[t].owner]||!i.arverifyProcessedAddressesMap[i.pages[t].owner].verified),e.xp6(12),e.MGl("routerLink","../../preview/",i.pages[t].id,"")}}function me(n,a){if(1&n&&(e.TgZ(0,"div",6),e.YNc(1,se,3,3,"div",7),e.YNc(2,_e,46,32,"div",8),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(t.loadingPendingPages||t.pages&&t.getKeys(t.pages).length)),e.xp6(1),e.Q6J("ngForOf",t.getKeys(t.pages))}}function fe(n,a){1&n&&(e.TgZ(0,"div",28)(1,"div",29),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",30),e._uU(4,"\u{1f680} Hold on! We are almost there!"),e.qZA()()())}function he(n,a){if(1&n&&(e.TgZ(0,"div",28)(1,"div",29)(2,"h1",30),e._uU(3,"\u{1f973} Page successfully approved!"),e.qZA(),e.TgZ(4,"p",30),e._uU(5),e.qZA(),e.TgZ(6,"a",31),e._uU(7),e.qZA()()()),2&n){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.insertPageTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.insertPageTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.insertPageTxMessage," ")}}function ve(n,a){if(1&n&&(e.TgZ(0,"div",28)(1,"div",29)(2,"h1",30),e._uU(3,"Oops! something went wrong"),e.qZA(),e.TgZ(4,"p",30),e._uU(5),e.qZA()()()),2&n){const t=e.oxw();e.xp6(5),e.Oqu(t.insertPageTxErrorMessage)}}function xe(n,a){1&n&&(e.TgZ(0,"div",28)(1,"div",29),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",30),e._uU(4,"\u{1f680} Hold on! We are almost there!"),e.qZA()()())}function Ae(n,a){if(1&n&&(e.TgZ(0,"div",28)(1,"div",29)(2,"h1",30),e._uU(3,"\u{1f973} Page rejected successfully!"),e.qZA(),e.TgZ(4,"p",30),e._uU(5),e.qZA(),e.TgZ(6,"a",31),e._uU(7),e.qZA()()()),2&n){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.rejectPageTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.rejectPageTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.rejectPageTxMessage," ")}}function Te(n,a){if(1&n&&(e.TgZ(0,"div",28)(1,"div",29)(2,"h1",30),e._uU(3,"Oops! something went wrong"),e.qZA(),e.TgZ(4,"p",30),e._uU(5),e.qZA()()()),2&n){const t=e.oxw();e.xp6(5),e.Oqu(t.rejectPageTxErrorMessage)}}let we=(()=>{class n{constructor(t,i,o,s,r,p,g){this._arweave=t,this._auth=i,this._snackBar=o,this._dialog=s,this._route=r,this._userSettings=p,this._arwikiTokenContract=g,this.loadingPendingPages=!1,this.pages={},this.pendingPagesSubscription=y.w0.EMPTY,this.arverifyProcessedAddressesMap={},this.loadingInsertPageIntoIndex=!1,this.insertPageTxMessage="",this.insertPageTxErrorMessage="",this.routeLang="",this.baseURL=this._arweave.baseURL,this.loadingRejectPage=!1,this.rejectPageTxMessage="",this.rejectPageTxErrorMessage=""}ngOnInit(){var t=this;return(0,h.Z)(function*(){const i=t._auth.getAdminList();t.routeLang=t._route.snapshot.paramMap.get("lang"),t._arwiki=new S.iN(t._arweave.arweave),t.arwikiQuery=new N.x(t._arweave.arweave),t.loadingPendingPages=!0;let s,r=0;try{s=yield t._arweave.arweave.network.getInfo(),r=s.height}catch(g){return void t.message(`${g}`,"error")}let p={};var g;t.pendingPagesSubscription=t._arwikiTokenContract.getCategories().pipe((0,m.w)(g=>t.arwikiQuery.getPendingPages(t.routeLang,Object.keys(g),100,r)),(0,m.w)(g=>{for(let d of g){const c=new U.default(d,t._arweave.arweave);p[c.id]={id:c.id,title:t.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Title"),slug:t.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Slug"),category:t.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Category"),language:t.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Lang"),img:t.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Img"),owner:c.owner.address,block:c.block,value:t.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Value")}}return(0,T.of)(p)}),(0,m.w)(g=>t._arwikiTokenContract.getAllPages(t.routeLang,-1).pipe((0,m.w)(d=>{let c={};const l=Object.keys(d).map(_=>d[_].content);for(let _ in g)l.indexOf(_)>=0||(c[_]=g[_]);return(0,T.of)(c)}))),(0,m.w)(g=>t.arwikiQuery.getRejectedPagesByIds(i,Object.keys(g),100,r).pipe((0,m.w)(d=>{let c=[],l={};for(let _ of d){const x=new U.default(_,t._arweave.arweave),I=t.arwikiQuery.searchKeyNameInTags(x.tags,"Arwiki-Page-Id");c.push(I)}for(let _ in g)c.indexOf(_)<0&&(l[_]=g[_]);return(0,T.of)(l)})))).subscribe({next:(g=(0,h.Z)(function*(d){t.pages=d,t.loadingPendingPages=!1,t.arverifyProcessedAddressesMap={};for(let c of Object.keys(d)){if(Object.prototype.hasOwnProperty.call(t.arverifyProcessedAddressesMap,d[c].owner))continue;const l=yield t.getArverifyVerification(d[c].owner);t.arverifyProcessedAddressesMap[d[c].owner]=l}}),function(c){return g.apply(this,arguments)}),error:g=>{t.message(g,"error"),t.loadingPendingPages=!1}})})()}message(t,i="",o){this._snackBar.open(t,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:o,panelClass:i})}ngOnDestroy(){this.pendingPagesSubscription&&this.pendingPagesSubscription.unsubscribe()}getArverifyVerification(t){return(0,h.Z)(function*(){const i=yield(0,F.Ni)(t);return{verified:i.verified,icon:i.icon,percentage:i.percentage}})()}underscoreToSpace(t){return t.replace(/[_]/gi," ")}confirmValidateArWikiPage(t,i,o,s,r){let g="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(j.f,{data:{title:"Are you sure?",content:"You are about to approve a new arwiki page. Remember to have enough balance to stake and some other in your vault! Do you want to proceed?",pageValue:s,second_content:"Please define the final page value:"},direction:g}).afterClosed().pipe((0,m.w)(c=>{const l=+c;if(Number.isInteger(l)&&l>0)return this.loadingInsertPageIntoIndex=!0,this._arwikiTokenContract.approvePage(i,r,t,o,this.routeLang,l,this._auth.getPrivateKey(),S.yh[0]);if(0===l)throw Error("Stake must be greater than 0 $WIKI tokens");return(0,T.of)(null)})).subscribe({next:c=>{c&&(this.insertPageTxMessage=`${c}`,this.message("Success!","success"))},error:c=>{this.insertPageTxErrorMessage=`${c}`,this.message(`${c}`,"error")}})}timestampToDate(t){return new Date(1e3*t)}getKeys(t){return Object.keys(t)}confirmRejectArWikiPage(t,i){let s="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(ie,{data:{id:i},direction:s}).afterClosed().pipe((0,m.w)(p=>{if(p){this.loadingRejectPage=!0;const g=this._auth.getPrivateKey();return this._arwiki.createRejectTXForArwikiPage(i,t,this.routeLang,p,g)}return(0,T.of)(null)})).subscribe({next:p=>{p&&(this.rejectPageTxMessage=`${p}`,this.message("Page rejected!","success"))},error:p=>{this.rejectPageTxErrorMessage=`${p}`,this.message(`${p}`,"error")}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(M.N),e.Y36(k.e),e.Y36(L.ux),e.Y36(w.uw),e.Y36(A.gz),e.Y36(O.s),e.Y36(C.d))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:11,vars:11,consts:[[3,"title"],["class","spinner-center",4,"ngIf"],[1,"container","page-container","fadeIn"],["class","row",4,"ngIf"],["class","row fadeIn",4,"ngIf"],[1,"spinner-center"],[1,"row"],["class","col-12 card-page fadeIn",4,"ngIf"],["class","col-12 col-md-6 card-page fadeIn",4,"ngFor","ngForOf"],[1,"col-12","card-page","fadeIn"],[1,"col-12","col-md-6","card-page","fadeIn"],[1,"link",3,"routerLink"],["class","card-image text-center",4,"ngIf"],[1,"mbt20"],["class","red mini-text",4,"ngIf"],[1,"mini-text"],[3,"address","isAddress"],[3,"address"],["class","mini-text",4,"ngIf"],["class","green mini-text",4,"ngIf"],[1,"text-right","page-card-footer"],["mat-flat-button","","matTooltip","Approve and sponsor page",1,"approve-btn",3,"click"],["mat-flat-button","","matTooltip","Reject page","color","warn",3,"click"],["mat-flat-button","","color","primary","matTooltip","Preview",3,"routerLink"],[1,"card-image","text-center"],[3,"src"],[1,"red","mini-text"],[1,"green","mini-text"],[1,"row","fadeIn"],[1,"col","text-center"],[1,"text-center"],["mat-button","","target","_blank",1,"text-center",3,"href"]],template:function(t,i){1&t&&(e._UZ(0,"app-moderators-menu",0),e.ALo(1,"translate"),e.YNc(2,oe,1,0,"mat-spinner",1),e.TgZ(3,"div",2),e.YNc(4,me,3,2,"div",3),e.YNc(5,fe,5,0,"div",4),e.YNc(6,he,8,3,"div",4),e.YNc(7,ve,6,1,"div",4),e.YNc(8,xe,5,0,"div",4),e.YNc(9,Ae,8,3,"div",4),e.YNc(10,Te,6,1,"div",4),e.qZA()),2&t&&(e.s9C("title",e.lcZ(1,9,"MODERATORS.PENDING_PAGE.TITLE_PENDING")),e.xp6(2),e.Q6J("ngIf",i.loadingPendingPages),e.xp6(2),e.Q6J("ngIf",!i.loadingInsertPageIntoIndex&&!i.loadingRejectPage),e.xp6(1),e.Q6J("ngIf",i.loadingInsertPageIntoIndex&&!i.insertPageTxMessage&&!i.insertPageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",i.insertPageTxMessage),e.xp6(1),e.Q6J("ngIf",i.insertPageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",i.loadingRejectPage&&!i.rejectPageTxMessage&&!i.rejectPageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",i.rejectPageTxMessage),e.xp6(1),e.Q6J("ngIf",i.rejectPageTxErrorMessage))},dependencies:[f.sg,f.O5,A.rH,A.yS,P.zs,J.gM,b.Hw,Q.Ou,R.a8,q.N,D,f.uU,Y.X$],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}.w70[_ngcontent-%COMP%]{width:70%}.ml10[_ngcontent-%COMP%]{margin-left:10px}.w100[_ngcontent-%COMP%]{width:100%}.w50[_ngcontent-%COMP%]{width:50%}.card-page[_ngcontent-%COMP%]{margin-bottom:40px}.approve-btn[_ngcontent-%COMP%]{background-color:#63c642;color:#fff}.link[_ngcontent-%COMP%]{cursor:pointer}.mini-text[_ngcontent-%COMP%]{font-size:12px}.mbt20[_ngcontent-%COMP%]{margin-bottom:20px;margin-top:20px}.card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.page-card-footer[_ngcontent-%COMP%]{margin-top:20px}"]}),n})();var Z=u(24006),H=u(32076);let Ze=(()=>{class n{constructor(t,i,o,s){this._snackBar=t,this._arwikiTokenContract=i,this._auth=o,this._arweave=s,this.createAdminFrm=new Z.nJ({newAdminAddress:new Z.p4("")}),this.formLoading=!1,this.saveAdminSubscription=y.w0.EMPTY}get newAdminAddress(){return this.createAdminFrm.get("newAdminAddress")}ngOnInit(){}ngOnDestroy(){this.saveAdminSubscription&&this.saveAdminSubscription.unsubscribe()}createNewAdmin(){const t=this.newAdminAddress.value;this.formLoading=!0,this.newAdminAddress.disable(),this.saveAdminSubscription=(0,H.D)(this._arwikiTokenContract.registerAdmin(t,this._auth.getPrivateKey(),S.yh[0])).subscribe({next:i=>{this.newadminTX=i,this.message("New admin proposal created!","success"),this.formLoading=!1,this.newAdminAddress.enable(),this.newAdminAddress.setValue("")},error:i=>{this.message(i,"error"),this.formLoading=!1,this.newAdminAddress.enable()}})}message(t,i="",o){this._snackBar.open(t,"X",{duration:5e3,horizontalPosition:"center",verticalPosition:o,panelClass:i})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(L.ux),e.Y36(C.d),e.Y36(k.e),e.Y36(M.N))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:14,vars:2,consts:[["title","Add admin"],[1,"container","page-container","fadeIn"],[1,"row"],[1,"col-12","fadeIn"],[3,"formGroup","ngSubmit"],["matInput","","required","","autocomplete","off","formControlName","newAdminAddress"],[1,"text-center"],["type","submit","mat-raised-button","","color","primary",1,"go-button",3,"disabled"]],template:function(t,i){1&t&&(e._UZ(0,"app-moderators-menu",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4),e.NdJ("ngSubmit",function(){return i.createNewAdmin()}),e.TgZ(5,"mat-form-field")(6,"mat-label"),e._uU(7,"Arweave address of the new admin (moderator)"),e.qZA(),e._UZ(8,"input",5),e.qZA(),e.TgZ(9,"div",6)(10,"button",7)(11,"mat-icon"),e._uU(12,"save"),e.qZA(),e._uU(13," Add Admin! "),e.qZA()()()()()()),2&t&&(e.xp6(4),e.Q6J("formGroup",i.createAdminFrm),e.xp6(6),e.Q6J("disabled",!i.createAdminFrm.valid))},dependencies:[E.KE,E.hX,X.Nt,P.lW,b.Hw,Z._Y,Z.Fj,Z.JJ,Z.JL,Z.Q7,Z.sg,Z.u,D],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}.page-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),n})();function Pe(n,a){if(1&n&&(e.TgZ(0,"div",4),e._UZ(1,"app-arweave-address",5),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Q6J("address",t)}}function ye(n,a){1&n&&(e.TgZ(0,"div",4),e._uU(1," -- "),e.qZA())}let be=(()=>{class n{constructor(t){this._auth=t,this.adminList=this._auth.getAdminList()}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(k.e))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-view-admin-list"]],decls:8,vars:2,consts:[["title","Admin list"],[1,"container","page-container","fadeIn"],[1,"row"],["class","col-12 col-md-6 fadeIn",4,"ngFor","ngForOf"],[1,"col-12","col-md-6","fadeIn"],[3,"address"]],template:function(t,i){1&t&&(e._UZ(0,"app-moderators-menu",0),e.TgZ(1,"div",1)(2,"div",2),e.YNc(3,Pe,2,1,"div",3),e.qZA(),e.TgZ(4,"h1"),e._uU(5," Votes "),e.qZA(),e.TgZ(6,"div",2),e.YNc(7,ye,2,0,"div",3),e.qZA()()),2&t&&(e.xp6(3),e.Q6J("ngForOf",i.adminList),e.xp6(4),e.Q6J("ngForOf",i.adminList))},dependencies:[f.sg,q.N,D],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}"]}),n})();var B=u(57762);function ke(n,a){1&n&&(e.TgZ(0,"p"),e._uU(1,"Loading ..."),e.qZA())}function Ce(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"p")(2,"button",6),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.viewUpdates(s.slug))}),e._uU(3),e.qZA()()()}if(2&n){const t=a.$implicit;e.xp6(3),e.hij("",t.title," ")}}function Le(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Ce,4,1,"div",5),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.pages)}}let Ue=(()=>{class n{constructor(t,i,o,s,r,p){this.data=t,this._arweave=i,this._snackBar=o,this._arwikiTokenContract=s,this._router=r,this._dialogRef=p,this.loadingPendingPages=!1,this.pages=[],this.pendingPagesSubscription=y.w0.EMPTY,this.langCode=""}ngOnInit(){var t=this;return(0,h.Z)(function*(){t.langCode=t.data.langCode,t.arwikiQuery=new N.x(t._arweave.arweave),yield t.getUpdates()})()}message(t,i="",o){this._snackBar.open(t,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:o,panelClass:i})}ngOnDestroy(){this.pendingPagesSubscription&&this.pendingPagesSubscription.unsubscribe()}getUpdates(){var t=this;return(0,h.Z)(function*(){t.loadingPendingPages=!0;let o,s=0;try{o=yield t._arweave.arweave.network.getInfo(),s=o.height}catch(r){return void t.message(`${r}`,"error")}var r;t.pendingPagesSubscription=t.arwikiQuery.getPendingPagesUpdatesByLang(t.langCode,100,s).pipe((0,m.w)(r=>{let p={};for(let g of r){const d=new U.default(g,t._arweave.arweave);p[d.id]={id:d.id,title:t.arwikiQuery.searchKeyNameInTags(d.tags,"Arwiki-Page-Title"),slug:t.arwikiQuery.searchKeyNameInTags(d.tags,"Arwiki-Page-Slug"),category:t.arwikiQuery.searchKeyNameInTags(d.tags,"Arwiki-Page-Category"),language:t.arwikiQuery.searchKeyNameInTags(d.tags,"Arwiki-Page-Lang"),img:t.arwikiQuery.searchKeyNameInTags(d.tags,"Arwiki-Page-Img"),owner:d.owner.address,block:d.block,value:t.arwikiQuery.searchKeyNameInTags(d.tags,"Arwiki-Page-Value")}}return(0,T.of)(p)}),(0,m.w)(r=>t._arwikiTokenContract.getApprovedPages(t.langCode,-1,!0).pipe((0,m.w)(p=>{let g={},d=[];for(const c of Object.keys(p)){const l=p[c].updates.map(_=>_.tx);d=d.concat(l)}for(let c in r)d.indexOf(c)>=0||(g[c]=r[c]);return(0,T.of)(g)})))).subscribe({next:(r=(0,h.Z)(function*(p){t.pages=Object.values(p),t.loadingPendingPages=!1}),function(g){return r.apply(this,arguments)}),error:r=>{t.message(r,"error"),t.loadingPendingPages=!1}})})()}getKeys(t){return Object.keys(t)}viewUpdates(t){this.close(),this._router.navigate([this.langCode,"moderators","page-updates",t])}close(){this._dialogRef.close()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(w.WI),e.Y36(M.N),e.Y36(L.ux),e.Y36(C.d),e.Y36(A.F0),e.Y36(w.so))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dialog-search-page-update"]],decls:11,vars:2,consts:[["mat-dialog-title",""],[1,"title-icon"],[4,"ngIf"],["align","end"],["mat-button","","mat-dialog-close","","cdkFocusInitial",""],[4,"ngFor","ngForOf"],["mat-button","",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"h2",0)(1,"mat-icon",1),e._uU(2,"search"),e.qZA(),e.TgZ(3,"span"),e._uU(4,"Pending updates"),e.qZA()(),e.TgZ(5,"mat-dialog-content"),e.YNc(6,ke,2,0,"p",2),e.YNc(7,Le,2,1,"ng-container",2),e.qZA(),e.TgZ(8,"mat-dialog-actions",3)(9,"button",4),e._uU(10,"Cancel"),e.qZA()()),2&t&&(e.xp6(6),e.Q6J("ngIf",i.loadingPendingPages),e.xp6(1),e.Q6J("ngIf",!i.loadingPendingPages))},dependencies:[f.sg,f.O5,P.lW,b.Hw,w.ZT,w.uh,w.xY,w.H8],styles:[".title-icon[_ngcontent-%COMP%]{font-size:40px;line-height:40px;width:40px;height:40px;vertical-align:middle}.mat-dialog-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:12px;vertical-align:middle;font-size:26px;font-family:Roboto Mono,monospace;line-height:38px}"]}),n})();function Ie(n,a){1&n&&e._UZ(0,"mat-spinner",5)}function Me(n,a){1&n&&(e.TgZ(0,"div",10),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"MODERATORS.LABEL_NO_RESULTS")," "))}function Se(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",11)(1,"button",12),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.searchUpdates())}),e.TgZ(2,"mat-icon"),e._uU(3,"search"),e.qZA(),e._uU(4," Search for updates "),e.qZA()()}}function Oe(n,a){if(1&n&&(e.TgZ(0,"button",31)(1,"mat-icon"),e._uU(2,"casino"),e.qZA()()),2&n){const t=e.oxw().$implicit;e.MGl("routerLink","../../",t.slug,"")}}function Ne(n,a){if(1&n&&(e.TgZ(0,"mat-card",32),e._UZ(1,"img",33),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.s9C("src",i.baseURL+t.img,e.LSH)}}function qe(n,a){if(1&n&&(e.TgZ(0,"div",18)(1,"app-arweave-address",19),e._uU(2,"Sponsor: "),e.qZA()()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("address",t.sponsor)("isAddress",!1)}}function Ee(n,a){1&n&&(e.TgZ(0,"div",34)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&n&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_TX_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_TX_PENDING")," "))}function Ye(n,a){if(1&n&&(e.TgZ(0,"div",18)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_HEIGHT"),": "),e.xp6(2),e.hij(" ",t.block.height," ")}}function Qe(n,a){if(1&n&&(e.TgZ(0,"div",18)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"date"),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_TIMESTAMP"),": "),e.xp6(2),e.hij(" ",e.xi3(5,4,i.timestampToDate(t.block.timestamp),"short")," ")}}function Re(n,a){1&n&&(e.TgZ(0,"strong",37),e._uU(1," - Reward unlocked! "),e.qZA())}function De(n,a){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit,i=e.oxw(2);e.xp6(1),e.AsE(" - Reward unlocked in ",t.pageRewardAt-i.currentBlockHeight," blocks! (",i.formatBlocks(t.pageRewardAt-i.currentBlockHeight),") ")}}function je(n,a){if(1&n&&(e.TgZ(0,"div",18)(1,"strong"),e._uU(2,"Page reward at: "),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.qZA(),e.YNc(5,Re,2,0,"strong",35),e.YNc(6,De,2,2,"span",36),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(4),e.hij("",t.pageRewardAt," block"),e.xp6(1),e.Q6J("ngIf",i.currentBlockHeight>=t.pageRewardAt),e.xp6(1),e.Q6J("ngIf",i.currentBlockHeight<t.pageRewardAt)}}function Je(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"a",38),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,s=e.oxw(2);return e.KtG(s.confirmStopStake(o.slug))}),e.TgZ(1,"mat-icon"),e._uU(2,"delete"),e.qZA(),e._uU(3," Stop staking "),e.qZA()}}function He(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",13)(1,"mat-card"),e.YNc(2,Oe,3,1,"button",14),e.TgZ(3,"h2",15),e._uU(4),e.qZA(),e.YNc(5,Ne,2,1,"mat-card",16),e.TgZ(6,"div"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"div"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"div"),e._uU(16),e.qZA(),e._UZ(17,"hr",17),e.TgZ(18,"div",18)(19,"app-arweave-address",19),e._uU(20),e.ALo(21,"translate"),e.qZA()(),e.TgZ(22,"div",18)(23,"app-arweave-address",20),e._uU(24),e.ALo(25,"translate"),e.qZA()(),e.YNc(26,qe,3,2,"div",21),e.YNc(27,Ee,6,6,"div",22),e.YNc(28,Ye,5,4,"div",21),e.YNc(29,Qe,6,7,"div",21),e.YNc(30,je,7,3,"div",21),e.TgZ(31,"div",23),e.YNc(32,Je,4,0,"a",24),e.TgZ(33,"a",25),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.confirmSponsorArWikiPage(s.slug,s.category,s.value))}),e.TgZ(34,"mat-icon"),e._uU(35,"casino"),e.qZA(),e._uU(36," Sponsor page "),e.qZA(),e.TgZ(37,"a",26),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.confirmSetMainArWikiPage(s.slug,s.id,s.category))}),e.TgZ(38,"mat-icon",27),e._uU(39,"star"),e.qZA(),e._uU(40," Set as Main Page "),e.qZA(),e.TgZ(41,"a",28)(42,"mat-icon"),e._uU(43,"archive"),e.qZA(),e._uU(44," Page updates "),e.qZA(),e.TgZ(45,"a",29)(46,"mat-icon"),e._uU(47,"sell"),e.qZA(),e._uU(48," Tags "),e.qZA(),e.TgZ(49,"a",30)(50,"mat-icon"),e._uU(51,"visibility"),e.qZA(),e._uU(52," View "),e.qZA()()()()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(2),e.Q6J("ngIf",t.sponsor===i.myAddress),e.xp6(1),e.MGl("routerLink","../../",t.slug,""),e.xp6(1),e.hij(" ",t.title," "),e.xp6(1),e.Q6J("ngIf",t.img),e.xp6(2),e.AsE(" ",e.lcZ(8,25,"PAGE.LABEL_SLUG"),": ",t.slug," "),e.xp6(3),e.AsE(" ",e.lcZ(11,27,"PAGE.LABEL_CATEGORY"),": ",t.category," "),e.xp6(3),e.AsE(" ",e.lcZ(14,29,"PAGE.LABEL_LANGUAGE"),": ",t.language," "),e.xp6(3),e.hij(" Page value: ",t.value," $WIKI "),e.xp6(3),e.Q6J("address",t.id)("isAddress",!1),e.xp6(1),e.hij("",e.lcZ(21,31,"PAGE.LABEL_ID"),": "),e.xp6(3),e.Q6J("address",t.owner),e.xp6(1),e.hij("",e.lcZ(25,33,"PAGE.LABEL_OWNER"),": "),e.xp6(2),e.Q6J("ngIf",t.sponsor),e.xp6(1),e.Q6J("ngIf",!t.block||!t.block.height),e.xp6(1),e.Q6J("ngIf",t.block&&t.block.height),e.xp6(1),e.Q6J("ngIf",t.block&&t.block.timestamp),e.xp6(1),e.Q6J("ngIf",t.pageRewardAt),e.xp6(2),e.Q6J("ngIf",t.sponsor===i.myAddress),e.xp6(9),e.MGl("routerLink","../page-updates/",t.slug,""),e.xp6(4),e.MGl("routerLink","../tag-manager/",t.slug,""),e.xp6(4),e.MGl("routerLink","../../",t.slug,"")}}function Be(n,a){if(1&n&&(e.TgZ(0,"div",6),e.YNc(1,Me,3,3,"div",7),e.YNc(2,Se,5,0,"div",8),e.YNc(3,He,53,35,"div",9),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(t.loadingApprovedPages||t.pages&&t.pages.length)),e.xp6(1),e.Q6J("ngIf",t.pages&&t.pages.length),e.xp6(1),e.Q6J("ngForOf",t.pages)}}function Ge(n,a){1&n&&(e.TgZ(0,"div",39)(1,"div",40),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",41),e._uU(4,"\u{1f680} Hold on! Your transaction is processing ..."),e.qZA()()())}function $e(n,a){if(1&n&&(e.TgZ(0,"div",39)(1,"div",40)(2,"h1",41),e._uU(3,"\u{1f4a5} Page successfully unlisted!"),e.qZA(),e.TgZ(4,"p",41),e._uU(5),e.qZA(),e.TgZ(6,"a",42),e._uU(7),e.qZA()()()),2&n){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.deleteTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.deleteTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.deleteTxMessage," ")}}function Ke(n,a){1&n&&(e.TgZ(0,"div",39)(1,"div",40),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",41),e._uU(4,"\u{1f680} Hold on! Your transaction is processing ..."),e.qZA()()())}function Fe(n,a){if(1&n&&(e.TgZ(0,"div",39)(1,"div",40)(2,"h1",41),e._uU(3,"\u{1f973} Page successfully set as Main Page!"),e.qZA(),e.TgZ(4,"p",41),e._uU(5),e.qZA(),e.TgZ(6,"a",42),e._uU(7),e.qZA()()()),2&n){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.setMainTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.setMainTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.setMainTxMessage," ")}}function Xe(n,a){1&n&&(e.TgZ(0,"div",39)(1,"div",40),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",41),e._uU(4,"\u{1f680} Hold on! Your transaction is processing ..."),e.qZA()()())}function We(n,a){if(1&n&&(e.TgZ(0,"div",39)(1,"div",40)(2,"h1",41),e._uU(3,"\u{1f4a5} Sponsorship successfully stopped!"),e.qZA(),e.TgZ(4,"p",41),e._uU(5),e.qZA(),e.TgZ(6,"a",42),e._uU(7),e.qZA()()()),2&n){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.stopStakeTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.stopStakeTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.stopStakeTxMessage," ")}}function ze(n,a){1&n&&(e.TgZ(0,"div",39)(1,"div",40),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",41),e._uU(4,"\u{1f680} Hold on! Your transaction is processing ..."),e.qZA()()())}function Ve(n,a){if(1&n&&(e.TgZ(0,"div",39)(1,"div",40)(2,"h1",41),e._uU(3,"\u{1f973} Page successfully updated!"),e.qZA(),e.TgZ(4,"p",41),e._uU(5),e.qZA(),e.TgZ(6,"a",42),e._uU(7),e.qZA()()()),2&n){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.updateSponsorPageTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.updateSponsorPageTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.updateSponsorPageTxMessage," ")}}function et(n,a){if(1&n&&(e.TgZ(0,"div",39)(1,"div",40)(2,"h1",41),e._uU(3,"Oops! something went wrong"),e.qZA(),e.TgZ(4,"p",41),e._uU(5),e.qZA()()()),2&n){const t=e.oxw();e.xp6(5),e.Oqu(t.updateSponsorPageTxErrorMessage)}}let tt=(()=>{class n{constructor(t,i,o,s,r,p,g){this._arweave=t,this._auth=i,this._snackBar=o,this._dialog=s,this._route=r,this._userSettings=p,this._arwikiToken=g,this.loadingApprovedPages=!1,this.pages=[],this.approvedPagesSubscription=y.w0.EMPTY,this.routeLang="",this.loadingDeletePage=!1,this.deleteTxMessage="",this.stopStakeTxMessage="",this.loadingStopStake=!1,this.loadingSetMainPage=!1,this.setMainTxMessage="",this.myAddress="",this.currentBlockHeight=0,this.heightSubscription=y.w0.EMPTY,this.baseURL=this._arweave.baseURL,this.updateSponsorPageTxMessage="",this.updateSponsorPageTxErrorMessage="",this.loadingUpdateSponsorPageIntoIndex=!1,this.loadingPendingUpdates=!1}ngOnInit(){var t=this;return(0,h.Z)(function*(){t.myAddress=t._auth.getMainAddressSnapshot(),t._auth.getAdminList(),t.routeLang=t._route.snapshot.paramMap.get("lang"),t._arwiki=new S.iN(t._arweave.arweave),t.arwikiQuery=new N.x(t._arweave.arweave),t.loadingApprovedPages=!0;let s,r=0;try{s=yield t._arweave.arweave.network.getInfo(),r=s.height}catch(c){return void t.message(`${c}`,"error")}t._auth.getAdminList();let g=[],d={};var c;t.approvedPagesSubscription=t._arwikiToken.getCategories().pipe((0,m.w)(c=>t._arwikiToken.getApprovedPages(t.routeLang,-1,!0)),(0,m.w)(c=>(d=c,g=Object.keys(c).map(l=>c[l].content),t.arwikiQuery.getTXsData(g))),(0,m.w)(c=>{let l=[];for(let _ of c){const x=new U.default(_,t._arweave.arweave),I=t.arwikiQuery.searchKeyNameInTags(x.tags,"Arwiki-Page-Slug");l.push({id:x.id,title:t.arwikiQuery.searchKeyNameInTags(x.tags,"Arwiki-Page-Title"),slug:I,category:t.arwikiQuery.searchKeyNameInTags(x.tags,"Arwiki-Page-Category"),language:t.arwikiQuery.searchKeyNameInTags(x.tags,"Arwiki-Page-Lang"),value:d[I].value,img:t.arwikiQuery.searchKeyNameInTags(x.tags,"Arwiki-Page-Img"),owner:x.owner.address,block:x.block,start:d[I].start,sponsor:d[I].sponsor,pageRewardAt:d[I].pageRewardAt})}return(0,T.of)(l)})).subscribe({next:(c=(0,h.Z)(function*(l){t.pages=l,t.loadingApprovedPages=!1}),function(_){return c.apply(this,arguments)}),error:c=>{t.message(c,"error"),t.loadingApprovedPages=!1}}),t.heightSubscription=(0,H.D)(t.getCurrentHeight()).subscribe({next:c=>{t.currentBlockHeight=c},error:c=>{t.message(c,"error")}})})()}message(t,i="",o){this._snackBar.open(t,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:o,panelClass:i})}ngOnDestroy(){this.approvedPagesSubscription&&this.approvedPagesSubscription.unsubscribe()}underscoreToSpace(t){return t.replace(/[_]/gi," ")}timestampToDate(t){return new Date(1e3*t)}confirmDeleteArWikiPage(t,i,o){var s=this;let p="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(B.p,{data:{title:"Are you sure?",content:"You are about to unlist (hide) an arwiki page from the index. Do you want to proceed?"},direction:p}).afterClosed().subscribe(function(){var d=(0,h.Z)(function*(c){if(c){s.loadingDeletePage=!0;try{const l=yield s._arwiki.createDeleteTXForArwikiPage(i,t,o,s.routeLang,s._auth.getPrivateKey());s.deleteTxMessage=l,s.message("Success!","success")}catch(l){s.message(`${l}`,"error")}}});return function(c){return d.apply(this,arguments)}}())}confirmSetMainArWikiPage(t,i,o){var s=this;let p="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(B.p,{data:{title:"Are you sure?",content:`You are about to set ${t} as the main page. Do you want to proceed?`},direction:p}).afterClosed().subscribe(function(){var d=(0,h.Z)(function*(c){if(c){s.loadingSetMainPage=!0;try{const l=yield s._arwiki.createMainPageTXForArwikiPage(i,t,o,s.routeLang,s._auth.getPrivateKey());s.setMainTxMessage=l,s.message("Success!","success")}catch(l){s.message(`${l}`,"error")}}});return function(c){return d.apply(this,arguments)}}())}getCurrentHeight(){var t=this;return(0,h.Z)(function*(){let i={},o=0;try{i=yield t._arweave.arweave.network.getInfo(),o=i.height?i.height:0}catch(s){throw Error(`${s}`)}return o})()}confirmStopStake(t){let o="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(B.p,{data:{title:"Are you sure?",content:"You are about to stop your stake and sponsorship for this page. This will unlist the page. Do you want to proceed?"},direction:o}).afterClosed().pipe((0,m.w)(r=>r?(this.loadingStopStake=!0,this._arwikiToken.stopStaking(t,this.routeLang,this._auth.getPrivateKey(),S.yh[0])):(0,T.of)(null))).subscribe({next:r=>{r&&(this.stopStakeTxMessage=`${r}`,this.message("Success!","success"))},error:r=>{this.message(`${r}`,"error")}})}formatBlocks(t){return`${this._arweave.formatBlocks(t)}`}confirmSponsorArWikiPage(t,i,o){let r="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(j.f,{data:{title:"Are you sure?",content:"You are about to be the new sponsor for this arwiki page. Do you want to proceed?",pageValue:o+1,second_content:"Please define the amount of $WIKI tokens to stake:"},direction:r}).afterClosed().pipe((0,m.w)(g=>{const d=+g;if(Number.isInteger(d)&&d>0)return this.loadingUpdateSponsorPageIntoIndex=!0,this._arwikiToken.updatePageSponsor(t,i,this.routeLang,d,this._auth.getPrivateKey(),S.yh[0]);if(0===d)throw Error("Stake must be greater than 0 $WIKI tokens");return(0,T.of)(null)})).subscribe({next:g=>{g&&(this.updateSponsorPageTxMessage=`${g}`,this.message("Success!","success"))},error:g=>{this.updateSponsorPageTxErrorMessage=`${g}`,this.message(`${g}`,"error")}})}searchUpdates(){const t=this._userSettings.getDefaultLang();this._dialog.open(Ue,{data:{langCode:t.code},direction:"LTR"===t.writing_system?"ltr":"rtl",disableClose:!0}).afterClosed().subscribe(function(){var s=(0,h.Z)(function*(r){});return function(r){return s.apply(this,arguments)}}())}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(M.N),e.Y36(k.e),e.Y36(L.ux),e.Y36(w.uw),e.Y36(A.gz),e.Y36(O.s),e.Y36(C.d))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:13,vars:11,consts:[["title","Approved list"],["class","spinner-center",4,"ngIf"],[1,"container","page-container","fadeIn"],["class","row",4,"ngIf"],["class","row fadeIn",4,"ngIf"],[1,"spinner-center"],[1,"row"],["class","col-12 card-page fadeIn",4,"ngIf"],["class","col-12 text-right sec-toolbar",4,"ngIf"],["class","col-12 col-md-6 card-page fadeIn",4,"ngFor","ngForOf"],[1,"col-12","card-page","fadeIn"],[1,"col-12","text-right","sec-toolbar"],["mat-button","","color","primary","matTooltip","Search for updates",1,"btn-toolbar2",3,"click"],[1,"col-12","col-md-6","card-page","fadeIn"],["mat-icon-button","","class","card-header-icon green","matTooltip","You are the sponsor!","aria-label","You are the sponsor!",3,"routerLink",4,"ngIf"],[1,"link","ellipsis","card-header-title",3,"routerLink"],["class","card-image text-center",4,"ngIf"],[1,"mbt20"],[1,"mini-text"],[3,"address","isAddress"],[3,"address"],["class","mini-text",4,"ngIf"],["class","red mini-text",4,"ngIf"],[1,"text-right","mt20","card-footer"],["mat-flat-button","","color","warn","matTooltip","Stop staking",3,"click",4,"ngIf"],["mat-flat-button","","color","primary","matTooltip","Sponsor page",3,"click"],["mat-flat-button","","color","primary","matTooltip","Set as Main Page",3,"click"],[1,"yellow"],["mat-flat-button","","color","primary","matTooltip","Page updates",3,"routerLink"],["mat-flat-button","","color","primary","matTooltip","Add tags",3,"routerLink"],["mat-flat-button","","color","primary","matTooltip","View",3,"routerLink"],["mat-icon-button","","matTooltip","You are the sponsor!","aria-label","You are the sponsor!",1,"card-header-icon","green",3,"routerLink"],[1,"card-image","text-center"],[3,"src"],[1,"red","mini-text"],["class","green",4,"ngIf"],[4,"ngIf"],[1,"green"],["mat-flat-button","","color","warn","matTooltip","Stop staking",3,"click"],[1,"row","fadeIn"],[1,"col","text-center"],[1,"text-center"],["mat-button","","target","_blank",1,"text-center",3,"href"]],template:function(t,i){1&t&&(e._UZ(0,"app-moderators-menu",0),e.YNc(1,Ie,1,0,"mat-spinner",1),e.TgZ(2,"div",2),e.YNc(3,Be,4,3,"div",3),e.YNc(4,Ge,5,0,"div",4),e.YNc(5,$e,8,3,"div",4),e.YNc(6,Ke,5,0,"div",4),e.YNc(7,Fe,8,3,"div",4),e.YNc(8,Xe,5,0,"div",4),e.YNc(9,We,8,3,"div",4),e.YNc(10,ze,5,0,"div",4),e.YNc(11,Ve,8,3,"div",4),e.YNc(12,et,6,1,"div",4),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",i.loadingApprovedPages),e.xp6(2),e.Q6J("ngIf",!(i.loadingDeletePage||i.loadingSetMainPage||i.loadingStopStake||i.loadingUpdateSponsorPageIntoIndex)),e.xp6(1),e.Q6J("ngIf",i.loadingDeletePage&&!i.deleteTxMessage),e.xp6(1),e.Q6J("ngIf",i.deleteTxMessage),e.xp6(1),e.Q6J("ngIf",i.loadingSetMainPage&&!i.setMainTxMessage),e.xp6(1),e.Q6J("ngIf",i.setMainTxMessage),e.xp6(1),e.Q6J("ngIf",i.loadingStopStake&&!i.stopStakeTxMessage),e.xp6(1),e.Q6J("ngIf",i.stopStakeTxMessage),e.xp6(1),e.Q6J("ngIf",i.loadingUpdateSponsorPageIntoIndex&&!i.updateSponsorPageTxMessage&&!i.updateSponsorPageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",i.updateSponsorPageTxMessage),e.xp6(1),e.Q6J("ngIf",i.updateSponsorPageTxErrorMessage))},dependencies:[f.sg,f.O5,A.rH,A.yS,P.lW,P.zs,J.gM,b.Hw,Q.Ou,R.a8,q.N,D,f.uU,Y.X$],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}.w70[_ngcontent-%COMP%]{width:70%}.ml10[_ngcontent-%COMP%]{margin-left:10px}.w100[_ngcontent-%COMP%]{width:100%}.w50[_ngcontent-%COMP%]{width:50%}.card-page[_ngcontent-%COMP%]{margin-bottom:40px}.mt20[_ngcontent-%COMP%]{margin-top:20px}.link[_ngcontent-%COMP%]{cursor:pointer}.mbt20[_ngcontent-%COMP%]{margin-bottom:20px;margin-top:20px}.card-footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:10px}.card-header-icon[_ngcontent-%COMP%]{float:right}.card-header-title[_ngcontent-%COMP%]{margin-top:0}.card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.approve-btn[_ngcontent-%COMP%]{background-color:#63c642;color:#fff}.sec-toolbar[_ngcontent-%COMP%]{margin-bottom:20px}.btn-toolbar2[_ngcontent-%COMP%]{color:inherit}"]}),n})();function nt(n,a){1&n&&e._UZ(0,"mat-spinner",4)}function it(n,a){1&n&&(e.TgZ(0,"div",8),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"MODERATORS.LABEL_NO_RESULTS")," "))}function at(n,a){if(1&n&&(e.TgZ(0,"div",12)(1,"app-arweave-address",13),e._uU(2,"Sponsor: "),e.qZA()()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("address",t.sponsor)("isAddress",!1)}}function ot(n,a){1&n&&(e.TgZ(0,"div",20)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&n&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_TX_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_TX_PENDING")," "))}function st(n,a){if(1&n&&(e.TgZ(0,"div",12)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_HEIGHT"),": "),e.xp6(2),e.hij(" ",t.block.height," ")}}function rt(n,a){if(1&n&&(e.TgZ(0,"div",12)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"date"),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_TIMESTAMP"),": "),e.xp6(2),e.hij(" ",e.xi3(5,4,i.timestampToDate(t.block.timestamp),"short")," ")}}function gt(n,a){1&n&&(e.TgZ(0,"strong",23),e._uU(1," - Reward unlocked! "),e.qZA())}function ct(n,a){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit,i=e.oxw(2);e.xp6(1),e.hij(" - Reward unlocked in ",t.pageRewardAt-i.currentBlockHeight," blocks! ")}}function pt(n,a){if(1&n&&(e.TgZ(0,"div",12)(1,"strong"),e._uU(2,"Page reward at: "),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.qZA(),e.YNc(5,gt,2,0,"strong",21),e.YNc(6,ct,2,1,"span",22),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(4),e.hij("",t.pageRewardAt," block"),e.xp6(1),e.Q6J("ngIf",i.currentBlockHeight>=t.pageRewardAt),e.xp6(1),e.Q6J("ngIf",i.currentBlockHeight<t.pageRewardAt)}}function dt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",9)(1,"mat-card")(2,"h2",10),e._uU(3),e.qZA(),e.TgZ(4,"div"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"div"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"div"),e._uU(14),e.qZA(),e._UZ(15,"hr",11),e.TgZ(16,"div",12)(17,"app-arweave-address",13),e._uU(18),e.ALo(19,"translate"),e.qZA()(),e.TgZ(20,"div",12)(21,"app-arweave-address",14),e._uU(22),e.ALo(23,"translate"),e.qZA()(),e.YNc(24,at,3,2,"div",15),e.YNc(25,ot,6,6,"div",16),e.YNc(26,st,5,4,"div",15),e.YNc(27,rt,6,7,"div",15),e.YNc(28,pt,7,3,"div",15),e.TgZ(29,"div",17)(30,"a",18),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.confirmReactivateArWikiPage(s.slug,s.category,s.value))}),e.TgZ(31,"mat-icon"),e._uU(32,"done"),e.qZA(),e._uU(33," Reactivate and sponsor page "),e.qZA(),e._uU(34," \xa0 "),e.TgZ(35,"a",19)(36,"mat-icon"),e._uU(37,"visibility"),e.qZA(),e._uU(38," Preview "),e.qZA()()()()}if(2&n){const t=a.$implicit;e.xp6(2),e.MGl("routerLink","../../preview/",t.id,""),e.xp6(1),e.hij(" ",t.title," "),e.xp6(2),e.AsE(" ",e.lcZ(6,20,"PAGE.LABEL_SLUG"),": ",t.slug," "),e.xp6(3),e.AsE(" ",e.lcZ(9,22,"PAGE.LABEL_CATEGORY"),": ",t.category," "),e.xp6(3),e.AsE(" ",e.lcZ(12,24,"PAGE.LABEL_LANGUAGE"),": ",t.language," "),e.xp6(3),e.hij(" Page value: ",t.value," $WIKI "),e.xp6(3),e.Q6J("address",t.id)("isAddress",!1),e.xp6(1),e.hij("",e.lcZ(19,26,"PAGE.LABEL_ID"),": "),e.xp6(3),e.Q6J("address",t.owner),e.xp6(1),e.hij("",e.lcZ(23,28,"PAGE.LABEL_OWNER"),": "),e.xp6(2),e.Q6J("ngIf",t.sponsor),e.xp6(1),e.Q6J("ngIf",!t.block||!t.block.height),e.xp6(1),e.Q6J("ngIf",t.block&&t.block.height),e.xp6(1),e.Q6J("ngIf",t.block&&t.block.timestamp),e.xp6(1),e.Q6J("ngIf",t.pageRewardAt),e.xp6(7),e.MGl("routerLink","../../preview/",t.id,"")}}function lt(n,a){if(1&n&&(e.TgZ(0,"div",5),e.YNc(1,it,3,3,"div",6),e.YNc(2,dt,39,30,"div",7),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(t.loadingPages||t.pages&&t.pages.length)),e.xp6(1),e.Q6J("ngForOf",t.pages)}}function ut(n,a){1&n&&(e.TgZ(0,"div",5)(1,"div",24),e._UZ(2,"mat-spinner",4),e.TgZ(3,"h1",25),e._uU(4,"\u{1f680} Hold on! Your transaction is processing ..."),e.qZA()()())}function _t(n,a){if(1&n&&(e.TgZ(0,"div",5)(1,"div",24)(2,"h1",25),e._uU(3,"\u{1f973} Page successfully updated!"),e.qZA(),e.TgZ(4,"p",25),e._uU(5),e.qZA(),e.TgZ(6,"a",26),e._uU(7),e.qZA()()()),2&n){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.updatePageTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.updatePageTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.updatePageTxMessage," ")}}function mt(n,a){if(1&n&&(e.TgZ(0,"div",5)(1,"div",24)(2,"h1",25),e._uU(3,"Oops! something went wrong"),e.qZA(),e.TgZ(4,"p",25),e._uU(5),e.qZA()()()),2&n){const t=e.oxw();e.xp6(5),e.Oqu(t.updatePageTxErrorMessage)}}let ft=(()=>{class n{constructor(t,i,o,s,r,p,g){this._arweave=t,this._auth=i,this._snackBar=o,this._dialog=s,this._route=r,this._userSettings=p,this._arwikiToken=g,this.loadingPages=!1,this.pages=[],this.pagesSubscription=y.w0.EMPTY,this.routeLang="",this.myAddress="",this.currentBlockHeight=0,this.heightSubscription=y.w0.EMPTY,this.loadingReactivatePageIntoIndex=!1,this.updatePageTxMessage="",this.updatePageTxErrorMessage=""}ngOnInit(){var t=this;return(0,h.Z)(function*(){t.myAddress=t._auth.getMainAddressSnapshot(),t._auth.getAdminList(),t.routeLang=t._route.snapshot.paramMap.get("lang"),t._arwiki=new S.iN(t._arweave.arweave),t.arwikiQuery=new N.x(t._arweave.arweave),t.loadingPages=!0;let s,r=0;try{s=yield t._arweave.arweave.network.getInfo(),r=s.height}catch(p){return void t.message(`${p}`,"error")}var p;t.pagesSubscription=t.getDeletedPages(100,r).subscribe({next:(p=(0,h.Z)(function*(g){t.pages=g,t.loadingPages=!1}),function(d){return p.apply(this,arguments)}),error:p=>{t.message(p,"error"),t.loadingPages=!1}}),t.heightSubscription=(0,H.D)(t.getCurrentHeight()).subscribe({next:p=>{t.currentBlockHeight=p},error:p=>{t.message(p,"error")}})})()}message(t,i="",o){this._snackBar.open(t,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:o,panelClass:i})}ngOnDestroy(){this.pagesSubscription&&this.pagesSubscription.unsubscribe()}underscoreToSpace(t){return t.replace(/[_]/gi," ")}timestampToDate(t){return new Date(1e3*t)}getCurrentHeight(){var t=this;return(0,h.Z)(function*(){let i={},o=0;try{i=yield t._arweave.arweave.network.getInfo(),o=i.height?i.height:0}catch(s){throw Error(`${s}`)}return o})()}getDeletedPages(t,i){const o=this._auth.getAdminList();let s=[],r={},p=[];return this._arwikiToken.getCategories().pipe((0,m.w)(g=>this._arwikiToken.getAllPages(this.routeLang,-1)),(0,m.w)(g=>(r=g,s=Object.keys(r).map(d=>r[d].content),p=Object.keys(r).filter(d=>!r[d].active).map(d=>r[d].content),this.arwikiQuery.getAllDeletedPages(o,this.routeLang,t,i))),(0,m.w)(g=>{const d={};for(const l of g){const _=new U.default(l,this._arweave.arweave),x=this.arwikiQuery.searchKeyNameInTags(_.tags,"Arwiki-Page-Id");d[x]=!0}let c=s.filter(l=>d[l]);return c=c.concat(p),this.arwikiQuery.getTXsData(c)}),(0,m.w)(g=>{let d=[];for(let c of g){const l=new U.default(c,this._arweave.arweave),_=this.arwikiQuery.searchKeyNameInTags(l.tags,"Arwiki-Page-Slug");d.push({id:l.id,title:this.arwikiQuery.searchKeyNameInTags(l.tags,"Arwiki-Page-Title"),slug:_,category:this.arwikiQuery.searchKeyNameInTags(l.tags,"Arwiki-Page-Category"),language:this.arwikiQuery.searchKeyNameInTags(l.tags,"Arwiki-Page-Lang"),value:r[_].value,owner:l.owner.address,block:l.block,start:r[_].start,sponsor:r[_].sponsor,pageRewardAt:r[_].pageRewardAt})}return(0,T.of)(d)}))}confirmReactivateArWikiPage(t,i,o){let r="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(j.f,{data:{title:"Are you sure?",content:"You are about to reactivate an old arwiki page. Do you want to proceed?",pageValue:o+1,second_content:"Please define the amount of $WIKI tokens to stake:"},direction:r}).afterClosed().pipe((0,m.w)(g=>{const d=+g;if(Number.isInteger(d)&&d>0)return this.loadingReactivatePageIntoIndex=!0,this._arwikiToken.updatePageSponsor(t,i,this.routeLang,d,this._auth.getPrivateKey(),S.yh[0]);if(0===d)throw Error("Stake must be greater than 0 $WIKI tokens");return(0,T.of)(null)})).subscribe({next:g=>{g&&(this.updatePageTxMessage=`${g}`,this.message("Success!","success"))},error:g=>{this.updatePageTxErrorMessage=`${g}`,this.message(`${g}`,"error")}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(M.N),e.Y36(k.e),e.Y36(L.ux),e.Y36(w.uw),e.Y36(A.gz),e.Y36(O.s),e.Y36(C.d))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-deleted-list"]],decls:7,vars:5,consts:[["title","Deleted pages"],["class","spinner-center",4,"ngIf"],[1,"container","page-container"],["class","row fadeIn",4,"ngIf"],[1,"spinner-center"],[1,"row","fadeIn"],["class","col-12 card-page fadeIn",4,"ngIf"],["class","col-12 col-md-6 card-page fadeIn",4,"ngFor","ngForOf"],[1,"col-12","card-page","fadeIn"],[1,"col-12","col-md-6","card-page","fadeIn"],[1,"link","ellipsis","card-header-title",3,"routerLink"],[1,"mbt20"],[1,"mini-text"],[3,"address","isAddress"],[3,"address"],["class","mini-text",4,"ngIf"],["class","red mini-text",4,"ngIf"],[1,"text-right","mt20","card-footer"],["mat-flat-button","","matTooltip","Reactivate and sponsor page",1,"approve-btn",3,"click"],["mat-flat-button","","color","primary","matTooltip","View",3,"routerLink"],[1,"red","mini-text"],["class","green",4,"ngIf"],[4,"ngIf"],[1,"green"],[1,"col","text-center"],[1,"text-center"],["mat-button","","target","_blank",1,"text-center",3,"href"]],template:function(t,i){1&t&&(e._UZ(0,"app-moderators-menu",0),e.YNc(1,nt,1,0,"mat-spinner",1),e.TgZ(2,"div",2),e.YNc(3,lt,3,2,"div",3),e.YNc(4,ut,5,0,"div",3),e.YNc(5,_t,8,3,"div",3),e.YNc(6,mt,6,1,"div",3),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",i.loadingPages),e.xp6(2),e.Q6J("ngIf",!i.loadingReactivatePageIntoIndex),e.xp6(1),e.Q6J("ngIf",i.loadingReactivatePageIntoIndex&&!i.updatePageTxMessage&&!i.updatePageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",i.updatePageTxMessage),e.xp6(1),e.Q6J("ngIf",i.updatePageTxErrorMessage))},dependencies:[f.sg,f.O5,A.rH,A.yS,P.zs,J.gM,b.Hw,Q.Ou,R.a8,q.N,D,f.uU,Y.X$],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}.w70[_ngcontent-%COMP%]{width:70%}.ml10[_ngcontent-%COMP%]{margin-left:10px}.w100[_ngcontent-%COMP%]{width:100%}.w50[_ngcontent-%COMP%]{width:50%}.card-page[_ngcontent-%COMP%]{margin-bottom:40px}.mt20[_ngcontent-%COMP%]{margin-top:20px}.link[_ngcontent-%COMP%]{cursor:pointer}.mbt20[_ngcontent-%COMP%]{margin-bottom:20px;margin-top:20px}.card-footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:5px;margin-bottom:10px}.card-header-icon[_ngcontent-%COMP%]{float:right}.card-header-title[_ngcontent-%COMP%]{margin-top:0}.approve-btn[_ngcontent-%COMP%]{background-color:#63c642;color:#fff}"]}),n})();var W=u(29521),G=u(77331);function ht(n,a){1&n&&e._UZ(0,"mat-spinner",4)}function vt(n,a){if(1&n&&(e.TgZ(0,"mat-chip",11),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t," ")}}function xt(n,a){1&n&&(e.TgZ(0,"mat-icon",25),e._uU(1,"cancel"),e.qZA())}function At(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mat-chip",23),e.NdJ("removed",function(){const s=e.CHM(t).$implicit,r=e.oxw(3);return e.KtG(r.remove(s))}),e._uU(1),e.YNc(2,xt,2,0,"mat-icon",24),e.qZA()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("selectable",i.selectable)("removable",i.removable),e.xp6(1),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",i.removable)}}function Tt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",12)(1,"h3",13),e._uU(2,"Create tags:"),e.qZA(),e.TgZ(3,"form",14),e.NdJ("ngSubmit",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSubmit())}),e.TgZ(4,"mat-form-field",15)(5,"mat-label"),e._uU(6,"Tags"),e.qZA(),e.TgZ(7,"mat-chip-list",16,17),e.YNc(9,At,3,4,"mat-chip",18),e.TgZ(10,"input",19),e.NdJ("matChipInputTokenEnd",function(o){e.CHM(t);const s=e.oxw(2);return e.KtG(s.add(o))}),e.qZA()(),e.TgZ(11,"mat-hint",20),e._uU(12,"Separate tags by comma"),e.qZA()(),e.TgZ(13,"div",21)(14,"button",22)(15,"mat-icon"),e._uU(16,"save"),e.qZA(),e._uU(17," Save "),e.qZA()()()()}if(2&n){const t=e.MAs(8),i=e.oxw(2);e.xp6(3),e.Q6J("formGroup",i.frmTags),e.xp6(6),e.Q6J("ngForOf",i.tags),e.xp6(1),e.Q6J("matChipInputFor",t)("matChipInputSeparatorKeyCodes",i.separatorKeysCodes)("matChipInputAddOnBlur",i.addOnBlur),e.xp6(4),e.Q6J("disabled",!i.tags.length||i.loadingSavingTags)}}function wt(n,a){1&n&&e._UZ(0,"mat-spinner",4)}function Zt(n,a){if(1&n&&(e.TgZ(0,"div",12),e._uU(1),e.ALo(2,"json"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" The following TX were created: ",e.lcZ(2,1,t.savingTagsTX)," ")}}function Pt(n,a){if(1&n&&(e.TgZ(0,"div",5)(1,"div",6)(2,"strong"),e._uU(3,"Title:"),e.qZA(),e._uU(4),e._UZ(5,"br"),e.TgZ(6,"strong"),e._uU(7,"Slug:"),e.qZA(),e.TgZ(8,"a",7)(9,"mat-icon"),e._uU(10,"visibility"),e.qZA(),e._uU(11),e.qZA(),e._UZ(12,"br"),e.TgZ(13,"strong"),e._uU(14,"Category"),e.qZA(),e._uU(15),e._UZ(16,"br"),e.TgZ(17,"strong"),e._uU(18,"Language:"),e.qZA(),e._uU(19),e.qZA(),e.TgZ(20,"div",6)(21,"strong"),e._uU(22,"Owner:"),e.qZA(),e._uU(23),e.qZA(),e.TgZ(24,"div",6)(25,"strong"),e._uU(26,"Current tags:"),e.qZA(),e.TgZ(27,"mat-chip-list",8),e.YNc(28,vt,2,1,"mat-chip",9),e.qZA()(),e.YNc(29,Tt,18,6,"div",10),e.YNc(30,wt,1,0,"mat-spinner",1),e.YNc(31,Zt,3,3,"div",10),e.qZA()),2&n){const t=e.oxw();e.xp6(4),e.hij(" ",t.page.title," "),e.xp6(4),e.MGl("routerLink","../../../",t.page.slug,""),e.xp6(3),e.hij(" ",t.page.slug," "),e.xp6(4),e.hij(": ",t.page.category," "),e.xp6(4),e.hij(" ",t.page.language," "),e.xp6(4),e.hij(" ",t.page.owner," "),e.xp6(5),e.Q6J("ngForOf",t.currentTags),e.xp6(1),e.Q6J("ngIf",!t.loadingSavingTags&&!t.savingTagsTX.length),e.xp6(1),e.Q6J("ngIf",t.loadingSavingTags),e.xp6(1),e.Q6J("ngIf",t.savingTagsTX.length)}}let yt=(()=>{class n{constructor(t,i,o,s,r,p,g){this.route=t,this._arweave=i,this._snackBar=o,this._location=s,this._dialog=r,this._auth=p,this._arwikiToken=g,this.pageSubscription=y.w0.EMPTY,this.tagsSubscription=y.w0.EMPTY,this.loadingPage=!1,this.baseURL=this._arweave.baseURL,this.visible=!0,this.selectable=!0,this.removable=!0,this.addOnBlur=!0,this.separatorKeysCodes=[W.K5,W.OC],this.tags=[],this.currentTags=[],this.frmTags=new Z.nJ({newTags:new Z.p4("")}),this.loadingSavingTags=!1,this.savingTagsTX=[],this.routeLang=""}get newTags(){return this.frmTags.get("tags")}ngOnInit(){var t=this;return(0,h.Z)(function*(){t.routeLang=t.route.snapshot.paramMap.get("lang"),t._arwiki=new S.iN(t._arweave.arweave);const i=t.route.snapshot.paramMap.get("slug");t.arwikiQuery=new N.x(t._arweave.arweave),t.loadPageTXData(i),yield t.loadTags(i)})()}ngOnDestroy(){this.pageSubscription&&this.pageSubscription.unsubscribe(),this.tagsSubscription&&this.tagsSubscription.unsubscribe()}loadPageTXData(t){this.loadingPage=!0,this.pageSubscription=this._arwikiToken.getApprovedPages(this.routeLang).pipe((0,m.w)(i=>this.arwikiQuery.getTXsData([i&&i[t]?i[t].content:""]))).subscribe({next:i=>{if(i&&i.length){const s=new U.default(i[0],this._arweave.arweave);this.page={id:s.id,title:this.searchKeyNameInTags(s.tags,"Arwiki-Page-Title"),slug:this.searchKeyNameInTags(s.tags,"Arwiki-Page-Slug"),category:this.searchKeyNameInTags(s.tags,"Arwiki-Page-Category"),language:this.searchKeyNameInTags(s.tags,"Arwiki-Page-Lang"),img:this.searchKeyNameInTags(s.tags,"Arwiki-Page-Img"),owner:s.owner.address,block:s.block}}this.loadingPage=!1},error:i=>{this.message(i,"error"),this.loadingPage=!1}})}loadTags(t){var i=this;return(0,h.Z)(function*(){let s,r=0;try{s=yield i._arweave.arweave.network.getInfo(),r=s.height}catch(p){return void i.message(`${p}`,"error")}i.tagsSubscription=i.arwikiQuery.getVerifiedTagsFromSlug(i._auth.getAdminList(),t,i.routeLang,100,r).subscribe({next:p=>{i.currentTags=[];for(let g of p){const d=new U.default(g,i._arweave.arweave);i.currentTags.push(i.searchKeyNameInTags(d.tags,"Arwiki-Page-Tag"))}},error:p=>{i.message(p,"error")}})})()}message(t,i="",o){this._snackBar.open(t,"X",{duration:5e3,horizontalPosition:"center",verticalPosition:o,panelClass:i})}goBack(){this._location.back()}searchKeyNameInTags(t,i){for(const s of t)if(s.name.toUpperCase()===i.toUpperCase())return s.value;return""}add(t){const i=t.input,o=t.value;(o||"").trim()&&this.tags.push({name:o.trim()}),i&&(i.value="")}remove(t){const i=this.tags.indexOf(t);i>=0&&this.tags.splice(i,1)}onSubmit(){this.confirmSaveTags(this.tags,this.page.category,this.page.id,this.page.language,this.page.slug)}confirmSaveTags(t,i,o,s,r){var p=this;const g=t.map(l=>l.name),d=`You are about to create the next tags: ${g.join()}. Do you want to proceed?`;this._dialog.open(B.p,{data:{title:"Are you sure?",content:d}}).afterClosed().subscribe(function(){var l=(0,h.Z)(function*(_){if(_){p.loadingSavingTags=!0;try{p.savingTagsTX=[];for(let x of g){const I=yield p._arwiki.createTagTXForArwikiPage(o,x,i,p.routeLang,r,p._auth.getPrivateKey());p.savingTagsTX.push(I)}p.message("Success!","success")}catch(x){p.message(`${x}`,"error")}p.loadingSavingTags=!1}});return function(_){return l.apply(this,arguments)}}())}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(A.gz),e.Y36(M.N),e.Y36(L.ux),e.Y36(f.Ye),e.Y36(w.uw),e.Y36(k.e),e.Y36(C.d))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:4,vars:2,consts:[["title","Tag manager"],["class","spinner-center",4,"ngIf"],[1,"container","tagm-page-container"],["class","row",4,"ngIf"],[1,"spinner-center"],[1,"row"],[1,"col-12"],["mat-flat-button","",3,"routerLink"],["aria-label","Current tags"],["color","primary","selected","",4,"ngFor","ngForOf"],["class","col-12 text-center",4,"ngIf"],["color","primary","selected",""],[1,"col-12","text-center"],[1,"text-left"],[3,"formGroup","ngSubmit"],["id","tags-input-container",1,"w70"],["aria-label","Add tags",1,"tags-input"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["placeholder","Add tag...","formControlName","newTags",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["align","start"],[1,"text-center"],["mat-flat-button","","color","primary",3,"disabled"],[3,"selectable","removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""]],template:function(t,i){1&t&&(e._UZ(0,"app-moderators-menu",0),e.YNc(1,ht,1,0,"mat-spinner",1),e.TgZ(2,"div",2),e.YNc(3,Pt,32,10,"div",3),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",i.loadingPage),e.xp6(2),e.Q6J("ngIf",i.page&&!i.loadingPage))},dependencies:[f.sg,f.O5,A.yS,E.KE,E.bx,E.hX,P.lW,P.zs,b.Hw,Z._Y,Z.Fj,Z.JJ,Z.JL,Z.sg,Z.u,Q.Ou,G.qn,G.HS,G.oH,G.qH,D,f.Ts],styles:[".tagm-page-container[_ngcontent-%COMP%]{min-height:600px}.page-title[_ngcontent-%COMP%], .page-title-buttons[_ngcontent-%COMP%]{margin-top:50px;margin-bottom:50px}.page-img[_ngcontent-%COMP%]{max-width:100%}.w70[_ngcontent-%COMP%]{width:70%}.ml10[_ngcontent-%COMP%]{margin-left:10px}.w100[_ngcontent-%COMP%]{width:100%}"]}),n})();var bt=u(12190);function kt(n,a){1&n&&e._UZ(0,"mat-spinner",5)}function Ct(n,a){1&n&&(e.TgZ(0,"div",9),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"MODERATORS.LABEL_NO_RESULTS")," "))}function Lt(n,a){if(1&n&&(e.TgZ(0,"mat-card",25),e._UZ(1,"img",26),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.s9C("src",i.baseURL+i.pages[t].img,e.LSH)}}function Ut(n,a){1&n&&(e.TgZ(0,"div",27)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&n&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_TX_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_TX_PENDING")," "))}function It(n,a){if(1&n&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_HEIGHT"),":"),e.xp6(2),e.hij(" ",i.pages[t].block.height," ")}}function Mt(n,a){if(1&n&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"date"),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_TIMESTAMP"),":"),e.xp6(2),e.hij(" ",e.xi3(5,4,i.timestampToDate(i.pages[t].block.timestamp),"short")," ")}}function St(n,a){if(1&n&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_ARVERIFY_SCORE"),": "),e.xp6(2),e.hij(" ",i.arverifyProcessedAddressesMap[i.pages[t].owner].percentage," % ")}}function Ot(n,a){1&n&&(e.TgZ(0,"div",28)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"mat-icon"),e._uU(5,"verified_user"),e.qZA(),e._uU(6),e.ALo(7,"translate"),e.qZA()),2&n&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_OWNER_STATUS"),": "),e.xp6(4),e.hij(" ",e.lcZ(7,4,"PAGE.STATUS_ADDRESS_VERIFIED")," "))}function Nt(n,a){1&n&&(e.TgZ(0,"div",27)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&n&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_OWNER_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_ADDRESS_NOTVERIFIED")," "))}function qt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",10)(1,"mat-card")(2,"h2",11),e._uU(3),e.qZA(),e.YNc(4,Lt,2,1,"mat-card",12),e.TgZ(5,"div"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"div"),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"div"),e._uU(15),e.qZA(),e._UZ(16,"hr",13),e.YNc(17,Ut,6,6,"div",14),e.TgZ(18,"div",15)(19,"app-arweave-address",16),e._uU(20),e.ALo(21,"translate"),e.qZA()(),e.TgZ(22,"div",15)(23,"app-arweave-address",17),e._uU(24),e.ALo(25,"translate"),e.qZA()(),e.YNc(26,It,5,4,"div",18),e.YNc(27,Mt,6,7,"div",18),e.YNc(28,St,5,4,"div",18),e.YNc(29,Ot,8,6,"div",19),e.YNc(30,Nt,6,6,"div",14),e.TgZ(31,"div",20)(32,"a",21),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.confirmValidateArWikiPage(r.pages[s].slug,r.pages[s].id,r.pages[s].category,r.pages[s].value,r.pages[s].owner))}),e.TgZ(33,"mat-icon"),e._uU(34,"done"),e.qZA(),e._uU(35," Approve "),e.qZA(),e.TgZ(36,"a",22)(37,"mat-icon"),e._uU(38,"visibility"),e.qZA(),e._uU(39," Preview "),e.qZA(),e.TgZ(40,"a",23)(41,"mat-icon"),e._uU(42,"visibility"),e.qZA(),e._uU(43," Original "),e.qZA(),e.TgZ(44,"a",24),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.compare(r.pages[s].id,r.pages[s].slug))}),e.TgZ(45,"mat-icon"),e._uU(46,"difference"),e.qZA(),e._uU(47," Differences "),e.qZA()()()()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(2),e.MGl("routerLink","../../../preview/",i.pages[t].id,""),e.xp6(1),e.hij(" ",i.pages[t].title," "),e.xp6(1),e.Q6J("ngIf",i.pages[t].img),e.xp6(2),e.AsE(" ",e.lcZ(7,23,"PAGE.LABEL_SLUG"),": ",i.pages[t].slug," "),e.xp6(3),e.AsE(" ",e.lcZ(10,25,"PAGE.LABEL_CATEGORY"),": ",i.pages[t].category," "),e.xp6(3),e.AsE(" ",e.lcZ(13,27,"PAGE.LABEL_LANGUAGE"),": ",i.pages[t].language," "),e.xp6(3),e.hij(" Page value: ",i.pages[t].value," $WIKI "),e.xp6(2),e.Q6J("ngIf",!i.pages[t].block||!i.pages[t].block.height),e.xp6(2),e.Q6J("address",i.pages[t].id)("isAddress",!1),e.xp6(1),e.hij("",e.lcZ(21,29,"PAGE.LABEL_ID"),": "),e.xp6(3),e.Q6J("address",i.pages[t].owner),e.xp6(1),e.hij("",e.lcZ(25,31,"PAGE.LABEL_OWNER"),": "),e.xp6(2),e.Q6J("ngIf",i.pages[t].block&&i.pages[t].block.height),e.xp6(1),e.Q6J("ngIf",i.pages[t].block&&i.pages[t].block.timestamp),e.xp6(1),e.Q6J("ngIf",i.arverifyProcessedAddressesMap[i.pages[t].owner]&&i.arverifyProcessedAddressesMap[i.pages[t].owner].percentage),e.xp6(1),e.Q6J("ngIf",i.arverifyProcessedAddressesMap[i.pages[t].owner]&&i.arverifyProcessedAddressesMap[i.pages[t].owner].verified),e.xp6(1),e.Q6J("ngIf",!i.arverifyProcessedAddressesMap[i.pages[t].owner]||!i.arverifyProcessedAddressesMap[i.pages[t].owner].verified),e.xp6(6),e.MGl("routerLink","../../../preview/",i.pages[t].id,""),e.xp6(4),e.MGl("routerLink","../../../",i.pages[t].slug,"")}}function Et(n,a){if(1&n&&(e.TgZ(0,"div",6),e.YNc(1,Ct,3,3,"div",7),e.YNc(2,qt,48,33,"div",8),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(t.loadingPendingPages||t.pages&&t.getKeys(t.pages).length)),e.xp6(1),e.Q6J("ngForOf",t.getKeys(t.pages))}}function Yt(n,a){1&n&&(e.TgZ(0,"div",29)(1,"div",30),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",31),e._uU(4,"\u{1f680} Hold on! We are almost there!"),e.qZA()()())}function Qt(n,a){if(1&n&&(e.TgZ(0,"div",29)(1,"div",30)(2,"h1",31),e._uU(3,"\u{1f973} Page successfully approved!"),e.qZA(),e.TgZ(4,"p",31),e._uU(5),e.qZA(),e.TgZ(6,"a",32),e._uU(7),e.qZA()()()),2&n){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.insertPageTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.insertPageTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.insertPageTxMessage," ")}}function Rt(n,a){if(1&n&&(e.TgZ(0,"div",29)(1,"div",30)(2,"h1",31),e._uU(3,"Oops! something went wrong"),e.qZA(),e.TgZ(4,"p",31),e._uU(5),e.qZA()()()),2&n){const t=e.oxw();e.xp6(5),e.Oqu(t.insertPageTxErrorMessage)}}let Dt=(()=>{class n{constructor(t,i,o,s,r,p,g){this._arweave=t,this._auth=i,this._snackBar=o,this._dialog=s,this._route=r,this._userSettings=p,this._arwikiTokenContract=g,this.loadingPendingPages=!1,this.pages={},this.pendingPagesSubscription=y.w0.EMPTY,this.arverifyProcessedAddressesMap={},this.loadingInsertPageIntoIndex=!1,this.insertPageTxMessage="",this.insertPageTxErrorMessage="",this.routeLang="",this.baseURL=this._arweave.baseURL,this.pageSlug=""}ngOnInit(){var t=this;return(0,h.Z)(function*(){t._auth.getAdminList(),t.routeLang=t._route.snapshot.paramMap.get("lang"),t.pageSlug=t._route.snapshot.paramMap.get("slug"),t.arwikiQuery=new N.x(t._arweave.arweave),t.loadingPendingPages=!0;let s,r=0;try{s=yield t._arweave.arweave.network.getInfo(),r=s.height}catch(p){return void t.message(`${p}`,"error")}var p;t.pendingPagesSubscription=t.arwikiQuery.getPendingPagesUpdates(t.routeLang,t.pageSlug,100,r).pipe((0,m.w)(p=>{let g={};for(let d of p){const c=new U.default(d,t._arweave.arweave);g[c.id]={id:c.id,title:t.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Title"),slug:t.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Slug"),category:t.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Category"),language:t.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Lang"),img:t.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Img"),owner:c.owner.address,block:c.block,value:t.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Value")}}return(0,T.of)(g)}),(0,m.w)(p=>t._arwikiTokenContract.getApprovedPages(t.routeLang,-1,!0).pipe((0,m.w)(g=>{let d={},c=[];for(const l of Object.keys(g)){const _=g[l].updates.map(x=>x.tx);c=c.concat(_)}for(let l in p)c.indexOf(l)>=0||(d[l]=p[l]);return(0,T.of)(d)})))).subscribe({next:(p=(0,h.Z)(function*(g){t.pages=g,t.loadingPendingPages=!1,t.arverifyProcessedAddressesMap={};for(let d of Object.keys(g)){if(Object.prototype.hasOwnProperty.call(t.arverifyProcessedAddressesMap,g[d].owner))continue;const c=yield t.getArverifyVerification(g[d].owner);t.arverifyProcessedAddressesMap[g[d].owner]=c}}),function(d){return p.apply(this,arguments)}),error:p=>{t.message(p,"error"),t.loadingPendingPages=!1}})})()}message(t,i="",o){this._snackBar.open(t,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:o,panelClass:i})}ngOnDestroy(){this.pendingPagesSubscription&&this.pendingPagesSubscription.unsubscribe()}getArverifyVerification(t){return(0,h.Z)(function*(){const i=yield(0,F.Ni)(t);return{verified:i.verified,icon:i.icon,percentage:i.percentage}})()}underscoreToSpace(t){return t.replace(/[_]/gi," ")}confirmValidateArWikiPage(t,i,o,s,r){let g="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(j.f,{data:{title:"Are you sure?",content:"You are about to approve a new arwiki page update. Do you want to proceed?",second_content:"Please define the page update value in $WIKI tokens:",pageValue:s},direction:g}).afterClosed().pipe((0,m.w)(c=>{const l=+c;if(Number.isInteger(l)&&l>0)return this.loadingInsertPageIntoIndex=!0,this._arwikiTokenContract.approvePageUpdate(i,r,t,o,this.routeLang,l,this._auth.getPrivateKey(),S.yh[0]);if(0===l)throw Error("Stake must be greater than 0 $WIKI tokens");return(0,T.of)(null)})).subscribe({next:c=>{c&&(this.insertPageTxMessage=`${c}`,this.message("Success!","success"))},error:c=>{this.insertPageTxErrorMessage=`${c}`,this.message(`${c}`,"error")}})}timestampToDate(t){return new Date(1e3*t)}getKeys(t){return Object.keys(t)}compare(t,i){let s="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(bt.e,{data:{newPage:t,slug:i,lang:this.routeLang},direction:s}).afterClosed().subscribe({next:()=>{},error:p=>{this.message(`${p}`,"error")}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(M.N),e.Y36(k.e),e.Y36(L.ux),e.Y36(w.uw),e.Y36(A.gz),e.Y36(O.s),e.Y36(C.d))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-page-updates"]],decls:7,vars:5,consts:[["title","Pending updates"],["class","spinner-center",4,"ngIf"],[1,"container","page-container","fadeIn"],["class","row",4,"ngIf"],["class","row fadeIn",4,"ngIf"],[1,"spinner-center"],[1,"row"],["class","col-12 card-page fadeIn",4,"ngIf"],["class","col-12 col-md-6 card-page fadeIn",4,"ngFor","ngForOf"],[1,"col-12","card-page","fadeIn"],[1,"col-12","col-md-6","card-page","fadeIn"],[1,"link",3,"routerLink"],["class","card-image text-center",4,"ngIf"],[1,"mbt20"],["class","red mini-text",4,"ngIf"],[1,"mini-text"],[3,"address","isAddress"],[3,"address"],["class","mini-text",4,"ngIf"],["class","green mini-text",4,"ngIf"],[1,"text-right"],["mat-flat-button","","matTooltip","Approve page update",1,"approve-btn","card-btn",3,"click"],["mat-flat-button","","color","primary","matTooltip","Preview",1,"card-btn",3,"routerLink"],["mat-flat-button","","color","primary","matTooltip","Original",1,"card-btn",3,"routerLink"],["mat-flat-button","","color","primary","matTooltip","Compare versions",1,"card-btn",3,"click"],[1,"card-image","text-center"],[3,"src"],[1,"red","mini-text"],[1,"green","mini-text"],[1,"row","fadeIn"],[1,"col","text-center"],[1,"text-center"],["mat-button","","target","_blank",1,"text-center",3,"href"]],template:function(t,i){1&t&&(e._UZ(0,"app-moderators-menu",0),e.YNc(1,kt,1,0,"mat-spinner",1),e.TgZ(2,"div",2),e.YNc(3,Et,3,2,"div",3),e.YNc(4,Yt,5,0,"div",4),e.YNc(5,Qt,8,3,"div",4),e.YNc(6,Rt,6,1,"div",4),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",i.loadingPendingPages),e.xp6(2),e.Q6J("ngIf",!i.loadingInsertPageIntoIndex),e.xp6(1),e.Q6J("ngIf",i.loadingInsertPageIntoIndex&&!i.insertPageTxMessage&&!i.insertPageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",i.insertPageTxMessage),e.xp6(1),e.Q6J("ngIf",i.insertPageTxErrorMessage))},dependencies:[f.sg,f.O5,A.rH,A.yS,P.zs,J.gM,b.Hw,Q.Ou,R.a8,q.N,D,f.uU,Y.X$],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}.w70[_ngcontent-%COMP%]{width:70%}.ml10[_ngcontent-%COMP%]{margin-left:10px}.w100[_ngcontent-%COMP%]{width:100%}.w50[_ngcontent-%COMP%]{width:50%}.card-page[_ngcontent-%COMP%]{margin-bottom:40px}.approve-btn[_ngcontent-%COMP%]{background-color:#63c642;color:#fff}.link[_ngcontent-%COMP%]{cursor:pointer}.mini-text[_ngcontent-%COMP%]{font-size:12px}.mbt20[_ngcontent-%COMP%]{margin-bottom:20px;margin-top:20px}.card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.card-btn[_ngcontent-%COMP%]{margin-left:5px;margin-bottom:5px}"]}),n})();var jt=u(97084),$=u(3848),v=u(30671),z=u(73162);function Jt(n,a){1&n&&e._UZ(0,"mat-progress-bar",4)}function Ht(n,a){1&n&&(e.TgZ(0,"th",14),e._uU(1," Slug "),e.qZA())}const Bt=function(n,a){return["/",n,a]};function Gt(n,a){if(1&n&&(e.TgZ(0,"td",15)(1,"a",16),e._uU(2),e.qZA()()),2&n){const t=a.$implicit;e.xp6(1),e.Q6J("routerLink",e.WLB(2,Bt,t.language,t.slug)),e.xp6(1),e.Oqu(t.slug)}}function $t(n,a){1&n&&(e.TgZ(0,"th",14),e._uU(1," Tx "),e.qZA())}function Kt(n,a){if(1&n&&(e.TgZ(0,"td",15)(1,"a",17),e._uU(2),e.qZA(),e._UZ(3,"br")(4,"app-arweave-address",18),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.MGl("href","https://viewblock.io/arweave/block/",t.block.height,"",e.LSH),e.xp6(1),e.hij("Block: ",t.block.height," "),e.xp6(2),e.Q6J("address",t.id)("isAddress",!1)}}function Ft(n,a){1&n&&(e.TgZ(0,"th",14),e._uU(1," Reason "),e.qZA())}function Xt(n,a){if(1&n&&(e.TgZ(0,"td",15),e._uU(1),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(1),e.hij(" ",i.reasonPageRejected[t.id]," ")}}function Wt(n,a){1&n&&(e.TgZ(0,"th",14),e._uU(1," Actions"),e.qZA())}const zt=function(n,a){return["/",n,"preview",a]};function Vt(n,a){if(1&n&&(e.TgZ(0,"td",15)(1,"a",16)(2,"mat-icon"),e._uU(3,"preview"),e.qZA(),e._uU(4," Preview "),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("routerLink",e.WLB(1,zt,i.routeLang,t.id))}}function en(n,a){1&n&&e._UZ(0,"tr",19)}function tn(n,a){1&n&&e._UZ(0,"tr",20)}function nn(n,a){if(1&n&&(e.TgZ(0,"table",5),e.ynx(1,6),e.YNc(2,Ht,2,0,"th",7),e.YNc(3,Gt,3,5,"td",8),e.BQk(),e.ynx(4,9),e.YNc(5,$t,2,0,"th",7),e.YNc(6,Kt,5,4,"td",8),e.BQk(),e.ynx(7,10),e.YNc(8,Ft,2,0,"th",7),e.YNc(9,Xt,2,1,"td",8),e.BQk(),e.ynx(10,11),e.YNc(11,Wt,2,0,"th",7),e.YNc(12,Vt,5,4,"td",8),e.BQk(),e.YNc(13,en,1,0,"tr",12),e.YNc(14,tn,1,0,"tr",13),e.qZA()),2&n){const t=e.oxw();e.Q6J("dataSource",t.pages),e.xp6(13),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns)}}function an(n,a){1&n&&e._UZ(0,"mat-spinner",25)}function on(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.loadMoreResults())}),e.YNc(1,an,1,0,"mat-spinner",24),e._uU(2," Load more results "),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",t.loadingMore),e.xp6(1),e.Q6J("ngIf",t.loadingMore)}}function sn(n,a){if(1&n&&(e.TgZ(0,"div",21),e.YNc(1,on,3,2,"button",22),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.eof)}}function rn(n,a){1&n&&(e.TgZ(0,"p"),e._uU(1," No results found.\n"),e.qZA())}let gn=(()=>{class n{constructor(t,i,o,s,r){this._snackBar=t,this._arweave=i,this._auth=o,this._userSettings=s,this._arwikiTokenContract=r,this.address="",this.routeLang="",this._arwikiQuery=null,this.loading=!1,this.pages=[],this.myPagesSubscription=y.w0.EMPTY,this.myPagesNextSubscription=y.w0.EMPTY,this.baseURL=this._arweave.baseURL,this.lockButtons=!1,this.displayedColumns=["slug","id","reason","actions"],this.loadingMore=!1,this.table=null,this.eof=!1,this.reasonPageRejected={}}ngOnInit(){this._arwikiQuery=new N.x(this._arweave.arweave),this.getPagesRejected()}getPagesRejected(){this.pages=[],this.loading=!0,this.myPagesSubscription=(0,H.D)(this.getCurrentHeight()).pipe((0,m.w)(i=>this._arwikiQuery.getRejectedPagesByOwners(this.address,this.routeLang,100,i,!0))).subscribe({next:i=>{const o=[];for(let s of i){const r=new U.default(s,this._arweave.arweave),p=this._arwikiQuery.searchKeyNameInTags(r.tags,"Arwiki-Page-Title"),g=this._arwikiQuery.searchKeyNameInTags(r.tags,"Arwiki-Page-Slug"),d=this._arwikiQuery.searchKeyNameInTags(r.tags,"Arwiki-Page-Lang"),c="",l=this._arwikiQuery.searchKeyNameInTags(r.tags,"Arwiki-Page-Id"),_=this._arwikiQuery.searchKeyNameInTags(r.tags,"Arwiki-Page-Reason"),x="",I="";this.reasonPageRejected[l]=_,o.push({title:p,slug:g,category:x,img:I,owner:c,language:d,id:l,block:r.block})}this.pages=o,this.loading=!1},error:i=>{this.message(i,"error"),this.loading=!1}})}ngOnDestroy(){this.myPagesSubscription.unsubscribe(),this.myPagesNextSubscription.unsubscribe()}sanitizeImg(t){return t.indexOf("http")>=0?t:t?`${this.baseURL}${t}`:""}message(t,i="",o){this._snackBar.open(t,"X",{duration:4e3,horizontalPosition:"center",verticalPosition:o,panelClass:i})}timestampToDate(t){return new Date(1e3*t)}getCurrentHeight(){var t=this;return(0,h.Z)(function*(){let i={},o=0;try{i=yield t._arweave.arweave.network.getInfo(),o=i.height?i.height:0}catch(s){throw Error(`${s}`)}return o})()}loadMoreResults(){let t=[];this.loadingMore=!0,this.myPagesNextSubscription=this._arwikiQuery.next().pipe((0,m.w)(i=>{t=i;const o=[];for(let s of i)o.push(s.id);return 0===o.length?(this.eof=!0,(0,T.of)({})):this._arwikiTokenContract.getApprovedPages(this.routeLang,-1)})).subscribe({next:i=>{for(let o of t){const s=new U.default(o,this._arweave.arweave),r=this._arwikiQuery.searchKeyNameInTags(s.tags,"Arwiki-Page-Title"),p=this._arwikiQuery.searchKeyNameInTags(s.tags,"Arwiki-Page-Slug"),g=this._arwikiQuery.searchKeyNameInTags(s.tags,"Arwiki-Page-Lang"),d="",c=s.id,l=this._arwikiQuery.searchKeyNameInTags(s.tags,"Arwiki-Page-Reason"),_="",x="";this.reasonPageRejected[c]=l,this.pages.push({title:r,slug:p,category:_,img:x,owner:d,language:g,id:c,block:s.block})}this.loadingMore=!1,this.table.renderRows()},error:i=>{this.message(i,"error"),this.loadingMore=!1}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(L.ux),e.Y36(M.N),e.Y36(k.e),e.Y36(O.s),e.Y36(C.d))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-history-pages-rejected"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.BZ,5),2&t){let o;e.iGM(o=e.CRH())&&(i.table=o.first)}},inputs:{address:"address",routeLang:["lang","routeLang"]},decls:6,vars:4,consts:[["mode","indeterminate","class","loader","color","primary",4,"ngIf"],["mat-table","","class","mat-elevation-z8",3,"dataSource",4,"ngIf"],["class","text-right",4,"ngIf"],[4,"ngIf"],["mode","indeterminate","color","primary",1,"loader"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","slug"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","id"],["matColumnDef","reason"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-button","",3,"routerLink"],["target","_blank","mat-button","",3,"href"],[3,"address","isAddress"],["mat-header-row",""],["mat-row",""],[1,"text-right"],["mat-button","",3,"disabled","click",4,"ngIf"],["mat-button","",3,"disabled","click"],["diameter","22","mode","indeterminate","class","spinner-icon","color","primary",4,"ngIf"],["diameter","22","mode","indeterminate","color","primary",1,"spinner-icon"]],template:function(t,i){1&t&&(e.YNc(0,Jt,1,0,"mat-progress-bar",0),e.TgZ(1,"h2"),e._uU(2,"Pages Rejected"),e.qZA(),e.YNc(3,nn,15,3,"table",1),e.YNc(4,sn,2,1,"div",2),e.YNc(5,rn,2,0,"p",3)),2&t&&(e.Q6J("ngIf",i.loading),e.xp6(3),e.Q6J("ngIf",!i.loading&&i.pages&&i.pages.length),e.xp6(1),e.Q6J("ngIf",!i.loading&&i.pages&&i.pages.length),e.xp6(1),e.Q6J("ngIf",!(i.loading||i.pages&&i.pages.length)))},dependencies:[f.O5,A.yS,P.lW,P.zs,b.Hw,Q.Ou,z.pW,q.N,v.BZ,v.fO,v.as,v.w1,v.Dz,v.nj,v.ge,v.ev,v.XQ,v.Gk],styles:["table[_ngcontent-%COMP%]{width:90%;margin:20px auto 0}.loader[_ngcontent-%COMP%]{margin:0 auto}.spinner-icon[_ngcontent-%COMP%]{float:left}"]}),n})();function cn(n,a){1&n&&e._UZ(0,"mat-progress-bar",3)}function pn(n,a){1&n&&(e.TgZ(0,"th",13),e._uU(1," Slug "),e.qZA())}const dn=function(n,a){return["/",n,a]};function ln(n,a){if(1&n&&(e.TgZ(0,"td",14)(1,"a",15),e._uU(2),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("routerLink",e.WLB(2,dn,i.routeLang,t.slug)),e.xp6(1),e.Oqu(t.slug)}}function un(n,a){1&n&&(e.TgZ(0,"th",13),e._uU(1," Tx "),e.qZA())}function _n(n,a){if(1&n&&(e.TgZ(0,"td",14),e._UZ(1,"app-arweave-address",16),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Q6J("address",t.id)("isAddress",!1)}}function mn(n,a){1&n&&(e.TgZ(0,"th",13),e._uU(1," At "),e.qZA())}function fn(n,a){if(1&n&&(e.TgZ(0,"td",14)(1,"a",17),e._uU(2),e.qZA(),e._UZ(3,"br")(4,"app-arweave-address",16),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.MGl("href","https://viewblock.io/arweave/block/",t.start,"",e.LSH),e.xp6(1),e.hij("Block: ",t.start," "),e.xp6(2),e.Q6J("address",t.id)("isAddress",!1)}}function hn(n,a){1&n&&(e.TgZ(0,"th",13),e._uU(1," Actions "),e.qZA())}const vn=function(n,a){return["/",n,"preview",a]};function xn(n,a){if(1&n&&(e.TgZ(0,"td",14)(1,"a",15)(2,"mat-icon"),e._uU(3,"preview"),e.qZA(),e._uU(4," Preview "),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("routerLink",e.WLB(1,vn,i.routeLang,t.id))}}function An(n,a){1&n&&e._UZ(0,"tr",18)}function Tn(n,a){1&n&&e._UZ(0,"tr",19)}function wn(n,a){if(1&n&&(e.TgZ(0,"table",4),e.ynx(1,5),e.YNc(2,pn,2,0,"th",6),e.YNc(3,ln,3,5,"td",7),e.BQk(),e.ynx(4,8),e.YNc(5,un,2,0,"th",6),e.YNc(6,_n,2,2,"td",7),e.BQk(),e.ynx(7,9),e.YNc(8,mn,2,0,"th",6),e.YNc(9,fn,5,4,"td",7),e.BQk(),e.ynx(10,10),e.YNc(11,hn,2,0,"th",6),e.YNc(12,xn,5,4,"td",7),e.BQk(),e.YNc(13,An,1,0,"tr",11),e.YNc(14,Tn,1,0,"tr",12),e.qZA()),2&n){const t=e.oxw();e.Q6J("dataSource",t.pages),e.xp6(13),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns)}}function Zn(n,a){1&n&&(e.TgZ(0,"p"),e._uU(1," No results found.\n"),e.qZA())}let Pn=(()=>{class n{constructor(t,i,o,s,r){this._snackBar=t,this._arweave=i,this._auth=o,this._userSettings=s,this._arwikiTokenContract=r,this.address="",this.routeLang="",this._arwikiQuery=null,this.loading=!1,this.pages=[],this.myPagesSubscription=y.w0.EMPTY,this.baseURL=this._arweave.baseURL,this.lockButtons=!1,this.displayedColumns=["slug","id","at","actions"],this.table=null}ngOnInit(){this._arwikiQuery=new N.x(this._arweave.arweave),this.getMyArWikiPages(this.address)}getMyArWikiPages(t){this.pages=[],this.loading=!0,this.myPagesSubscription=this._arwikiTokenContract.getApprovedPages(this.routeLang,-1).subscribe({next:s=>{const r=[];for(const p of Object.keys(s)){const g=s[p].updates;for(const d of g){const l=+d.at,_=d.tx;d.approvedBy===t&&r.push({id:_,title:"",slug:p,category:"",sponsor:"",language:"",owner:"",start:l})}}this.pages=r.sort((p,g)=>g.start-p.start),this.loading=!1},error:s=>{this.message(s,"error"),this.loading=!1}})}ngOnDestroy(){this.myPagesSubscription.unsubscribe()}sanitizeImg(t){return t.indexOf("http")>=0?t:t?`${this.baseURL}${t}`:""}message(t,i="",o){this._snackBar.open(t,"X",{duration:4e3,horizontalPosition:"center",verticalPosition:o,panelClass:i})}timestampToDate(t){return new Date(1e3*t)}getCurrentHeight(){var t=this;return(0,h.Z)(function*(){let i={},o=0;try{i=yield t._arweave.arweave.network.getInfo(),o=i.height?i.height:0}catch(s){throw Error(`${s}`)}return o})()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(L.ux),e.Y36(M.N),e.Y36(k.e),e.Y36(O.s),e.Y36(C.d))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-history-updates-approved"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.BZ,5),2&t){let o;e.iGM(o=e.CRH())&&(i.table=o.first)}},inputs:{address:"address",routeLang:["lang","routeLang"]},decls:5,vars:3,consts:[["mode","indeterminate","class","loader","color","primary",4,"ngIf"],["mat-table","","class","mat-elevation-z8",3,"dataSource",4,"ngIf"],[4,"ngIf"],["mode","indeterminate","color","primary",1,"loader"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","slug"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","id"],["matColumnDef","at"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-button","",3,"routerLink"],[3,"address","isAddress"],["target","_blank","mat-button","",3,"href"],["mat-header-row",""],["mat-row",""]],template:function(t,i){1&t&&(e.YNc(0,cn,1,0,"mat-progress-bar",0),e.TgZ(1,"h2"),e._uU(2,"Updates Approved"),e.qZA(),e.YNc(3,wn,15,3,"table",1),e.YNc(4,Zn,2,0,"p",2)),2&t&&(e.Q6J("ngIf",i.loading),e.xp6(3),e.Q6J("ngIf",!i.loading&&i.pages&&i.pages.length),e.xp6(1),e.Q6J("ngIf",!(i.loading||i.pages&&i.pages.length)))},dependencies:[f.O5,A.yS,P.zs,b.Hw,z.pW,q.N,v.BZ,v.fO,v.as,v.w1,v.Dz,v.nj,v.ge,v.ev,v.XQ,v.Gk],styles:["table[_ngcontent-%COMP%]{width:90%;margin:20px auto 0}.loader[_ngcontent-%COMP%]{margin:0 auto}.spinner-icon[_ngcontent-%COMP%]{float:left}"]}),n})();function yn(n,a){1&n&&(e.TgZ(0,"div",10),e._UZ(1,"mat-spinner",11),e.qZA())}function bn(n,a){1&n&&(e.TgZ(0,"div",12)(1,"strong"),e._uU(2,"Role:"),e.qZA(),e._uU(3," \u2b50Moderator "),e.qZA())}function kn(n,a){1&n&&(e.TgZ(0,"mat-card",13)(1,"mat-card-title"),e._uU(2,"Warning!"),e.qZA(),e.TgZ(3,"mat-card-content"),e._uU(4," The user is not a Moderator! "),e.qZA()())}function Cn(n,a){if(1&n&&e._UZ(0,"img",19),2&n){const t=e.oxw(3);e.Q6J("src",t.profile.avatarURL,e.LSH)}}function Ln(n,a){if(1&n&&e._UZ(0,"img",19),2&n){const t=e.oxw(3);e.Q6J("src",t.defaultAvatar,e.LSH)}}function Un(n,a){if(1&n&&(e.TgZ(0,"h2")(1,"span"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.profile.username)}}function In(n,a){if(1&n&&(e.TgZ(0,"h4"),e._uU(1,"Handle: "),e.TgZ(2,"span"),e._uU(3),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(3),e.Oqu(t.profile.handleName)}}function Mn(n,a){if(1&n&&(e.TgZ(0,"h4"),e._uU(1,"Name: "),e.TgZ(2,"span"),e._uU(3),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(3),e.Oqu(t.profile.name)}}function Sn(n,a){if(1&n&&(e.TgZ(0,"a",22),e._UZ(1,"img",23),e.TgZ(2,"span"),e._uU(3),e.qZA()()),2&n){const t=e.oxw(4);e.Q6J("href",t.socialLink(t.profile.links.twitter,"twitter"),e.LSH),e.xp6(3),e.Oqu(t.profile.links.twitter)}}function On(n,a){if(1&n&&(e.TgZ(0,"a",22),e._UZ(1,"img",24),e.TgZ(2,"span"),e._uU(3),e.qZA()()),2&n){const t=e.oxw(4);e.Q6J("href",t.socialLink(t.profile.links.github,"github"),e.LSH),e.xp6(3),e.Oqu(t.profile.links.github)}}function Nn(n,a){if(1&n&&(e.TgZ(0,"a",22),e._UZ(1,"img",25),e.TgZ(2,"span"),e._uU(3),e.qZA()()),2&n){const t=e.oxw(4);e.Q6J("href",t.socialLink(t.profile.links.youtube,"youtube"),e.LSH),e.xp6(3),e.Oqu(t.profile.links.youtube)}}function qn(n,a){if(1&n&&(e.TgZ(0,"a",22),e._UZ(1,"img",26),e.TgZ(2,"span"),e._uU(3),e.qZA()()),2&n){const t=e.oxw(4);e.Q6J("href",t.socialLink(t.profile.links.instagram,"instagram"),e.LSH),e.xp6(3),e.Oqu(t.profile.links.instagram)}}function En(n,a){if(1&n&&(e.TgZ(0,"a",22),e._UZ(1,"img",27),e.TgZ(2,"span"),e._uU(3),e.qZA()()),2&n){const t=e.oxw(4);e.Q6J("href",t.socialLink(t.profile.links.facebook,"facebook"),e.LSH),e.xp6(3),e.Oqu(t.profile.links.facebook)}}function Yn(n,a){if(1&n&&(e.TgZ(0,"div",20),e.YNc(1,Sn,4,2,"a",21),e.YNc(2,On,4,2,"a",21),e.YNc(3,Nn,4,2,"a",21),e.YNc(4,qn,4,2,"a",21),e.YNc(5,En,4,2,"a",21),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.profile.links.twitter),e.xp6(1),e.Q6J("ngIf",t.profile.links.github),e.xp6(1),e.Q6J("ngIf",t.profile.links.youtube),e.xp6(1),e.Q6J("ngIf",t.profile.links.instagram),e.xp6(1),e.Q6J("ngIf",t.profile.links.facebook)}}function Qn(n,a){if(1&n&&(e.TgZ(0,"p",28),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(t.profile.bio)}}function Rn(n,a){if(1&n&&(e.TgZ(0,"div",10),e.YNc(1,Cn,1,1,"img",14),e.YNc(2,Ln,1,1,"img",14),e.YNc(3,Un,3,1,"h2",15),e.YNc(4,In,4,1,"h4",15),e.YNc(5,Mn,4,1,"h4",15),e.TgZ(6,"app-arweave-address",16),e._uU(7,"Address: "),e.qZA(),e.YNc(8,Yn,6,5,"div",17),e.YNc(9,Qn,2,1,"p",18),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.profile.avatarURL),e.xp6(1),e.Q6J("ngIf",!t.profile.avatarURL),e.xp6(1),e.Q6J("ngIf",t.profile.username),e.xp6(1),e.Q6J("ngIf",t.profile.handleName),e.xp6(1),e.Q6J("ngIf",t.profile.name),e.xp6(1),e.Q6J("address",t.address)("showProfileImage",!1)("showHandleInAddress",!1)("isAddress",!0),e.xp6(2),e.Q6J("ngIf",t.profile.links),e.xp6(1),e.Q6J("ngIf",t.profile.bio)}}function Dn(n,a){if(1&n&&(e.TgZ(0,"div",10),e._UZ(1,"img",19),e.TgZ(2,"app-arweave-address",16),e._uU(3,"Address: "),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("src",t.defaultAvatar,e.LSH),e.xp6(1),e.Q6J("address",t.address)("showProfileImage",!1)("showHandleInAddress",!1)("isAddress",!0)}}function jn(n,a){if(1&n&&(e.TgZ(0,"div",1),e.YNc(1,yn,2,0,"div",7),e.YNc(2,bn,4,0,"div",8),e.YNc(3,kn,5,0,"mat-card",9),e.YNc(4,Rn,10,11,"div",7),e.YNc(5,Dn,4,5,"div",7),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.loadingProfile),e.xp6(1),e.Q6J("ngIf",t.isAdmin&&!t.loadingProfile),e.xp6(1),e.Q6J("ngIf",!t.isAdmin&&!t.loadingProfile),e.xp6(1),e.Q6J("ngIf",t.profile&&!t.loadingProfile),e.xp6(1),e.Q6J("ngIf",!t.profile&&!t.loadingProfile&&t.address)}}function Jn(n,a){if(1&n&&e._UZ(0,"app-history-updates-approved",34),2&n){const t=e.oxw(2);e.Q6J("lang",t.routeLang)("address",t.address)}}function Hn(n,a){if(1&n&&e._UZ(0,"app-history-pages-rejected",34),2&n){const t=e.oxw(2);e.Q6J("lang",t.routeLang)("address",t.address)}}function Bn(n,a){1&n&&(e.TgZ(0,"div",1)(1,"h2",10),e._uU(2," Activity History "),e.qZA(),e.TgZ(3,"div",29)(4,"mat-tab-group",30)(5,"mat-tab",31),e.YNc(6,Jn,1,2,"ng-template",32),e.qZA(),e.TgZ(7,"mat-tab",33),e.YNc(8,Hn,1,2,"ng-template",32),e.qZA()()()())}function Gn(n,a){1&n&&(e.TgZ(0,"div",1)(1,"div",35),e._uU(2," Profile not found. "),e.qZA()())}const Kn=[{path:"",canActivateChild:[ee.a,ne],children:[{path:"pending",component:we},{path:"approved",component:tt},{path:"deleted",component:ft},{path:"tag-manager/:slug",component:yt},{path:"page-updates/:slug",component:Dt},{path:"add-admin",component:Ze},{path:"view-admin-list",component:be},{path:"",redirectTo:"pending",pathMatch:"full"}]},{path:"activity-history/:address",component:(()=>{class n{constructor(t,i,o,s,r,p,g){this._auth=t,this._route=i,this._snackBar=o,this._location=s,this._arwikiToken=r,this._dialog=p,this._userSettings=g,this.address="",this.currentAddress="",this.profile=null,this.profileSubscription=y.w0.EMPTY,this.defaultAvatar="assets/img/blank-profile.png",this.loadingProfile=!1,this.isAdmin=!1,this.isAdminSubscription=y.w0.EMPTY,this.routeLang=""}ngOnInit(){const t=this._route.snapshot.paramMap.get("address"),i=this._route.snapshot.paramMap.get("lang");this.address="",t&&(this.address=t,this.loadProfile(this.address),this.isAdminCheck(this.address)),i&&(this.routeLang=i),this._route.paramMap.subscribe(o=>{const s=o.get("address"),r=o.get("lang");this.address="",this.routeLang="",s&&(this.address=s,this.loadProfile(this.address),this.isAdminCheck(this.address)),r&&(this.routeLang=r)}),this.currentAddress=this._auth.getMainAddressSnapshot(),this._auth.account$.subscribe(o=>{this.currentAddress=o})}loadProfile(t){this.loadingProfile=!0,this.profileSubscription=this._auth.getProfile(t).subscribe({next:i=>{this.profile=null,i&&(this.profile=i),this.loadingProfile=!1},error:i=>{this.loadingProfile=!1,this.message(i,"error")}})}message(t,i="",o){this._snackBar.open(t,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:o,panelClass:i})}goBack(){this._location.back()}ngOnDestroy(){this.profileSubscription.unsubscribe(),this.isAdminSubscription.unsubscribe()}isAdminCheck(t){this.isAdminSubscription=this._arwikiToken.isAdmin(t).subscribe({next:i=>{this.isAdmin=!1,i&&(this.isAdmin=!0)},error:i=>{this.message(i,"error")}})}socialLink(t,i){let o="";return"twitter"===i?o=`https://twitter.com/${t}`:"youtube"===i?o=`https://youtube.com/${t}`:"github"===i?o=`https://github.com/${t}`:"instagram"===i?o=`https://instagram.com/${t}`:"facebook"===i&&(o=`https://facebook.com/${t}`),o}donate(){let i="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";const o=this._auth.getMainAddressSnapshot();this._dialog.open(jt.i,{data:{sponsor:this.address,mainAddress:o},direction:i,disableClose:!0}).afterClosed().subscribe(function(){var r=(0,h.Z)(function*(p){});return function(p){return r.apply(this,arguments)}}())}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(k.e),e.Y36(A.gz),e.Y36(L.ux),e.Y36(f.Ye),e.Y36(C.d),e.Y36(w.uw),e.Y36(O.s))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-activity-history"]],decls:18,vars:9,consts:[[1,"container","profile-container"],[1,"row","fadeIn"],[1,"page-title","col-12","col-md-9"],[1,"text-right","page-title-buttons","col-12","col-md-3"],["type","button","mat-button","","color","primary",1,"btn-toolbar",3,"click"],[1,"green-money","animate__animated","animate__heartBeat","animate__slow","animate__infinite"],["class","row fadeIn",4,"ngIf"],["class","col-12",4,"ngIf"],["class","col-12 text-right",4,"ngIf"],["class","col-12 error",4,"ngIf"],[1,"col-12"],[1,"spinner-center"],[1,"col-12","text-right"],[1,"col-12","error"],["class","avatar",3,"src",4,"ngIf"],[4,"ngIf"],[1,"mini-text",3,"address","showProfileImage","showHandleInAddress","isAddress"],["class","row-col-social-media",4,"ngIf"],["class","text-center bio",4,"ngIf"],[1,"avatar",3,"src"],[1,"row-col-social-media"],["mat-button","","color","accent","target","_blank",3,"href",4,"ngIf"],["mat-button","","color","accent","target","_blank",3,"href"],["src","./assets/img/social-media/twitterWhite.png",1,"invert-colors"],["src","./assets/img/social-media/github2.png",1,"invert-colors"],["src","./assets/img/social-media/ytWhite.png",1,"invert-colors"],["src","./assets/img/social-media/instagramWhite.png",1,"invert-colors"],["src","./assets/img/social-media/facebookWhite.png",1,"invert-colors"],[1,"text-center","bio"],[1,"col-12","history"],["color","accent"],["label","Updates Approved"],["matTabContent",""],["label","Pages Rejected"],[3,"lang","address"],[1,"col"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),e._uU(3," Moderator's Profile "),e.qZA(),e.TgZ(4,"div",3)(5,"button",4),e.NdJ("click",function(){return i.donate()}),e.TgZ(6,"mat-icon",5),e._uU(7,"volunteer_activism"),e.qZA(),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",4),e.NdJ("click",function(){return i.goBack()}),e.TgZ(11,"mat-icon"),e._uU(12,"navigate_before"),e.qZA(),e._uU(13),e.ALo(14,"translate"),e.qZA()()(),e.YNc(15,jn,6,5,"div",6),e.YNc(16,Bn,9,0,"div",6),e.YNc(17,Gn,3,0,"div",6),e.qZA()),2&t&&(e.xp6(8),e.hij(" ",e.lcZ(9,5,"GENERAL.BUTTONS.BTN_DONATE")," "),e.xp6(5),e.hij(" ",e.lcZ(14,7,"GENERAL.BUTTONS.GO_BACK")," "),e.xp6(2),e.Q6J("ngIf",i.address),e.xp6(1),e.Q6J("ngIf",i.address&&!i.loadingProfile),e.xp6(1),e.Q6J("ngIf",!i.address))},dependencies:[f.O5,P.lW,P.zs,b.Hw,Q.Ou,R.a8,R.dn,R.n5,$.SP,$.uX,$.Vc,q.N,gn,Pn,Y.X$],styles:[".profile-container[_ngcontent-%COMP%]{min-height:600px;margin-top:100px}h1[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], h2[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], h4[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:400}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%]{margin-bottom:6px;margin-top:6px}h1[_ngcontent-%COMP%]{margin-bottom:20px}.avatar[_ngcontent-%COMP%]{width:200px;height:200px;border-radius:50%;object-fit:cover;flex-shrink:0;vertical-align:middle;margin-left:24px;margin-right:24px;float:none;margin-bottom:20px}.page-title[_ngcontent-%COMP%], .page-title-buttons[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}.btn-toolbar[_ngcontent-%COMP%]{color:inherit}.row-col-social-media[_ngcontent-%COMP%]{text-align:left}.row-col-social-media[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:4px;margin-right:4px}.row-col-social-media[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:6px}.row-col-social-media[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:28px;height:28px}@media (min-width: 600px){.avatar[_ngcontent-%COMP%]{float:left}}.mini-text[_ngcontent-%COMP%]{font-size:12px}.bio[_ngcontent-%COMP%]{clear:both}.history[_ngcontent-%COMP%]{min-height:400px;margin-bottom:40px}.mat-card.error[_ngcontent-%COMP%]{margin-bottom:20px}"]}),n})()}];let Fn=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[A.Bz.forChild(Kn),A.Bz]}),n})(),Xn=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[f.ez,Fn,V.m]}),n})()}}]);