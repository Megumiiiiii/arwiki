"use strict";(self.webpackChunkarwiki=self.webpackChunkarwiki||[]).push([[783],{22783:(Kt,B,u)=>{u.r(B),u.d(B,{ModeratorsModule:()=>Ht});var m=u(69808),F=u(60870),T=u(68555),X=u(3870),x=u(21086),_=u(87545),W=u(27221),e=u(5e3),y=u(50384),C=u(46649),k=u(32094),I=u(57261),E=u(69817);let V=(()=>{class i{constructor(t,a,o,r,s){this._auth=t,this._arweave=a,this._arwikiTokenContract=o,this._snackBar=r,this._userSettings=s}canActivate(t,a){return this.isUserModerator()}canActivateChild(t,a){return this.isUserModerator()}isUserModerator(){const t=this._auth.getMainAddressSnapshot();return this._userSettings.updateMainToolbarLoading(!0),this._arwikiTokenContract.getAdminList().pipe((0,_.w)(a=>{const o=a.indexOf(t)>=0;return this._auth.setAdminList(a),this._userSettings.updateMainToolbarLoading(!1),o?(0,x.of)(!0):(this.message("You are not a moderator!","error"),(0,x.of)(!1))}),(0,W.K)(a=>(this.message(a,"error"),(0,x.of)(!1))))}message(t,a="",o){this._snackBar.open(t,"X",{duration:4e3,horizontalPosition:"center",verticalPosition:o,panelClass:a})}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(y.e),e.LFG(C.N),e.LFG(k.d),e.LFG(I.ux),e.LFG(E.s))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var f=u(70655),Z=u(42654),$=u(31783),Y=u(22333),v=u(48966),P=u(25245),M=u(67322),H=u(77531),w=u(47423);let z=(()=>{class i{constructor(t){this.data=t}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(v.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-dialog-reject-reason"]],decls:18,vars:3,consts:[["mat-dialog-title",""],[1,"red","title-icon"],["appearance","outline",1,"txt-reason"],["matInput","",1,"txt-reason"],["reason",""],["align","end"],["mat-button","",3,"disabled","mat-dialog-close"],["mat-button","","mat-dialog-close","","cdkFocusInitial",""]],template:function(t,a){if(1&t&&(e.TgZ(0,"h2",0)(1,"mat-icon",1),e._uU(2,"delete"),e.qZA(),e.TgZ(3,"span"),e._uU(4,"Reject page"),e.qZA()(),e.TgZ(5,"mat-dialog-content")(6,"p"),e._uU(7),e.qZA(),e.TgZ(8,"mat-form-field",2)(9,"mat-label"),e._uU(10,"Reason"),e.qZA(),e._UZ(11,"textarea",3,4),e.qZA()(),e.TgZ(13,"mat-dialog-actions",5)(14,"button",6),e._uU(15,"Alright! Let's do it!"),e.qZA(),e.TgZ(16,"button",7),e._uU(17,"Cancel"),e.qZA()()),2&t){const o=e.MAs(12);e.xp6(7),e.hij("You are about to reject a page with tx id ",a.data.id,". Do you want to proceed? Please add a reason to continue."),e.xp6(7),e.Q6J("disabled",!o.value)("mat-dialog-close",o.value)}},directives:[v.uh,P.Hw,v.xY,M.KE,M.hX,H.Nt,v.H8,w.lW,v.ZT],styles:[".title-icon[_ngcontent-%COMP%]{font-size:40px;line-height:40px;width:40px;height:40px;vertical-align:middle}.mat-dialog-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:12px;vertical-align:middle;font-size:26px;font-family:Roboto Mono,monospace;line-height:38px}.txt-reason[_ngcontent-%COMP%]{width:100%}"]}),i})();var O=u(51614),L=u(89716),b=u(38952),ee=u(34594),q=u(41496);let S=(()=>{class i{constructor(t,a,o){this._location=t,this._userSettings=a,this._route=o,this.title="",this.routerLang=""}ngOnInit(){this._route.paramMap.subscribe(t=>{this.routerLang=t.get("lang")})}goBack(){this._location.back()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(m.Ye),e.Y36(E.s),e.Y36(T.gz))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-moderators-menu"]],inputs:{title:"title"},decls:17,vars:7,consts:[["color","secondary",1,"fadeIn","moderatorsBreadcrumb"],["aria-hidden","false","aria-label","Moderators"],[1,"menu-spacer"],[1,"container","mb20"],[1,"row"],[1,"page-title","col-12","col-md-9"],[1,"text-right","page-title-buttons","col-12","col-md-3"],["type","button","mat-button","","color","primary",1,"ml10","btn-toolbar2",3,"click"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-toolbar",0)(1,"mat-icon",1),e._uU(2,"admin_panel_settings"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e._UZ(6,"span",2),e.qZA(),e.TgZ(7,"div",3)(8,"div",4)(9,"h1",5),e._uU(10),e.qZA(),e.TgZ(11,"div",6)(12,"button",7),e.NdJ("click",function(){return a.goBack()}),e.TgZ(13,"mat-icon"),e._uU(14,"navigate_before"),e.qZA(),e._uU(15),e.ALo(16,"translate"),e.qZA()()()()),2&t&&(e.xp6(4),e.hij("\xa0",e.lcZ(5,3,"MODERATORS.LABEL_TOOLBAR_TITLE"),""),e.xp6(6),e.hij(" ",a.title," "),e.xp6(5),e.hij(" ",e.lcZ(16,5,"CREATE_PAGE.FRM_BTN_GOBACK")," "))},directives:[ee.Ye,P.Hw,w.lW],pipes:[q.X$],styles:[".page-title[_ngcontent-%COMP%], .page-title-buttons[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:20px}.btn-toolbar2[_ngcontent-%COMP%]{color:inherit}.moderatorsBreadcrumb[_ngcontent-%COMP%]{margin-top:54px;margin-bottom:40px}@media (min-width: 600px){.moderatorsBreadcrumb[_ngcontent-%COMP%]{margin-top:64px}}mat-toolbar[_ngcontent-%COMP%]{font-family:Roboto Mono,monospace}.mb20[_ngcontent-%COMP%]{margin-bottom:20px}"]}),i})();var N=u(20773),Q=u(9224),j=u(97134),R=u(87238);function te(i,n){1&i&&e._UZ(0,"mat-spinner",5)}function ie(i,n){1&i&&(e.TgZ(0,"div",9),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"MODERATORS.LABEL_NO_RESULTS")," "))}function ae(i,n){if(1&i&&(e.TgZ(0,"mat-card",24),e._UZ(1,"img",25),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(1),e.s9C("src",a.baseURL+a.pages[t].img,e.LSH)}}function ne(i,n){1&i&&(e.TgZ(0,"div",26)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&i&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_TX_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_TX_PENDING")," "))}function se(i,n){if(1&i&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_HEIGHT"),":"),e.xp6(2),e.hij(" ",a.pages[t].block.height," ")}}function oe(i,n){if(1&i&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"date"),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_TIMESTAMP"),":"),e.xp6(2),e.hij(" ",e.xi3(5,4,a.timestampToDate(a.pages[t].block.timestamp),"short")," ")}}function re(i,n){if(1&i&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_ARVERIFY_SCORE"),": "),e.xp6(2),e.hij(" ",a.arverifyProcessedAddressesMap[a.pages[t].owner].percentage," % ")}}function ge(i,n){1&i&&(e.TgZ(0,"div",27)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"mat-icon"),e._uU(5,"verified_user"),e.qZA(),e._uU(6),e.ALo(7,"translate"),e.qZA()),2&i&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_OWNER_STATUS"),": "),e.xp6(4),e.hij(" ",e.lcZ(7,4,"PAGE.STATUS_ADDRESS_VERIFIED")," "))}function ce(i,n){1&i&&(e.TgZ(0,"div",26)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&i&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_OWNER_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_ADDRESS_NOTVERIFIED")," "))}function de(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",10)(1,"mat-card")(2,"h2",11),e._uU(3),e.qZA(),e.YNc(4,ae,2,1,"mat-card",12),e.TgZ(5,"div"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"div"),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"div"),e._uU(15),e.qZA(),e._UZ(16,"hr",13),e.YNc(17,ne,6,6,"div",14),e.TgZ(18,"div",15)(19,"app-arweave-address",16),e._uU(20),e.ALo(21,"translate"),e.qZA()(),e.TgZ(22,"div",15)(23,"app-arweave-address",17),e._uU(24),e.ALo(25,"translate"),e.qZA()(),e.YNc(26,se,5,4,"div",18),e.YNc(27,oe,6,7,"div",18),e.YNc(28,re,5,4,"div",18),e.YNc(29,ge,8,6,"div",19),e.YNc(30,ce,6,6,"div",14),e.TgZ(31,"div",20)(32,"a",21),e.NdJ("click",function(){const r=e.CHM(t).$implicit,s=e.oxw(2);return s.confirmValidateArWikiPage(s.pages[r].slug,s.pages[r].id,s.pages[r].category,s.pages[r].value,s.pages[r].owner)}),e.TgZ(33,"mat-icon"),e._uU(34,"done"),e.qZA(),e._uU(35," Approve "),e.qZA(),e._uU(36," \xa0 "),e.TgZ(37,"a",22),e.NdJ("click",function(){const r=e.CHM(t).$implicit,s=e.oxw(2);return s.confirmRejectArWikiPage(s.pages[r].slug,s.pages[r].id)}),e.TgZ(38,"mat-icon"),e._uU(39,"delete"),e.qZA(),e._uU(40," Reject "),e.qZA(),e._uU(41," \xa0 "),e.TgZ(42,"a",23)(43,"mat-icon"),e._uU(44,"visibility"),e.qZA(),e._uU(45," Preview "),e.qZA()()()()}if(2&i){const t=n.$implicit,a=e.oxw(2);e.xp6(2),e.MGl("routerLink","../../preview/",a.pages[t].id,""),e.xp6(1),e.hij(" ",a.pages[t].title," "),e.xp6(1),e.Q6J("ngIf",a.pages[t].img),e.xp6(2),e.AsE(" ",e.lcZ(7,22,"PAGE.LABEL_SLUG"),": ",a.pages[t].slug," "),e.xp6(3),e.AsE(" ",e.lcZ(10,24,"PAGE.LABEL_CATEGORY"),": ",a.pages[t].category," "),e.xp6(3),e.AsE(" ",e.lcZ(13,26,"PAGE.LABEL_LANGUAGE"),": ",a.pages[t].language," "),e.xp6(3),e.hij(" Page value: ",a.pages[t].value," $WIKI "),e.xp6(2),e.Q6J("ngIf",!a.pages[t].block||!a.pages[t].block.height),e.xp6(2),e.Q6J("address",a.pages[t].id)("isAddress",!1),e.xp6(1),e.hij("",e.lcZ(21,28,"PAGE.LABEL_ID"),": "),e.xp6(3),e.Q6J("address",a.pages[t].owner),e.xp6(1),e.hij("",e.lcZ(25,30,"PAGE.LABEL_OWNER"),": "),e.xp6(2),e.Q6J("ngIf",a.pages[t].block&&a.pages[t].block.height),e.xp6(1),e.Q6J("ngIf",a.pages[t].block&&a.pages[t].block.timestamp),e.xp6(1),e.Q6J("ngIf",a.arverifyProcessedAddressesMap[a.pages[t].owner]&&a.arverifyProcessedAddressesMap[a.pages[t].owner].percentage),e.xp6(1),e.Q6J("ngIf",a.arverifyProcessedAddressesMap[a.pages[t].owner]&&a.arverifyProcessedAddressesMap[a.pages[t].owner].verified),e.xp6(1),e.Q6J("ngIf",!a.arverifyProcessedAddressesMap[a.pages[t].owner]||!a.arverifyProcessedAddressesMap[a.pages[t].owner].verified),e.xp6(12),e.MGl("routerLink","../../preview/",a.pages[t].id,"")}}function pe(i,n){if(1&i&&(e.TgZ(0,"div",6),e.YNc(1,ie,3,3,"div",7),e.YNc(2,de,46,32,"div",8),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(t.loadingPendingPages||t.pages&&t.getKeys(t.pages).length)),e.xp6(1),e.Q6J("ngForOf",t.getKeys(t.pages))}}function le(i,n){1&i&&(e.TgZ(0,"div",28)(1,"div",29),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",30),e._uU(4,"\u{1f680} Hold on! We are almost there!"),e.qZA()()())}function ue(i,n){if(1&i&&(e.TgZ(0,"div",28)(1,"div",29)(2,"h1",30),e._uU(3,"\u{1f973} Page successfully approved!"),e.qZA(),e.TgZ(4,"p",30),e._uU(5),e.qZA(),e.TgZ(6,"a",31),e._uU(7),e.qZA()()()),2&i){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.insertPageTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.insertPageTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.insertPageTxMessage," ")}}function _e(i,n){if(1&i&&(e.TgZ(0,"div",28)(1,"div",29)(2,"h1",30),e._uU(3,"Oops! something went wrong"),e.qZA(),e.TgZ(4,"p",30),e._uU(5),e.qZA()()()),2&i){const t=e.oxw();e.xp6(5),e.Oqu(t.insertPageTxErrorMessage)}}function me(i,n){1&i&&(e.TgZ(0,"div",28)(1,"div",29),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",30),e._uU(4,"\u{1f680} Hold on! We are almost there!"),e.qZA()()())}function he(i,n){if(1&i&&(e.TgZ(0,"div",28)(1,"div",29)(2,"h1",30),e._uU(3,"\u{1f973} Page rejected successfully!"),e.qZA(),e.TgZ(4,"p",30),e._uU(5),e.qZA(),e.TgZ(6,"a",31),e._uU(7),e.qZA()()()),2&i){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.rejectPageTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.rejectPageTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.rejectPageTxMessage," ")}}function fe(i,n){if(1&i&&(e.TgZ(0,"div",28)(1,"div",29)(2,"h1",30),e._uU(3,"Oops! something went wrong"),e.qZA(),e.TgZ(4,"p",30),e._uU(5),e.qZA()()()),2&i){const t=e.oxw();e.xp6(5),e.Oqu(t.rejectPageTxErrorMessage)}}let ve=(()=>{class i{constructor(t,a,o,r,s,d,c){this._arweave=t,this._auth=a,this._snackBar=o,this._dialog=r,this._route=s,this._userSettings=d,this._arwikiTokenContract=c,this.loadingPendingPages=!1,this.pages={},this.pendingPagesSubscription=Z.w.EMPTY,this.arverifyProcessedAddressesMap={},this.loadingInsertPageIntoIndex=!1,this.insertPageTxMessage="",this.insertPageTxErrorMessage="",this.routeLang="",this.baseURL=this._arweave.baseURL,this.loadingRejectPage=!1,this.rejectPageTxMessage="",this.rejectPageTxErrorMessage=""}ngOnInit(){return(0,f.mG)(this,void 0,void 0,function*(){const t=this._auth.getAdminList();this.routeLang=this._route.snapshot.paramMap.get("lang"),this._arwiki=new L.i(this._arweave.arweave),this.arwikiQuery=new O.x(this._arweave.arweave),this.loadingPendingPages=!0;let o,r=0;try{o=yield this._arweave.arweave.network.getInfo(),r=o.height}catch(d){return void this.message(`${d}`,"error")}let s={};this.pendingPagesSubscription=this._arwikiTokenContract.getCategories().pipe((0,_.w)(d=>this.arwikiQuery.getPendingPages(this.routeLang,Object.keys(d),100,r)),(0,_.w)(d=>{for(let c of d){const g=new b.default(c,this._arweave.arweave);s[g.id]={id:g.id,title:this.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Title"),slug:this.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Slug"),category:this.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Category"),language:this.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Lang"),img:this.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Img"),owner:g.owner.address,block:g.block,value:this.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Value")}}return(0,x.of)(s)}),(0,_.w)(d=>this._arwikiTokenContract.getAllPages(this.routeLang,-1).pipe((0,_.w)(c=>{let g={};const p=Object.keys(c).map(l=>c[l].content);for(let l in d)p.indexOf(l)>=0||(g[l]=d[l]);return(0,x.of)(g)}))),(0,_.w)(d=>this.arwikiQuery.getRejectedPagesByIds(t,Object.keys(d),100,r).pipe((0,_.w)(c=>{let g=[],p={};for(let l of c){const h=new b.default(l,this._arweave.arweave),U=this.arwikiQuery.searchKeyNameInTags(h.tags,"Arwiki-Page-Id");g.push(U)}for(let l in d)g.indexOf(l)<0&&(p[l]=d[l]);return(0,x.of)(p)})))).subscribe({next:d=>(0,f.mG)(this,void 0,void 0,function*(){this.pages=d,this.loadingPendingPages=!1,this.arverifyProcessedAddressesMap={};for(let c of Object.keys(d)){if(Object.prototype.hasOwnProperty.call(this.arverifyProcessedAddressesMap,d[c].owner))continue;const g=yield this.getArverifyVerification(d[c].owner);this.arverifyProcessedAddressesMap[d[c].owner]=g}}),error:d=>{this.message(d,"error"),this.loadingPendingPages=!1}})})}message(t,a="",o){this._snackBar.open(t,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:o,panelClass:a})}ngOnDestroy(){this.pendingPagesSubscription&&this.pendingPagesSubscription.unsubscribe()}getArverifyVerification(t){return(0,f.mG)(this,void 0,void 0,function*(){const a=yield(0,$.Ni)(t);return{verified:a.verified,icon:a.icon,percentage:a.percentage}})}underscoreToSpace(t){return t.replace(/[_]/gi," ")}confirmValidateArWikiPage(t,a,o,r,s){let c="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(Y.f,{data:{title:"Are you sure?",content:"You are about to approve a new arwiki page. Remember to have enough balance to stake and some other in your vault! Do you want to proceed?",pageValue:r,second_content:"Please define the final page value:"},direction:c}).afterClosed().pipe((0,_.w)(p=>{const l=+p;if(Number.isInteger(l)&&l>0)return this.loadingInsertPageIntoIndex=!0,this._arwikiTokenContract.approvePage(a,s,t,o,this.routeLang,l,this._auth.getPrivateKey(),L.y[0]);if(0===l)throw Error("Stake must be greater than 0 $WIKI tokens");return(0,x.of)(null)})).subscribe({next:p=>{p&&(this.insertPageTxMessage=`${p}`,this.message("Success!","success"))},error:p=>{this.insertPageTxErrorMessage=`${p}`,this.message(`${p}`,"error")}})}timestampToDate(t){return new Date(1e3*t)}getKeys(t){return Object.keys(t)}confirmRejectArWikiPage(t,a){let r="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(z,{data:{id:a},direction:r}).afterClosed().pipe((0,_.w)(d=>{if(d){this.loadingRejectPage=!0;const c=this._auth.getPrivateKey();return this._arwiki.createRejectTXForArwikiPage(a,t,this.routeLang,d,c)}return(0,x.of)(null)})).subscribe({next:d=>{d&&(this.rejectPageTxMessage=`${d}`,this.message("Page rejected!","success"))},error:d=>{this.rejectPageTxErrorMessage=`${d}`,this.message(`${d}`,"error")}})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(C.N),e.Y36(y.e),e.Y36(I.ux),e.Y36(v.uw),e.Y36(T.gz),e.Y36(E.s),e.Y36(k.d))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ng-component"]],decls:11,vars:11,consts:[[3,"title"],["class","spinner-center",4,"ngIf"],[1,"container","page-container","fadeIn"],["class","row",4,"ngIf"],["class","row fadeIn",4,"ngIf"],[1,"spinner-center"],[1,"row"],["class","col-12 card-page fadeIn",4,"ngIf"],["class","col-12 col-md-6 card-page fadeIn",4,"ngFor","ngForOf"],[1,"col-12","card-page","fadeIn"],[1,"col-12","col-md-6","card-page","fadeIn"],[1,"link",3,"routerLink"],["class","card-image text-center",4,"ngIf"],[1,"mbt20"],["class","red mini-text",4,"ngIf"],[1,"mini-text"],[3,"address","isAddress"],[3,"address"],["class","mini-text",4,"ngIf"],["class","green mini-text",4,"ngIf"],[1,"text-right","page-card-footer"],["mat-flat-button","","matTooltip","Approve and sponsor page",1,"approve-btn",3,"click"],["mat-flat-button","","matTooltip","Reject page","color","warn",3,"click"],["mat-flat-button","","color","primary","matTooltip","Preview",3,"routerLink"],[1,"card-image","text-center"],[3,"src"],[1,"red","mini-text"],[1,"green","mini-text"],[1,"row","fadeIn"],[1,"col","text-center"],[1,"text-center"],["mat-button","","target","_blank",1,"text-center",3,"href"]],template:function(t,a){1&t&&(e._UZ(0,"app-moderators-menu",0),e.ALo(1,"translate"),e.YNc(2,te,1,0,"mat-spinner",1),e.TgZ(3,"div",2),e.YNc(4,pe,3,2,"div",3),e.YNc(5,le,5,0,"div",4),e.YNc(6,ue,8,3,"div",4),e.YNc(7,_e,6,1,"div",4),e.YNc(8,me,5,0,"div",4),e.YNc(9,he,8,3,"div",4),e.YNc(10,fe,6,1,"div",4),e.qZA()),2&t&&(e.s9C("title",e.lcZ(1,9,"MODERATORS.PENDING_PAGE.TITLE_PENDING")),e.xp6(2),e.Q6J("ngIf",a.loadingPendingPages),e.xp6(2),e.Q6J("ngIf",!a.loadingInsertPageIntoIndex&&!a.loadingRejectPage),e.xp6(1),e.Q6J("ngIf",a.loadingInsertPageIntoIndex&&!a.insertPageTxMessage&&!a.insertPageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",a.insertPageTxMessage),e.xp6(1),e.Q6J("ngIf",a.insertPageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",a.loadingRejectPage&&!a.rejectPageTxMessage&&!a.rejectPageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",a.rejectPageTxMessage),e.xp6(1),e.Q6J("ngIf",a.rejectPageTxErrorMessage))},directives:[S,m.O5,N.Ou,m.sg,Q.a8,T.rH,j.N,P.Hw,w.zs,R.gM,T.yS],pipes:[q.X$,m.uU],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}.w70[_ngcontent-%COMP%]{width:70%}.ml10[_ngcontent-%COMP%]{margin-left:10px}.w100[_ngcontent-%COMP%]{width:100%}.w50[_ngcontent-%COMP%]{width:50%}.card-page[_ngcontent-%COMP%]{margin-bottom:40px}.approve-btn[_ngcontent-%COMP%]{background-color:#63c642;color:#fff}.link[_ngcontent-%COMP%]{cursor:pointer}.mini-text[_ngcontent-%COMP%]{font-size:12px}.mbt20[_ngcontent-%COMP%]{margin-bottom:20px;margin-top:20px}.card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.page-card-footer[_ngcontent-%COMP%]{margin-top:20px}"]}),i})();var A=u(93075),D=u(5254);let xe=(()=>{class i{constructor(t,a,o,r){this._snackBar=t,this._arwikiTokenContract=a,this._auth=o,this._arweave=r,this.createAdminFrm=new A.cw({newAdminAddress:new A.NI("")}),this.formLoading=!1,this.saveAdminSubscription=Z.w.EMPTY}get newAdminAddress(){return this.createAdminFrm.get("newAdminAddress")}ngOnInit(){}ngOnDestroy(){this.saveAdminSubscription&&this.saveAdminSubscription.unsubscribe()}createNewAdmin(){const t=this.newAdminAddress.value;this.formLoading=!0,this.newAdminAddress.disable(),this.saveAdminSubscription=(0,D.D)(this._arwikiTokenContract.registerAdmin(t,this._auth.getPrivateKey(),L.y[0])).subscribe({next:a=>{this.newadminTX=a,this.message("New admin proposal created!","success"),this.formLoading=!1,this.newAdminAddress.enable(),this.newAdminAddress.setValue("")},error:a=>{this.message(a,"error"),this.formLoading=!1,this.newAdminAddress.enable()}})}message(t,a="",o){this._snackBar.open(t,"X",{duration:5e3,horizontalPosition:"center",verticalPosition:o,panelClass:a})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(I.ux),e.Y36(k.d),e.Y36(y.e),e.Y36(C.N))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ng-component"]],decls:14,vars:2,consts:[["title","Add admin"],[1,"container","page-container","fadeIn"],[1,"row"],[1,"col-12","fadeIn"],[3,"formGroup","ngSubmit"],["matInput","","required","","autocomplete","off","formControlName","newAdminAddress"],[1,"text-center"],["type","submit","mat-raised-button","","color","primary",1,"go-button",3,"disabled"]],template:function(t,a){1&t&&(e._UZ(0,"app-moderators-menu",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4),e.NdJ("ngSubmit",function(){return a.createNewAdmin()}),e.TgZ(5,"mat-form-field")(6,"mat-label"),e._uU(7,"Arweave address of the new admin (moderator)"),e.qZA(),e._UZ(8,"input",5),e.qZA(),e.TgZ(9,"div",6)(10,"button",7)(11,"mat-icon"),e._uU(12,"save"),e.qZA(),e._uU(13," Add Admin! "),e.qZA()()()()()()),2&t&&(e.xp6(4),e.Q6J("formGroup",a.createAdminFrm),e.xp6(6),e.Q6J("disabled",!a.createAdminFrm.valid))},directives:[S,A._Y,A.JL,A.sg,M.KE,M.hX,H.Nt,A.Fj,A.Q7,A.JJ,A.u,w.lW,P.Hw],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}.page-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),i})();function Te(i,n){if(1&i&&(e.TgZ(0,"div",4),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.hij(" ",t," ")}}function Ae(i,n){1&i&&(e.TgZ(0,"div",4),e._uU(1," -- "),e.qZA())}let we=(()=>{class i{constructor(t){this._auth=t,this.adminList=this._auth.getAdminList()}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(y.e))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-view-admin-list"]],decls:8,vars:2,consts:[["title","Admin list"],[1,"container","page-container","fadeIn"],[1,"row"],["class","col-12 col-md-6 fadeIn",4,"ngFor","ngForOf"],[1,"col-12","col-md-6","fadeIn"]],template:function(t,a){1&t&&(e._UZ(0,"app-moderators-menu",0),e.TgZ(1,"div",1)(2,"div",2),e.YNc(3,Te,2,1,"div",3),e.qZA(),e.TgZ(4,"h1"),e._uU(5," Votes "),e.qZA(),e.TgZ(6,"div",2),e.YNc(7,Ae,2,0,"div",3),e.qZA()()),2&t&&(e.xp6(3),e.Q6J("ngForOf",a.adminList),e.xp6(4),e.Q6J("ngForOf",a.adminList))},directives:[S,m.sg],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}"]}),i})();var G=u(57762);function Ze(i,n){1&i&&(e.TgZ(0,"p"),e._uU(1,"Loading ..."),e.qZA())}function Pe(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"p")(2,"button",6),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).viewUpdates(r.slug)}),e._uU(3),e.qZA()()()}if(2&i){const t=n.$implicit;e.xp6(3),e.hij("",t.title," ")}}function Le(i,n){if(1&i&&(e.ynx(0),e.YNc(1,Pe,4,1,"div",5),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.pages)}}let Ce=(()=>{class i{constructor(t,a,o,r,s,d){this.data=t,this._arweave=a,this._snackBar=o,this._arwikiTokenContract=r,this._router=s,this._dialogRef=d,this.loadingPendingPages=!1,this.pages=[],this.pendingPagesSubscription=Z.w.EMPTY,this.langCode=""}ngOnInit(){return(0,f.mG)(this,void 0,void 0,function*(){this.langCode=this.data.langCode,this.arwikiQuery=new O.x(this._arweave.arweave),yield this.getUpdates()})}message(t,a="",o){this._snackBar.open(t,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:o,panelClass:a})}ngOnDestroy(){this.pendingPagesSubscription&&this.pendingPagesSubscription.unsubscribe()}getUpdates(){return(0,f.mG)(this,void 0,void 0,function*(){this.loadingPendingPages=!0;let a,o=0;try{a=yield this._arweave.arweave.network.getInfo(),o=a.height}catch(r){return void this.message(`${r}`,"error")}this.pendingPagesSubscription=this.arwikiQuery.getPendingPagesUpdatesByLang(this.langCode,100,o).pipe((0,_.w)(r=>{let s={};for(let d of r){const c=new b.default(d,this._arweave.arweave);s[c.id]={id:c.id,title:this.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Title"),slug:this.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Slug"),category:this.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Category"),language:this.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Lang"),img:this.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Img"),owner:c.owner.address,block:c.block,value:this.arwikiQuery.searchKeyNameInTags(c.tags,"Arwiki-Page-Value")}}return(0,x.of)(s)}),(0,_.w)(r=>this._arwikiTokenContract.getApprovedPages(this.langCode,-1,!0).pipe((0,_.w)(s=>{let d={},c=[];for(const g of Object.keys(s)){const p=s[g].updates.map(l=>l.tx);c=c.concat(p)}for(let g in r)c.indexOf(g)>=0||(d[g]=r[g]);return(0,x.of)(d)})))).subscribe({next:r=>(0,f.mG)(this,void 0,void 0,function*(){this.pages=Object.values(r),this.loadingPendingPages=!1}),error:r=>{this.message(r,"error"),this.loadingPendingPages=!1}})})}getKeys(t){return Object.keys(t)}viewUpdates(t){this.close(),this._router.navigate([this.langCode,"moderators","page-updates",t])}close(){this._dialogRef.close()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(v.WI),e.Y36(C.N),e.Y36(I.ux),e.Y36(k.d),e.Y36(T.F0),e.Y36(v.so))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-dialog-search-page-update"]],decls:11,vars:2,consts:[["mat-dialog-title",""],[1,"title-icon"],[4,"ngIf"],["align","end"],["mat-button","","mat-dialog-close","","cdkFocusInitial",""],[4,"ngFor","ngForOf"],["mat-button","",3,"click"]],template:function(t,a){1&t&&(e.TgZ(0,"h2",0)(1,"mat-icon",1),e._uU(2,"search"),e.qZA(),e.TgZ(3,"span"),e._uU(4,"Pending updates"),e.qZA()(),e.TgZ(5,"mat-dialog-content"),e.YNc(6,Ze,2,0,"p",2),e.YNc(7,Le,2,1,"ng-container",2),e.qZA(),e.TgZ(8,"mat-dialog-actions",3)(9,"button",4),e._uU(10,"Cancel"),e.qZA()()),2&t&&(e.xp6(6),e.Q6J("ngIf",a.loadingPendingPages),e.xp6(1),e.Q6J("ngIf",!a.loadingPendingPages))},directives:[v.uh,P.Hw,v.xY,m.O5,m.sg,w.lW,v.H8,v.ZT],styles:[".title-icon[_ngcontent-%COMP%]{font-size:40px;line-height:40px;width:40px;height:40px;vertical-align:middle}.mat-dialog-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:12px;vertical-align:middle;font-size:26px;font-family:Roboto Mono,monospace;line-height:38px}"]}),i})();function ke(i,n){1&i&&e._UZ(0,"mat-spinner",5)}function Ie(i,n){1&i&&(e.TgZ(0,"div",10),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"MODERATORS.LABEL_NO_RESULTS")," "))}function be(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",11)(1,"button",12),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).searchUpdates()}),e.TgZ(2,"mat-icon"),e._uU(3,"search"),e.qZA(),e._uU(4," Search for updates "),e.qZA()()}}function Ue(i,n){if(1&i&&(e.TgZ(0,"button",31)(1,"mat-icon"),e._uU(2,"casino"),e.qZA()()),2&i){const t=e.oxw().$implicit;e.MGl("routerLink","../../",t.slug,"")}}function ye(i,n){if(1&i&&(e.TgZ(0,"mat-card",32),e._UZ(1,"img",33),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(1),e.s9C("src",a.baseURL+t.img,e.LSH)}}function Me(i,n){if(1&i&&(e.TgZ(0,"div",18)(1,"app-arweave-address",19),e._uU(2,"Sponsor: "),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("address",t.sponsor)("isAddress",!1)}}function Se(i,n){1&i&&(e.TgZ(0,"div",34)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&i&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_TX_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_TX_PENDING")," "))}function Ee(i,n){if(1&i&&(e.TgZ(0,"div",18)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_HEIGHT"),": "),e.xp6(2),e.hij(" ",t.block.height," ")}}function Oe(i,n){if(1&i&&(e.TgZ(0,"div",18)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"date"),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_TIMESTAMP"),": "),e.xp6(2),e.hij(" ",e.xi3(5,4,a.timestampToDate(t.block.timestamp),"short")," ")}}function qe(i,n){1&i&&(e.TgZ(0,"strong",37),e._uU(1," - Reward unlocked! "),e.qZA())}function Ne(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2).$implicit,a=e.oxw(2);e.xp6(1),e.AsE(" - Reward unlocked in ",t.pageRewardAt-a.currentBlockHeight," blocks! (",a.formatBlocks(t.pageRewardAt-a.currentBlockHeight),") ")}}function De(i,n){if(1&i&&(e.TgZ(0,"div",18)(1,"strong"),e._uU(2,"Page reward at: "),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.qZA(),e.YNc(5,qe,2,0,"strong",35),e.YNc(6,Ne,2,2,"span",36),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(4),e.hij("",t.pageRewardAt," block"),e.xp6(1),e.Q6J("ngIf",a.currentBlockHeight>=t.pageRewardAt),e.xp6(1),e.Q6J("ngIf",a.currentBlockHeight<t.pageRewardAt)}}function Ye(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",38),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(2).confirmStopStake(o.slug)}),e.TgZ(1,"mat-icon"),e._uU(2,"delete"),e.qZA(),e._uU(3," Stop staking "),e.qZA()}}function Qe(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",13)(1,"mat-card"),e.YNc(2,Ue,3,1,"button",14),e.TgZ(3,"h2",15),e._uU(4),e.qZA(),e.YNc(5,ye,2,1,"mat-card",16),e.TgZ(6,"div"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"div"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"div"),e._uU(16),e.qZA(),e._UZ(17,"hr",17),e.TgZ(18,"div",18)(19,"app-arweave-address",19),e._uU(20),e.ALo(21,"translate"),e.qZA()(),e.TgZ(22,"div",18)(23,"app-arweave-address",20),e._uU(24),e.ALo(25,"translate"),e.qZA()(),e.YNc(26,Me,3,2,"div",21),e.YNc(27,Se,6,6,"div",22),e.YNc(28,Ee,5,4,"div",21),e.YNc(29,Oe,6,7,"div",21),e.YNc(30,De,7,3,"div",21),e.TgZ(31,"div",23),e.YNc(32,Ye,4,0,"a",24),e.TgZ(33,"a",25),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).confirmSponsorArWikiPage(r.slug,r.category,r.value)}),e.TgZ(34,"mat-icon"),e._uU(35,"casino"),e.qZA(),e._uU(36," Sponsor page "),e.qZA(),e.TgZ(37,"a",26),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).confirmSetMainArWikiPage(r.slug,r.id,r.category)}),e.TgZ(38,"mat-icon",27),e._uU(39,"star"),e.qZA(),e._uU(40," Set as Main Page "),e.qZA(),e.TgZ(41,"a",28)(42,"mat-icon"),e._uU(43,"archive"),e.qZA(),e._uU(44," Page updates "),e.qZA(),e.TgZ(45,"a",29)(46,"mat-icon"),e._uU(47,"sell"),e.qZA(),e._uU(48," Tags "),e.qZA(),e.TgZ(49,"a",30)(50,"mat-icon"),e._uU(51,"visibility"),e.qZA(),e._uU(52," View "),e.qZA()()()()}if(2&i){const t=n.$implicit,a=e.oxw(2);e.xp6(2),e.Q6J("ngIf",t.sponsor===a.myAddress),e.xp6(1),e.MGl("routerLink","../../",t.slug,""),e.xp6(1),e.hij(" ",t.title," "),e.xp6(1),e.Q6J("ngIf",t.img),e.xp6(2),e.AsE(" ",e.lcZ(8,25,"PAGE.LABEL_SLUG"),": ",t.slug," "),e.xp6(3),e.AsE(" ",e.lcZ(11,27,"PAGE.LABEL_CATEGORY"),": ",t.category," "),e.xp6(3),e.AsE(" ",e.lcZ(14,29,"PAGE.LABEL_LANGUAGE"),": ",t.language," "),e.xp6(3),e.hij(" Page value: ",t.value," $WIKI "),e.xp6(3),e.Q6J("address",t.id)("isAddress",!1),e.xp6(1),e.hij("",e.lcZ(21,31,"PAGE.LABEL_ID"),": "),e.xp6(3),e.Q6J("address",t.owner),e.xp6(1),e.hij("",e.lcZ(25,33,"PAGE.LABEL_OWNER"),": "),e.xp6(2),e.Q6J("ngIf",t.sponsor),e.xp6(1),e.Q6J("ngIf",!t.block||!t.block.height),e.xp6(1),e.Q6J("ngIf",t.block&&t.block.height),e.xp6(1),e.Q6J("ngIf",t.block&&t.block.timestamp),e.xp6(1),e.Q6J("ngIf",t.pageRewardAt),e.xp6(2),e.Q6J("ngIf",t.sponsor===a.myAddress),e.xp6(9),e.MGl("routerLink","../page-updates/",t.slug,""),e.xp6(4),e.MGl("routerLink","../tag-manager/",t.slug,""),e.xp6(4),e.MGl("routerLink","../../",t.slug,"")}}function je(i,n){if(1&i&&(e.TgZ(0,"div",6),e.YNc(1,Ie,3,3,"div",7),e.YNc(2,be,5,0,"div",8),e.YNc(3,Qe,53,35,"div",9),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(t.loadingApprovedPages||t.pages&&t.pages.length)),e.xp6(1),e.Q6J("ngIf",t.pages&&t.pages.length),e.xp6(1),e.Q6J("ngForOf",t.pages)}}function Re(i,n){1&i&&(e.TgZ(0,"div",39)(1,"div",40),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",41),e._uU(4,"\u{1f680} Hold on! Your transaction is processing ..."),e.qZA()()())}function Ge(i,n){if(1&i&&(e.TgZ(0,"div",39)(1,"div",40)(2,"h1",41),e._uU(3,"\u{1f4a5} Page successfully unlisted!"),e.qZA(),e.TgZ(4,"p",41),e._uU(5),e.qZA(),e.TgZ(6,"a",42),e._uU(7),e.qZA()()()),2&i){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.deleteTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.deleteTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.deleteTxMessage," ")}}function Je(i,n){1&i&&(e.TgZ(0,"div",39)(1,"div",40),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",41),e._uU(4,"\u{1f680} Hold on! Your transaction is processing ..."),e.qZA()()())}function Be(i,n){if(1&i&&(e.TgZ(0,"div",39)(1,"div",40)(2,"h1",41),e._uU(3,"\u{1f973} Page successfully set as Main Page!"),e.qZA(),e.TgZ(4,"p",41),e._uU(5),e.qZA(),e.TgZ(6,"a",42),e._uU(7),e.qZA()()()),2&i){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.setMainTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.setMainTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.setMainTxMessage," ")}}function $e(i,n){1&i&&(e.TgZ(0,"div",39)(1,"div",40),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",41),e._uU(4,"\u{1f680} Hold on! Your transaction is processing ..."),e.qZA()()())}function He(i,n){if(1&i&&(e.TgZ(0,"div",39)(1,"div",40)(2,"h1",41),e._uU(3,"\u{1f4a5} Sponsorship successfully stopped!"),e.qZA(),e.TgZ(4,"p",41),e._uU(5),e.qZA(),e.TgZ(6,"a",42),e._uU(7),e.qZA()()()),2&i){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.stopStakeTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.stopStakeTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.stopStakeTxMessage," ")}}function Ke(i,n){1&i&&(e.TgZ(0,"div",39)(1,"div",40),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",41),e._uU(4,"\u{1f680} Hold on! Your transaction is processing ..."),e.qZA()()())}function Fe(i,n){if(1&i&&(e.TgZ(0,"div",39)(1,"div",40)(2,"h1",41),e._uU(3,"\u{1f973} Page successfully updated!"),e.qZA(),e.TgZ(4,"p",41),e._uU(5),e.qZA(),e.TgZ(6,"a",42),e._uU(7),e.qZA()()()),2&i){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.updateSponsorPageTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.updateSponsorPageTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.updateSponsorPageTxMessage," ")}}function Xe(i,n){if(1&i&&(e.TgZ(0,"div",39)(1,"div",40)(2,"h1",41),e._uU(3,"Oops! something went wrong"),e.qZA(),e.TgZ(4,"p",41),e._uU(5),e.qZA()()()),2&i){const t=e.oxw();e.xp6(5),e.Oqu(t.updateSponsorPageTxErrorMessage)}}let We=(()=>{class i{constructor(t,a,o,r,s,d,c){this._arweave=t,this._auth=a,this._snackBar=o,this._dialog=r,this._route=s,this._userSettings=d,this._arwikiToken=c,this.loadingApprovedPages=!1,this.pages=[],this.approvedPagesSubscription=Z.w.EMPTY,this.routeLang="",this.loadingDeletePage=!1,this.deleteTxMessage="",this.stopStakeTxMessage="",this.loadingStopStake=!1,this.loadingSetMainPage=!1,this.setMainTxMessage="",this.myAddress="",this.currentBlockHeight=0,this.heightSubscription=Z.w.EMPTY,this.baseURL=this._arweave.baseURL,this.updateSponsorPageTxMessage="",this.updateSponsorPageTxErrorMessage="",this.loadingUpdateSponsorPageIntoIndex=!1,this.loadingPendingUpdates=!1}ngOnInit(){return(0,f.mG)(this,void 0,void 0,function*(){this.myAddress=this._auth.getMainAddressSnapshot(),this._auth.getAdminList(),this.routeLang=this._route.snapshot.paramMap.get("lang"),this._arwiki=new L.i(this._arweave.arweave),this.arwikiQuery=new O.x(this._arweave.arweave),this.loadingApprovedPages=!0;let o,r=0;try{o=yield this._arweave.arweave.network.getInfo(),r=o.height}catch(g){return void this.message(`${g}`,"error")}this._auth.getAdminList();let d=[],c={};this.approvedPagesSubscription=this._arwikiToken.getCategories().pipe((0,_.w)(g=>this._arwikiToken.getApprovedPages(this.routeLang,-1,!0)),(0,_.w)(g=>(c=g,d=Object.keys(g).map(p=>g[p].content),this.arwikiQuery.getTXsData(d))),(0,_.w)(g=>{let p=[];for(let l of g){const h=new b.default(l,this._arweave.arweave),U=this.arwikiQuery.searchKeyNameInTags(h.tags,"Arwiki-Page-Slug");p.push({id:h.id,title:this.arwikiQuery.searchKeyNameInTags(h.tags,"Arwiki-Page-Title"),slug:U,category:this.arwikiQuery.searchKeyNameInTags(h.tags,"Arwiki-Page-Category"),language:this.arwikiQuery.searchKeyNameInTags(h.tags,"Arwiki-Page-Lang"),value:c[U].value,img:this.arwikiQuery.searchKeyNameInTags(h.tags,"Arwiki-Page-Img"),owner:h.owner.address,block:h.block,start:c[U].start,sponsor:c[U].sponsor,pageRewardAt:c[U].pageRewardAt})}return(0,x.of)(p)})).subscribe({next:g=>(0,f.mG)(this,void 0,void 0,function*(){this.pages=g,this.loadingApprovedPages=!1}),error:g=>{this.message(g,"error"),this.loadingApprovedPages=!1}}),this.heightSubscription=(0,D.D)(this.getCurrentHeight()).subscribe({next:g=>{this.currentBlockHeight=g},error:g=>{this.message(g,"error")}})})}message(t,a="",o){this._snackBar.open(t,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:o,panelClass:a})}ngOnDestroy(){this.approvedPagesSubscription&&this.approvedPagesSubscription.unsubscribe()}underscoreToSpace(t){return t.replace(/[_]/gi," ")}timestampToDate(t){return new Date(1e3*t)}confirmDeleteArWikiPage(t,a,o){let s="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(G.p,{data:{title:"Are you sure?",content:"You are about to unlist (hide) an arwiki page from the index. Do you want to proceed?"},direction:s}).afterClosed().subscribe(c=>(0,f.mG)(this,void 0,void 0,function*(){if(c){this.loadingDeletePage=!0;try{const g=yield this._arwiki.createDeleteTXForArwikiPage(a,t,o,this.routeLang,this._auth.getPrivateKey());this.deleteTxMessage=g,this.message("Success!","success")}catch(g){this.message(`${g}`,"error")}}}))}confirmSetMainArWikiPage(t,a,o){let s="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(G.p,{data:{title:"Are you sure?",content:`You are about to set ${t} as the main page. Do you want to proceed?`},direction:s}).afterClosed().subscribe(c=>(0,f.mG)(this,void 0,void 0,function*(){if(c){this.loadingSetMainPage=!0;try{const g=yield this._arwiki.createMainPageTXForArwikiPage(a,t,o,this.routeLang,this._auth.getPrivateKey());this.setMainTxMessage=g,this.message("Success!","success")}catch(g){this.message(`${g}`,"error")}}}))}getCurrentHeight(){return(0,f.mG)(this,void 0,void 0,function*(){let t={},a=0;try{t=yield this._arweave.arweave.network.getInfo(),a=t.height?t.height:0}catch(o){throw Error(`${o}`)}return a})}confirmStopStake(t){let o="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(G.p,{data:{title:"Are you sure?",content:"You are about to stop your stake and sponsorship for this page. This will unlist the page. Do you want to proceed?"},direction:o}).afterClosed().pipe((0,_.w)(s=>s?(this.loadingStopStake=!0,this._arwikiToken.stopStaking(t,this.routeLang,this._auth.getPrivateKey(),L.y[0])):(0,x.of)(null))).subscribe({next:s=>{s&&(this.stopStakeTxMessage=`${s}`,this.message("Success!","success"))},error:s=>{this.message(`${s}`,"error")}})}formatBlocks(t){return`${this._arweave.formatBlocks(t)}`}confirmSponsorArWikiPage(t,a,o){let s="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(Y.f,{data:{title:"Are you sure?",content:"You are about to be the new sponsor for this arwiki page. Do you want to proceed?",pageValue:o+1,second_content:"Please define the amount of $WIKI tokens to stake:"},direction:s}).afterClosed().pipe((0,_.w)(c=>{const g=+c;if(Number.isInteger(g)&&g>0)return this.loadingUpdateSponsorPageIntoIndex=!0,this._arwikiToken.updatePageSponsor(t,a,this.routeLang,g,this._auth.getPrivateKey(),L.y[0]);if(0===g)throw Error("Stake must be greater than 0 $WIKI tokens");return(0,x.of)(null)})).subscribe({next:c=>{c&&(this.updateSponsorPageTxMessage=`${c}`,this.message("Success!","success"))},error:c=>{this.updateSponsorPageTxErrorMessage=`${c}`,this.message(`${c}`,"error")}})}searchUpdates(){const t=this._userSettings.getDefaultLang();this._dialog.open(Ce,{data:{langCode:t.code},direction:"LTR"===t.writing_system?"ltr":"rtl",disableClose:!0}).afterClosed().subscribe(r=>(0,f.mG)(this,void 0,void 0,function*(){}))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(C.N),e.Y36(y.e),e.Y36(I.ux),e.Y36(v.uw),e.Y36(T.gz),e.Y36(E.s),e.Y36(k.d))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ng-component"]],decls:13,vars:11,consts:[["title","Approved list"],["class","spinner-center",4,"ngIf"],[1,"container","page-container","fadeIn"],["class","row",4,"ngIf"],["class","row fadeIn",4,"ngIf"],[1,"spinner-center"],[1,"row"],["class","col-12 card-page fadeIn",4,"ngIf"],["class","col-12 text-right sec-toolbar",4,"ngIf"],["class","col-12 col-md-6 card-page fadeIn",4,"ngFor","ngForOf"],[1,"col-12","card-page","fadeIn"],[1,"col-12","text-right","sec-toolbar"],["mat-button","","color","primary","matTooltip","Search for updates",1,"btn-toolbar2",3,"click"],[1,"col-12","col-md-6","card-page","fadeIn"],["mat-icon-button","","class","card-header-icon green","matTooltip","You are the sponsor!","aria-label","You are the sponsor!",3,"routerLink",4,"ngIf"],[1,"link","ellipsis","card-header-title",3,"routerLink"],["class","card-image text-center",4,"ngIf"],[1,"mbt20"],[1,"mini-text"],[3,"address","isAddress"],[3,"address"],["class","mini-text",4,"ngIf"],["class","red mini-text",4,"ngIf"],[1,"text-right","mt20","card-footer"],["mat-flat-button","","color","warn","matTooltip","Stop staking",3,"click",4,"ngIf"],["mat-flat-button","","color","primary","matTooltip","Sponsor page",3,"click"],["mat-flat-button","","color","primary","matTooltip","Set as Main Page",3,"click"],[1,"yellow"],["mat-flat-button","","color","primary","matTooltip","Page updates",3,"routerLink"],["mat-flat-button","","color","primary","matTooltip","Add tags",3,"routerLink"],["mat-flat-button","","color","primary","matTooltip","View",3,"routerLink"],["mat-icon-button","","matTooltip","You are the sponsor!","aria-label","You are the sponsor!",1,"card-header-icon","green",3,"routerLink"],[1,"card-image","text-center"],[3,"src"],[1,"red","mini-text"],["class","green",4,"ngIf"],[4,"ngIf"],[1,"green"],["mat-flat-button","","color","warn","matTooltip","Stop staking",3,"click"],[1,"row","fadeIn"],[1,"col","text-center"],[1,"text-center"],["mat-button","","target","_blank",1,"text-center",3,"href"]],template:function(t,a){1&t&&(e._UZ(0,"app-moderators-menu",0),e.YNc(1,ke,1,0,"mat-spinner",1),e.TgZ(2,"div",2),e.YNc(3,je,4,3,"div",3),e.YNc(4,Re,5,0,"div",4),e.YNc(5,Ge,8,3,"div",4),e.YNc(6,Je,5,0,"div",4),e.YNc(7,Be,8,3,"div",4),e.YNc(8,$e,5,0,"div",4),e.YNc(9,He,8,3,"div",4),e.YNc(10,Ke,5,0,"div",4),e.YNc(11,Fe,8,3,"div",4),e.YNc(12,Xe,6,1,"div",4),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",a.loadingApprovedPages),e.xp6(2),e.Q6J("ngIf",!(a.loadingDeletePage||a.loadingSetMainPage||a.loadingStopStake||a.loadingUpdateSponsorPageIntoIndex)),e.xp6(1),e.Q6J("ngIf",a.loadingDeletePage&&!a.deleteTxMessage),e.xp6(1),e.Q6J("ngIf",a.deleteTxMessage),e.xp6(1),e.Q6J("ngIf",a.loadingSetMainPage&&!a.setMainTxMessage),e.xp6(1),e.Q6J("ngIf",a.setMainTxMessage),e.xp6(1),e.Q6J("ngIf",a.loadingStopStake&&!a.stopStakeTxMessage),e.xp6(1),e.Q6J("ngIf",a.stopStakeTxMessage),e.xp6(1),e.Q6J("ngIf",a.loadingUpdateSponsorPageIntoIndex&&!a.updateSponsorPageTxMessage&&!a.updateSponsorPageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",a.updateSponsorPageTxMessage),e.xp6(1),e.Q6J("ngIf",a.updateSponsorPageTxErrorMessage))},directives:[S,m.O5,N.Ou,w.lW,R.gM,P.Hw,m.sg,Q.a8,T.rH,j.N,w.zs,T.yS],pipes:[q.X$,m.uU],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}.w70[_ngcontent-%COMP%]{width:70%}.ml10[_ngcontent-%COMP%]{margin-left:10px}.w100[_ngcontent-%COMP%]{width:100%}.w50[_ngcontent-%COMP%]{width:50%}.card-page[_ngcontent-%COMP%]{margin-bottom:40px}.mt20[_ngcontent-%COMP%]{margin-top:20px}.link[_ngcontent-%COMP%]{cursor:pointer}.mbt20[_ngcontent-%COMP%]{margin-bottom:20px;margin-top:20px}.card-footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:10px}.card-header-icon[_ngcontent-%COMP%]{float:right}.card-header-title[_ngcontent-%COMP%]{margin-top:0}.card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.approve-btn[_ngcontent-%COMP%]{background-color:#63c642;color:#fff}.sec-toolbar[_ngcontent-%COMP%]{margin-bottom:20px}.btn-toolbar2[_ngcontent-%COMP%]{color:inherit}"]}),i})();function Ve(i,n){1&i&&e._UZ(0,"mat-spinner",4)}function ze(i,n){1&i&&(e.TgZ(0,"div",8),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"MODERATORS.LABEL_NO_RESULTS")," "))}function et(i,n){if(1&i&&(e.TgZ(0,"div",12)(1,"app-arweave-address",13),e._uU(2,"Sponsor: "),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("address",t.sponsor)("isAddress",!1)}}function tt(i,n){1&i&&(e.TgZ(0,"div",20)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&i&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_TX_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_TX_PENDING")," "))}function it(i,n){if(1&i&&(e.TgZ(0,"div",12)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_HEIGHT"),": "),e.xp6(2),e.hij(" ",t.block.height," ")}}function at(i,n){if(1&i&&(e.TgZ(0,"div",12)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"date"),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_TIMESTAMP"),": "),e.xp6(2),e.hij(" ",e.xi3(5,4,a.timestampToDate(t.block.timestamp),"short")," ")}}function nt(i,n){1&i&&(e.TgZ(0,"strong",23),e._uU(1," - Reward unlocked! "),e.qZA())}function st(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2).$implicit,a=e.oxw(2);e.xp6(1),e.hij(" - Reward unlocked in ",t.pageRewardAt-a.currentBlockHeight," blocks! ")}}function ot(i,n){if(1&i&&(e.TgZ(0,"div",12)(1,"strong"),e._uU(2,"Page reward at: "),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.qZA(),e.YNc(5,nt,2,0,"strong",21),e.YNc(6,st,2,1,"span",22),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(4),e.hij("",t.pageRewardAt," block"),e.xp6(1),e.Q6J("ngIf",a.currentBlockHeight>=t.pageRewardAt),e.xp6(1),e.Q6J("ngIf",a.currentBlockHeight<t.pageRewardAt)}}function rt(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",9)(1,"mat-card")(2,"h2",10),e._uU(3),e.qZA(),e.TgZ(4,"div"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"div"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"div"),e._uU(14),e.qZA(),e._UZ(15,"hr",11),e.TgZ(16,"div",12)(17,"app-arweave-address",13),e._uU(18),e.ALo(19,"translate"),e.qZA()(),e.TgZ(20,"div",12)(21,"app-arweave-address",14),e._uU(22),e.ALo(23,"translate"),e.qZA()(),e.YNc(24,et,3,2,"div",15),e.YNc(25,tt,6,6,"div",16),e.YNc(26,it,5,4,"div",15),e.YNc(27,at,6,7,"div",15),e.YNc(28,ot,7,3,"div",15),e.TgZ(29,"div",17)(30,"a",18),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).confirmReactivateArWikiPage(r.slug,r.category,r.value)}),e.TgZ(31,"mat-icon"),e._uU(32,"done"),e.qZA(),e._uU(33," Reactivate and sponsor page "),e.qZA(),e._uU(34," \xa0 "),e.TgZ(35,"a",19)(36,"mat-icon"),e._uU(37,"visibility"),e.qZA(),e._uU(38," Preview "),e.qZA()()()()}if(2&i){const t=n.$implicit;e.xp6(2),e.MGl("routerLink","../../preview/",t.id,""),e.xp6(1),e.hij(" ",t.title," "),e.xp6(2),e.AsE(" ",e.lcZ(6,20,"PAGE.LABEL_SLUG"),": ",t.slug," "),e.xp6(3),e.AsE(" ",e.lcZ(9,22,"PAGE.LABEL_CATEGORY"),": ",t.category," "),e.xp6(3),e.AsE(" ",e.lcZ(12,24,"PAGE.LABEL_LANGUAGE"),": ",t.language," "),e.xp6(3),e.hij(" Page value: ",t.value," $WIKI "),e.xp6(3),e.Q6J("address",t.id)("isAddress",!1),e.xp6(1),e.hij("",e.lcZ(19,26,"PAGE.LABEL_ID"),": "),e.xp6(3),e.Q6J("address",t.owner),e.xp6(1),e.hij("",e.lcZ(23,28,"PAGE.LABEL_OWNER"),": "),e.xp6(2),e.Q6J("ngIf",t.sponsor),e.xp6(1),e.Q6J("ngIf",!t.block||!t.block.height),e.xp6(1),e.Q6J("ngIf",t.block&&t.block.height),e.xp6(1),e.Q6J("ngIf",t.block&&t.block.timestamp),e.xp6(1),e.Q6J("ngIf",t.pageRewardAt),e.xp6(7),e.MGl("routerLink","../../preview/",t.id,"")}}function gt(i,n){if(1&i&&(e.TgZ(0,"div",5),e.YNc(1,ze,3,3,"div",6),e.YNc(2,rt,39,30,"div",7),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(t.loadingPages||t.pages&&t.pages.length)),e.xp6(1),e.Q6J("ngForOf",t.pages)}}function ct(i,n){1&i&&(e.TgZ(0,"div",5)(1,"div",24),e._UZ(2,"mat-spinner",4),e.TgZ(3,"h1",25),e._uU(4,"\u{1f680} Hold on! Your transaction is processing ..."),e.qZA()()())}function dt(i,n){if(1&i&&(e.TgZ(0,"div",5)(1,"div",24)(2,"h1",25),e._uU(3,"\u{1f973} Page successfully updated!"),e.qZA(),e.TgZ(4,"p",25),e._uU(5),e.qZA(),e.TgZ(6,"a",26),e._uU(7),e.qZA()()()),2&i){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.updatePageTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.updatePageTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.updatePageTxMessage," ")}}function pt(i,n){if(1&i&&(e.TgZ(0,"div",5)(1,"div",24)(2,"h1",25),e._uU(3,"Oops! something went wrong"),e.qZA(),e.TgZ(4,"p",25),e._uU(5),e.qZA()()()),2&i){const t=e.oxw();e.xp6(5),e.Oqu(t.updatePageTxErrorMessage)}}let lt=(()=>{class i{constructor(t,a,o,r,s,d,c){this._arweave=t,this._auth=a,this._snackBar=o,this._dialog=r,this._route=s,this._userSettings=d,this._arwikiToken=c,this.loadingPages=!1,this.pages=[],this.pagesSubscription=Z.w.EMPTY,this.routeLang="",this.myAddress="",this.currentBlockHeight=0,this.heightSubscription=Z.w.EMPTY,this.loadingReactivatePageIntoIndex=!1,this.updatePageTxMessage="",this.updatePageTxErrorMessage=""}ngOnInit(){return(0,f.mG)(this,void 0,void 0,function*(){this.myAddress=this._auth.getMainAddressSnapshot(),this._auth.getAdminList(),this.routeLang=this._route.snapshot.paramMap.get("lang"),this._arwiki=new L.i(this._arweave.arweave),this.arwikiQuery=new O.x(this._arweave.arweave),this.loadingPages=!0;let o,r=0;try{o=yield this._arweave.arweave.network.getInfo(),r=o.height}catch(s){return void this.message(`${s}`,"error")}this.pagesSubscription=this.getDeletedPages(100,r).subscribe({next:s=>(0,f.mG)(this,void 0,void 0,function*(){this.pages=s,this.loadingPages=!1}),error:s=>{this.message(s,"error"),this.loadingPages=!1}}),this.heightSubscription=(0,D.D)(this.getCurrentHeight()).subscribe({next:s=>{this.currentBlockHeight=s},error:s=>{this.message(s,"error")}})})}message(t,a="",o){this._snackBar.open(t,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:o,panelClass:a})}ngOnDestroy(){this.pagesSubscription&&this.pagesSubscription.unsubscribe()}underscoreToSpace(t){return t.replace(/[_]/gi," ")}timestampToDate(t){return new Date(1e3*t)}getCurrentHeight(){return(0,f.mG)(this,void 0,void 0,function*(){let t={},a=0;try{t=yield this._arweave.arweave.network.getInfo(),a=t.height?t.height:0}catch(o){throw Error(`${o}`)}return a})}getDeletedPages(t,a){const o=this._auth.getAdminList();let r=[],s={},d=[];return this._arwikiToken.getCategories().pipe((0,_.w)(c=>this._arwikiToken.getAllPages(this.routeLang,-1)),(0,_.w)(c=>(s=c,r=Object.keys(s).map(g=>s[g].content),d=Object.keys(s).filter(g=>!s[g].active).map(g=>s[g].content),this.arwikiQuery.getAllDeletedPages(o,this.routeLang,t,a))),(0,_.w)(c=>{const g={};for(const l of c){const h=new b.default(l,this._arweave.arweave),U=this.arwikiQuery.searchKeyNameInTags(h.tags,"Arwiki-Page-Id");g[U]=!0}let p=r.filter(l=>g[l]);return p=p.concat(d),this.arwikiQuery.getTXsData(p)}),(0,_.w)(c=>{let g=[];for(let p of c){const l=new b.default(p,this._arweave.arweave),h=this.arwikiQuery.searchKeyNameInTags(l.tags,"Arwiki-Page-Slug");g.push({id:l.id,title:this.arwikiQuery.searchKeyNameInTags(l.tags,"Arwiki-Page-Title"),slug:h,category:this.arwikiQuery.searchKeyNameInTags(l.tags,"Arwiki-Page-Category"),language:this.arwikiQuery.searchKeyNameInTags(l.tags,"Arwiki-Page-Lang"),value:s[h].value,owner:l.owner.address,block:l.block,start:s[h].start,sponsor:s[h].sponsor,pageRewardAt:s[h].pageRewardAt})}return(0,x.of)(g)}))}confirmReactivateArWikiPage(t,a,o){let s="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(Y.f,{data:{title:"Are you sure?",content:"You are about to reactivate an old arwiki page. Do you want to proceed?",pageValue:o+1,second_content:"Please define the amount of $WIKI tokens to stake:"},direction:s}).afterClosed().pipe((0,_.w)(c=>{const g=+c;if(Number.isInteger(g)&&g>0)return this.loadingReactivatePageIntoIndex=!0,this._arwikiToken.updatePageSponsor(t,a,this.routeLang,g,this._auth.getPrivateKey(),L.y[0]);if(0===g)throw Error("Stake must be greater than 0 $WIKI tokens");return(0,x.of)(null)})).subscribe({next:c=>{c&&(this.updatePageTxMessage=`${c}`,this.message("Success!","success"))},error:c=>{this.updatePageTxErrorMessage=`${c}`,this.message(`${c}`,"error")}})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(C.N),e.Y36(y.e),e.Y36(I.ux),e.Y36(v.uw),e.Y36(T.gz),e.Y36(E.s),e.Y36(k.d))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-deleted-list"]],decls:7,vars:5,consts:[["title","Deleted pages"],["class","spinner-center",4,"ngIf"],[1,"container","page-container"],["class","row fadeIn",4,"ngIf"],[1,"spinner-center"],[1,"row","fadeIn"],["class","col-12 card-page fadeIn",4,"ngIf"],["class","col-12 col-md-6 card-page fadeIn",4,"ngFor","ngForOf"],[1,"col-12","card-page","fadeIn"],[1,"col-12","col-md-6","card-page","fadeIn"],[1,"link","ellipsis","card-header-title",3,"routerLink"],[1,"mbt20"],[1,"mini-text"],[3,"address","isAddress"],[3,"address"],["class","mini-text",4,"ngIf"],["class","red mini-text",4,"ngIf"],[1,"text-right","mt20","card-footer"],["mat-flat-button","","matTooltip","Reactivate and sponsor page",1,"approve-btn",3,"click"],["mat-flat-button","","color","primary","matTooltip","View",3,"routerLink"],[1,"red","mini-text"],["class","green",4,"ngIf"],[4,"ngIf"],[1,"green"],[1,"col","text-center"],[1,"text-center"],["mat-button","","target","_blank",1,"text-center",3,"href"]],template:function(t,a){1&t&&(e._UZ(0,"app-moderators-menu",0),e.YNc(1,Ve,1,0,"mat-spinner",1),e.TgZ(2,"div",2),e.YNc(3,gt,3,2,"div",3),e.YNc(4,ct,5,0,"div",3),e.YNc(5,dt,8,3,"div",3),e.YNc(6,pt,6,1,"div",3),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",a.loadingPages),e.xp6(2),e.Q6J("ngIf",!a.loadingReactivatePageIntoIndex),e.xp6(1),e.Q6J("ngIf",a.loadingReactivatePageIntoIndex&&!a.updatePageTxMessage&&!a.updatePageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",a.updatePageTxMessage),e.xp6(1),e.Q6J("ngIf",a.updatePageTxErrorMessage))},directives:[S,m.O5,N.Ou,m.sg,Q.a8,T.rH,j.N,w.zs,R.gM,P.Hw,T.yS],pipes:[q.X$,m.uU],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}.w70[_ngcontent-%COMP%]{width:70%}.ml10[_ngcontent-%COMP%]{margin-left:10px}.w100[_ngcontent-%COMP%]{width:100%}.w50[_ngcontent-%COMP%]{width:50%}.card-page[_ngcontent-%COMP%]{margin-bottom:40px}.mt20[_ngcontent-%COMP%]{margin-top:20px}.link[_ngcontent-%COMP%]{cursor:pointer}.mbt20[_ngcontent-%COMP%]{margin-bottom:20px;margin-top:20px}.card-footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:5px;margin-bottom:10px}.card-header-icon[_ngcontent-%COMP%]{float:right}.card-header-title[_ngcontent-%COMP%]{margin-top:0}.approve-btn[_ngcontent-%COMP%]{background-color:#63c642;color:#fff}"]}),i})();var K=u(91159),J=u(26688);function ut(i,n){1&i&&e._UZ(0,"mat-spinner",4)}function _t(i,n){if(1&i&&(e.TgZ(0,"mat-chip",11),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.hij(" ",t," ")}}function mt(i,n){1&i&&(e.TgZ(0,"mat-icon",25),e._uU(1,"cancel"),e.qZA())}function ht(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"mat-chip",23),e.NdJ("removed",function(){const r=e.CHM(t).$implicit;return e.oxw(3).remove(r)}),e._uU(1),e.YNc(2,mt,2,0,"mat-icon",24),e.qZA()}if(2&i){const t=n.$implicit,a=e.oxw(3);e.Q6J("selectable",a.selectable)("removable",a.removable),e.xp6(1),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",a.removable)}}function ft(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",12)(1,"h3",13),e._uU(2,"Create tags:"),e.qZA(),e.TgZ(3,"form",14),e.NdJ("ngSubmit",function(){return e.CHM(t),e.oxw(2).onSubmit()}),e.TgZ(4,"mat-form-field",15)(5,"mat-label"),e._uU(6,"Tags"),e.qZA(),e.TgZ(7,"mat-chip-list",16,17),e.YNc(9,ht,3,4,"mat-chip",18),e.TgZ(10,"input",19),e.NdJ("matChipInputTokenEnd",function(o){return e.CHM(t),e.oxw(2).add(o)}),e.qZA()(),e.TgZ(11,"mat-hint",20),e._uU(12,"Separate tags by comma"),e.qZA()(),e.TgZ(13,"div",21)(14,"button",22)(15,"mat-icon"),e._uU(16,"save"),e.qZA(),e._uU(17," Save "),e.qZA()()()()}if(2&i){const t=e.MAs(8),a=e.oxw(2);e.xp6(3),e.Q6J("formGroup",a.frmTags),e.xp6(6),e.Q6J("ngForOf",a.tags),e.xp6(1),e.Q6J("matChipInputFor",t)("matChipInputSeparatorKeyCodes",a.separatorKeysCodes)("matChipInputAddOnBlur",a.addOnBlur),e.xp6(4),e.Q6J("disabled",!a.tags.length||a.loadingSavingTags)}}function vt(i,n){1&i&&e._UZ(0,"mat-spinner",4)}function xt(i,n){if(1&i&&(e.TgZ(0,"div",12),e._uU(1),e.ALo(2,"json"),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.hij(" The following TX were created: ",e.lcZ(2,1,t.savingTagsTX)," ")}}function Tt(i,n){if(1&i&&(e.TgZ(0,"div",5)(1,"div",6)(2,"strong"),e._uU(3,"Title:"),e.qZA(),e._uU(4),e._UZ(5,"br"),e.TgZ(6,"strong"),e._uU(7,"Slug:"),e.qZA(),e.TgZ(8,"a",7)(9,"mat-icon"),e._uU(10,"visibility"),e.qZA(),e._uU(11),e.qZA(),e._UZ(12,"br"),e.TgZ(13,"strong"),e._uU(14,"Category"),e.qZA(),e._uU(15),e._UZ(16,"br"),e.TgZ(17,"strong"),e._uU(18,"Language:"),e.qZA(),e._uU(19),e.qZA(),e.TgZ(20,"div",6)(21,"strong"),e._uU(22,"Owner:"),e.qZA(),e._uU(23),e.qZA(),e.TgZ(24,"div",6)(25,"strong"),e._uU(26,"Current tags:"),e.qZA(),e.TgZ(27,"mat-chip-list",8),e.YNc(28,_t,2,1,"mat-chip",9),e.qZA()(),e.YNc(29,ft,18,6,"div",10),e.YNc(30,vt,1,0,"mat-spinner",1),e.YNc(31,xt,3,3,"div",10),e.qZA()),2&i){const t=e.oxw();e.xp6(4),e.hij(" ",t.page.title," "),e.xp6(4),e.MGl("routerLink","../../../",t.page.slug,""),e.xp6(3),e.hij(" ",t.page.slug," "),e.xp6(4),e.hij(": ",t.page.category," "),e.xp6(4),e.hij(" ",t.page.language," "),e.xp6(4),e.hij(" ",t.page.owner," "),e.xp6(5),e.Q6J("ngForOf",t.currentTags),e.xp6(1),e.Q6J("ngIf",!t.loadingSavingTags&&!t.savingTagsTX.length),e.xp6(1),e.Q6J("ngIf",t.loadingSavingTags),e.xp6(1),e.Q6J("ngIf",t.savingTagsTX.length)}}let At=(()=>{class i{constructor(t,a,o,r,s,d,c){this.route=t,this._arweave=a,this._snackBar=o,this._location=r,this._dialog=s,this._auth=d,this._arwikiToken=c,this.pageSubscription=Z.w.EMPTY,this.tagsSubscription=Z.w.EMPTY,this.loadingPage=!1,this.baseURL=this._arweave.baseURL,this.visible=!0,this.selectable=!0,this.removable=!0,this.addOnBlur=!0,this.separatorKeysCodes=[K.K5,K.OC],this.tags=[],this.currentTags=[],this.frmTags=new A.cw({newTags:new A.NI("")}),this.loadingSavingTags=!1,this.savingTagsTX=[],this.routeLang=""}get newTags(){return this.frmTags.get("tags")}ngOnInit(){return(0,f.mG)(this,void 0,void 0,function*(){this.routeLang=this.route.snapshot.paramMap.get("lang"),this._arwiki=new L.i(this._arweave.arweave);const t=this.route.snapshot.paramMap.get("slug");this.arwikiQuery=new O.x(this._arweave.arweave),this.loadPageTXData(t),yield this.loadTags(t)})}ngOnDestroy(){this.pageSubscription&&this.pageSubscription.unsubscribe(),this.tagsSubscription&&this.tagsSubscription.unsubscribe()}loadPageTXData(t){this.loadingPage=!0,this.pageSubscription=this._arwikiToken.getApprovedPages(this.routeLang).pipe((0,_.w)(a=>this.arwikiQuery.getTXsData([a&&a[t]?a[t].content:""]))).subscribe({next:a=>{if(a&&a.length){const r=new b.default(a[0],this._arweave.arweave);this.page={id:r.id,title:this.searchKeyNameInTags(r.tags,"Arwiki-Page-Title"),slug:this.searchKeyNameInTags(r.tags,"Arwiki-Page-Slug"),category:this.searchKeyNameInTags(r.tags,"Arwiki-Page-Category"),language:this.searchKeyNameInTags(r.tags,"Arwiki-Page-Lang"),img:this.searchKeyNameInTags(r.tags,"Arwiki-Page-Img"),owner:r.owner.address,block:r.block}}this.loadingPage=!1},error:a=>{this.message(a,"error"),this.loadingPage=!1}})}loadTags(t){return(0,f.mG)(this,void 0,void 0,function*(){let o,r=0;try{o=yield this._arweave.arweave.network.getInfo(),r=o.height}catch(s){return void this.message(`${s}`,"error")}this.tagsSubscription=this.arwikiQuery.getVerifiedTagsFromSlug(this._auth.getAdminList(),t,this.routeLang,100,r).subscribe({next:s=>{this.currentTags=[];for(let d of s){const c=new b.default(d,this._arweave.arweave);this.currentTags.push(this.searchKeyNameInTags(c.tags,"Arwiki-Page-Tag"))}},error:s=>{this.message(s,"error")}})})}message(t,a="",o){this._snackBar.open(t,"X",{duration:5e3,horizontalPosition:"center",verticalPosition:o,panelClass:a})}goBack(){this._location.back()}searchKeyNameInTags(t,a){for(const r of t)if(r.name.toUpperCase()===a.toUpperCase())return r.value;return""}add(t){const a=t.input,o=t.value;(o||"").trim()&&this.tags.push({name:o.trim()}),a&&(a.value="")}remove(t){const a=this.tags.indexOf(t);a>=0&&this.tags.splice(a,1)}onSubmit(){this.confirmSaveTags(this.tags,this.page.category,this.page.id,this.page.language,this.page.slug)}confirmSaveTags(t,a,o,r,s){const d=t.map(p=>p.name),c=`You are about to create the next tags: ${d.join()}. Do you want to proceed?`;this._dialog.open(G.p,{data:{title:"Are you sure?",content:c}}).afterClosed().subscribe(p=>(0,f.mG)(this,void 0,void 0,function*(){if(p){this.loadingSavingTags=!0;try{this.savingTagsTX=[];for(let l of d){const h=yield this._arwiki.createTagTXForArwikiPage(o,l,a,this.routeLang,s,this._auth.getPrivateKey());this.savingTagsTX.push(h)}this.message("Success!","success")}catch(l){this.message(`${l}`,"error")}this.loadingSavingTags=!1}}))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(T.gz),e.Y36(C.N),e.Y36(I.ux),e.Y36(m.Ye),e.Y36(v.uw),e.Y36(y.e),e.Y36(k.d))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ng-component"]],decls:4,vars:2,consts:[["title","Tag manager"],["class","spinner-center",4,"ngIf"],[1,"container","tagm-page-container"],["class","row",4,"ngIf"],[1,"spinner-center"],[1,"row"],[1,"col-12"],["mat-flat-button","",3,"routerLink"],["aria-label","Current tags"],["color","primary","selected","",4,"ngFor","ngForOf"],["class","col-12 text-center",4,"ngIf"],["color","primary","selected",""],[1,"col-12","text-center"],[1,"text-left"],[3,"formGroup","ngSubmit"],["id","tags-input-container",1,"w70"],["aria-label","Add tags",1,"tags-input"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["placeholder","Add tag...","formControlName","newTags",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["align","start"],[1,"text-center"],["mat-flat-button","","color","primary",3,"disabled"],[3,"selectable","removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""]],template:function(t,a){1&t&&(e._UZ(0,"app-moderators-menu",0),e.YNc(1,ut,1,0,"mat-spinner",1),e.TgZ(2,"div",2),e.YNc(3,Tt,32,10,"div",3),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",a.loadingPage),e.xp6(2),e.Q6J("ngIf",a.page&&!a.loadingPage))},directives:[S,m.O5,N.Ou,w.zs,T.yS,P.Hw,J.qn,m.sg,J.HS,A._Y,A.JL,A.sg,M.KE,M.hX,J.qH,A.Fj,J.oH,A.JJ,A.u,M.bx,w.lW],pipes:[m.Ts],styles:[".tagm-page-container[_ngcontent-%COMP%]{min-height:600px}.page-title[_ngcontent-%COMP%], .page-title-buttons[_ngcontent-%COMP%]{margin-top:50px;margin-bottom:50px}.page-img[_ngcontent-%COMP%]{max-width:100%}.w70[_ngcontent-%COMP%]{width:70%}.ml10[_ngcontent-%COMP%]{margin-left:10px}.w100[_ngcontent-%COMP%]{width:100%}"]}),i})();var wt=u(12671),Zt=u(85899);function Pt(i,n){1&i&&e._UZ(0,"mat-progress-bar",7)}function Lt(i,n){if(1&i&&(e.TgZ(0,"div",12)(1,"strong"),e._uU(2,"+ "),e.qZA(),e.TgZ(3,"strong"),e._uU(4),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(4),e.Oqu(t.value)}}function Ct(i,n){if(1&i&&(e.TgZ(0,"div",13)(1,"strong"),e._uU(2,"- "),e.qZA(),e._uU(3),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(3),e.hij(" ",t.value," ")}}function kt(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Lt,5,1,"div",10),e.YNc(2,Ct,4,1,"div",11),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf",t.added),e.xp6(1),e.Q6J("ngIf",t.removed)}}function It(i,n){if(1&i&&(e.TgZ(0,"div",8),e.YNc(1,kt,3,2,"div",9),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.listOfChanges)}}let bt=(()=>{class i{constructor(t,a,o,r){this.data=t,this._arweave=a,this._snackBar=o,this._arwikiToken=r,this.loading=!1,this.listOfChanges=[],this.listOfChangesSubscription=Z.w.EMPTY,this.txOld=""}ngOnInit(){this.loading=!0,this.listOfChangesSubscription=this.loadOldData(this.data.slug).pipe((0,_.w)(t=>(this.txOld=t,this.run_diff(this.txOld,this.data.newPage)))).subscribe({next:t=>{this.listOfChanges=t,this.loading=!1},error:t=>{this.message(`${t}`,"error"),this.loading=!1}})}ngOnDestroy(){}loadOldData(t){return this._arwikiToken.getPageId(this.data.lang,this.data.slug)}run_diff(t,a){let o;return(0,D.D)(this._arweave.getDataAsString(t)).pipe((0,_.w)(r=>(o=r,(0,D.D)(this._arweave.getDataAsString(a)))),(0,_.w)(r=>{const s=(0,wt.Mp)(o,r);return(0,x.of)(s)}))}message(t,a="",o){this._snackBar.open(t,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:o,panelClass:a})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(v.WI),e.Y36(C.N),e.Y36(I.ux),e.Y36(k.d))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-dialog-compare"]],decls:28,vars:6,consts:[["mat-dialog-title",""],[1,"blue","title-icon"],["color","primary","mode","indeterminate","class","fadeIn",4,"ngIf"],[1,"container","container-donate"],["class","changes-container",4,"ngIf"],["align","end"],["mat-button","","mat-dialog-close","","cdkFocusInitial",""],["color","primary","mode","indeterminate",1,"fadeIn"],[1,"changes-container"],[4,"ngFor","ngForOf"],["class","green",4,"ngIf"],["class","red",4,"ngIf"],[1,"green"],[1,"red"]],template:function(t,a){1&t&&(e.TgZ(0,"h2",0)(1,"mat-icon",1),e._uU(2,"difference"),e.qZA(),e.TgZ(3,"span"),e._uU(4,"Differences"),e.qZA()(),e.YNc(5,Pt,1,0,"mat-progress-bar",2),e.TgZ(6,"mat-dialog-content",3)(7,"strong"),e._uU(8,"Tx New Page ID:"),e.qZA(),e._uU(9),e._UZ(10,"br"),e.TgZ(11,"strong"),e._uU(12,"Tx Old Page ID:"),e.qZA(),e._uU(13),e._UZ(14,"br"),e.TgZ(15,"strong"),e._uU(16,"Slug:"),e.qZA(),e._uU(17),e.TgZ(18,"strong"),e._uU(19," Lang:"),e.qZA(),e._uU(20),e._UZ(21,"br"),e.TgZ(22,"h4"),e._uU(23,"List of differences:"),e.qZA(),e.YNc(24,It,2,1,"div",4),e.qZA(),e.TgZ(25,"mat-dialog-actions",5)(26,"button",6),e._uU(27,"Close"),e.qZA()()),2&t&&(e.xp6(5),e.Q6J("ngIf",a.loading),e.xp6(4),e.hij(" ",a.data.newPage,""),e.xp6(4),e.hij(" ",a.txOld,""),e.xp6(4),e.hij(" ",a.data.slug,""),e.xp6(3),e.hij(" ",a.data.lang,""),e.xp6(4),e.Q6J("ngIf",a.listOfChanges.length))},directives:[v.uh,P.Hw,m.O5,Zt.pW,v.xY,m.sg,v.H8,w.lW,v.ZT],styles:[".title-icon[_ngcontent-%COMP%]{font-size:40px;line-height:40px;width:40px;height:40px;vertical-align:middle}.mat-dialog-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:12px;vertical-align:middle;font-size:26px;font-family:Roboto Mono,monospace;line-height:38px}"]}),i})();function Ut(i,n){1&i&&e._UZ(0,"mat-spinner",5)}function yt(i,n){1&i&&(e.TgZ(0,"div",9),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"MODERATORS.LABEL_NO_RESULTS")," "))}function Mt(i,n){if(1&i&&(e.TgZ(0,"mat-card",25),e._UZ(1,"img",26),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(1),e.s9C("src",a.baseURL+a.pages[t].img,e.LSH)}}function St(i,n){1&i&&(e.TgZ(0,"div",27)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&i&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_TX_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_TX_PENDING")," "))}function Et(i,n){if(1&i&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_HEIGHT"),":"),e.xp6(2),e.hij(" ",a.pages[t].block.height," ")}}function Ot(i,n){if(1&i&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"date"),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_BLOCK_TIMESTAMP"),":"),e.xp6(2),e.hij(" ",e.xi3(5,4,a.timestampToDate(a.pages[t].block.timestamp),"short")," ")}}function qt(i,n){if(1&i&&(e.TgZ(0,"div",15)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_ARVERIFY_SCORE"),": "),e.xp6(2),e.hij(" ",a.arverifyProcessedAddressesMap[a.pages[t].owner].percentage," % ")}}function Nt(i,n){1&i&&(e.TgZ(0,"div",28)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"mat-icon"),e._uU(5,"verified_user"),e.qZA(),e._uU(6),e.ALo(7,"translate"),e.qZA()),2&i&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_OWNER_STATUS"),": "),e.xp6(4),e.hij(" ",e.lcZ(7,4,"PAGE.STATUS_ADDRESS_VERIFIED")," "))}function Dt(i,n){1&i&&(e.TgZ(0,"div",27)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&i&&(e.xp6(2),e.hij("",e.lcZ(3,2,"PAGE.LABEL_OWNER_STATUS"),": "),e.xp6(2),e.hij(" ",e.lcZ(5,4,"PAGE.STATUS_ADDRESS_NOTVERIFIED")," "))}function Yt(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",10)(1,"mat-card")(2,"h2",11),e._uU(3),e.qZA(),e.YNc(4,Mt,2,1,"mat-card",12),e.TgZ(5,"div"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"div"),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"div"),e._uU(15),e.qZA(),e._UZ(16,"hr",13),e.YNc(17,St,6,6,"div",14),e.TgZ(18,"div",15)(19,"app-arweave-address",16),e._uU(20),e.ALo(21,"translate"),e.qZA()(),e.TgZ(22,"div",15)(23,"app-arweave-address",17),e._uU(24),e.ALo(25,"translate"),e.qZA()(),e.YNc(26,Et,5,4,"div",18),e.YNc(27,Ot,6,7,"div",18),e.YNc(28,qt,5,4,"div",18),e.YNc(29,Nt,8,6,"div",19),e.YNc(30,Dt,6,6,"div",14),e.TgZ(31,"div",20)(32,"a",21),e.NdJ("click",function(){const r=e.CHM(t).$implicit,s=e.oxw(2);return s.confirmValidateArWikiPage(s.pages[r].slug,s.pages[r].id,s.pages[r].category,s.pages[r].value,s.pages[r].owner)}),e.TgZ(33,"mat-icon"),e._uU(34,"done"),e.qZA(),e._uU(35," Approve "),e.qZA(),e.TgZ(36,"a",22)(37,"mat-icon"),e._uU(38,"visibility"),e.qZA(),e._uU(39," Preview "),e.qZA(),e.TgZ(40,"a",23)(41,"mat-icon"),e._uU(42,"visibility"),e.qZA(),e._uU(43," Original "),e.qZA(),e.TgZ(44,"a",24),e.NdJ("click",function(){const r=e.CHM(t).$implicit,s=e.oxw(2);return s.compare(s.pages[r].id,s.pages[r].slug)}),e.TgZ(45,"mat-icon"),e._uU(46,"difference"),e.qZA(),e._uU(47," Differences "),e.qZA()()()()}if(2&i){const t=n.$implicit,a=e.oxw(2);e.xp6(2),e.MGl("routerLink","../../../preview/",a.pages[t].id,""),e.xp6(1),e.hij(" ",a.pages[t].title," "),e.xp6(1),e.Q6J("ngIf",a.pages[t].img),e.xp6(2),e.AsE(" ",e.lcZ(7,23,"PAGE.LABEL_SLUG"),": ",a.pages[t].slug," "),e.xp6(3),e.AsE(" ",e.lcZ(10,25,"PAGE.LABEL_CATEGORY"),": ",a.pages[t].category," "),e.xp6(3),e.AsE(" ",e.lcZ(13,27,"PAGE.LABEL_LANGUAGE"),": ",a.pages[t].language," "),e.xp6(3),e.hij(" Page value: ",a.pages[t].value," $WIKI "),e.xp6(2),e.Q6J("ngIf",!a.pages[t].block||!a.pages[t].block.height),e.xp6(2),e.Q6J("address",a.pages[t].id)("isAddress",!1),e.xp6(1),e.hij("",e.lcZ(21,29,"PAGE.LABEL_ID"),": "),e.xp6(3),e.Q6J("address",a.pages[t].owner),e.xp6(1),e.hij("",e.lcZ(25,31,"PAGE.LABEL_OWNER"),": "),e.xp6(2),e.Q6J("ngIf",a.pages[t].block&&a.pages[t].block.height),e.xp6(1),e.Q6J("ngIf",a.pages[t].block&&a.pages[t].block.timestamp),e.xp6(1),e.Q6J("ngIf",a.arverifyProcessedAddressesMap[a.pages[t].owner]&&a.arverifyProcessedAddressesMap[a.pages[t].owner].percentage),e.xp6(1),e.Q6J("ngIf",a.arverifyProcessedAddressesMap[a.pages[t].owner]&&a.arverifyProcessedAddressesMap[a.pages[t].owner].verified),e.xp6(1),e.Q6J("ngIf",!a.arverifyProcessedAddressesMap[a.pages[t].owner]||!a.arverifyProcessedAddressesMap[a.pages[t].owner].verified),e.xp6(6),e.MGl("routerLink","../../../preview/",a.pages[t].id,""),e.xp6(4),e.MGl("routerLink","../../../",a.pages[t].slug,"")}}function Qt(i,n){if(1&i&&(e.TgZ(0,"div",6),e.YNc(1,yt,3,3,"div",7),e.YNc(2,Yt,48,33,"div",8),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(t.loadingPendingPages||t.pages&&t.getKeys(t.pages).length)),e.xp6(1),e.Q6J("ngForOf",t.getKeys(t.pages))}}function jt(i,n){1&i&&(e.TgZ(0,"div",29)(1,"div",30),e._UZ(2,"mat-spinner",5),e.TgZ(3,"h1",31),e._uU(4,"\u{1f680} Hold on! We are almost there!"),e.qZA()()())}function Rt(i,n){if(1&i&&(e.TgZ(0,"div",29)(1,"div",30)(2,"h1",31),e._uU(3,"\u{1f973} Page successfully approved!"),e.qZA(),e.TgZ(4,"p",31),e._uU(5),e.qZA(),e.TgZ(6,"a",32),e._uU(7),e.qZA()()()),2&i){const t=e.oxw();e.xp6(5),e.hij("TxID: ",t.insertPageTxMessage,""),e.xp6(1),e.MGl("href","https://viewblock.io/arweave/tx/",t.insertPageTxMessage,"",e.LSH),e.xp6(1),e.hij("https://viewblock.io/arweave/tx/",t.insertPageTxMessage," ")}}function Gt(i,n){if(1&i&&(e.TgZ(0,"div",29)(1,"div",30)(2,"h1",31),e._uU(3,"Oops! something went wrong"),e.qZA(),e.TgZ(4,"p",31),e._uU(5),e.qZA()()()),2&i){const t=e.oxw();e.xp6(5),e.Oqu(t.insertPageTxErrorMessage)}}const Bt=[{path:"",canActivateChild:[X.a,V],children:[{path:"pending",component:ve},{path:"approved",component:We},{path:"deleted",component:lt},{path:"tag-manager/:slug",component:At},{path:"page-updates/:slug",component:(()=>{class i{constructor(t,a,o,r,s,d,c){this._arweave=t,this._auth=a,this._snackBar=o,this._dialog=r,this._route=s,this._userSettings=d,this._arwikiTokenContract=c,this.loadingPendingPages=!1,this.pages={},this.pendingPagesSubscription=Z.w.EMPTY,this.arverifyProcessedAddressesMap={},this.loadingInsertPageIntoIndex=!1,this.insertPageTxMessage="",this.insertPageTxErrorMessage="",this.routeLang="",this.baseURL=this._arweave.baseURL,this.pageSlug=""}ngOnInit(){return(0,f.mG)(this,void 0,void 0,function*(){this._auth.getAdminList(),this.routeLang=this._route.snapshot.paramMap.get("lang"),this.pageSlug=this._route.snapshot.paramMap.get("slug"),this.arwikiQuery=new O.x(this._arweave.arweave),this.loadingPendingPages=!0;let o,r=0;try{o=yield this._arweave.arweave.network.getInfo(),r=o.height}catch(s){return void this.message(`${s}`,"error")}this.pendingPagesSubscription=this.arwikiQuery.getPendingPagesUpdates(this.routeLang,this.pageSlug,100,r).pipe((0,_.w)(s=>{let d={};for(let c of s){const g=new b.default(c,this._arweave.arweave);d[g.id]={id:g.id,title:this.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Title"),slug:this.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Slug"),category:this.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Category"),language:this.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Lang"),img:this.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Img"),owner:g.owner.address,block:g.block,value:this.arwikiQuery.searchKeyNameInTags(g.tags,"Arwiki-Page-Value")}}return(0,x.of)(d)}),(0,_.w)(s=>this._arwikiTokenContract.getApprovedPages(this.routeLang,-1,!0).pipe((0,_.w)(d=>{let c={},g=[];for(const p of Object.keys(d)){const l=d[p].updates.map(h=>h.tx);g=g.concat(l)}for(let p in s)g.indexOf(p)>=0||(c[p]=s[p]);return(0,x.of)(c)})))).subscribe({next:s=>(0,f.mG)(this,void 0,void 0,function*(){this.pages=s,this.loadingPendingPages=!1,this.arverifyProcessedAddressesMap={};for(let d of Object.keys(s)){if(Object.prototype.hasOwnProperty.call(this.arverifyProcessedAddressesMap,s[d].owner))continue;const c=yield this.getArverifyVerification(s[d].owner);this.arverifyProcessedAddressesMap[s[d].owner]=c}}),error:s=>{this.message(s,"error"),this.loadingPendingPages=!1}})})}message(t,a="",o){this._snackBar.open(t,"X",{duration:8e3,horizontalPosition:"center",verticalPosition:o,panelClass:a})}ngOnDestroy(){this.pendingPagesSubscription&&this.pendingPagesSubscription.unsubscribe()}getArverifyVerification(t){return(0,f.mG)(this,void 0,void 0,function*(){const a=yield(0,$.Ni)(t);return{verified:a.verified,icon:a.icon,percentage:a.percentage}})}underscoreToSpace(t){return t.replace(/[_]/gi," ")}confirmValidateArWikiPage(t,a,o,r,s){let c="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(Y.f,{data:{title:"Are you sure?",content:"You are about to approve a new arwiki page update. Do you want to proceed?",second_content:"Please define the page update value in $WIKI tokens:",pageValue:r},direction:c}).afterClosed().pipe((0,_.w)(p=>{const l=+p;if(Number.isInteger(l)&&l>0)return this.loadingInsertPageIntoIndex=!0,this._arwikiTokenContract.approvePageUpdate(a,s,t,o,this.routeLang,l,this._auth.getPrivateKey(),L.y[0]);if(0===l)throw Error("Stake must be greater than 0 $WIKI tokens");return(0,x.of)(null)})).subscribe({next:p=>{p&&(this.insertPageTxMessage=`${p}`,this.message("Success!","success"))},error:p=>{this.insertPageTxErrorMessage=`${p}`,this.message(`${p}`,"error")}})}timestampToDate(t){return new Date(1e3*t)}getKeys(t){return Object.keys(t)}compare(t,a){let r="LTR"===this._userSettings.getDefaultLang().writing_system?"ltr":"rtl";this._dialog.open(bt,{data:{newPage:t,slug:a,lang:this.routeLang},direction:r}).afterClosed().subscribe({next:()=>{},error:d=>{this.message(`${d}`,"error")}})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(C.N),e.Y36(y.e),e.Y36(I.ux),e.Y36(v.uw),e.Y36(T.gz),e.Y36(E.s),e.Y36(k.d))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-page-updates"]],decls:7,vars:5,consts:[["title","Pending updates"],["class","spinner-center",4,"ngIf"],[1,"container","page-container","fadeIn"],["class","row",4,"ngIf"],["class","row fadeIn",4,"ngIf"],[1,"spinner-center"],[1,"row"],["class","col-12 card-page fadeIn",4,"ngIf"],["class","col-12 col-md-6 card-page fadeIn",4,"ngFor","ngForOf"],[1,"col-12","card-page","fadeIn"],[1,"col-12","col-md-6","card-page","fadeIn"],[1,"link",3,"routerLink"],["class","card-image text-center",4,"ngIf"],[1,"mbt20"],["class","red mini-text",4,"ngIf"],[1,"mini-text"],[3,"address","isAddress"],[3,"address"],["class","mini-text",4,"ngIf"],["class","green mini-text",4,"ngIf"],[1,"text-right"],["mat-flat-button","","matTooltip","Approve page update",1,"approve-btn","card-btn",3,"click"],["mat-flat-button","","color","primary","matTooltip","Preview",1,"card-btn",3,"routerLink"],["mat-flat-button","","color","primary","matTooltip","Original",1,"card-btn",3,"routerLink"],["mat-flat-button","","color","primary","matTooltip","Compare versions",1,"card-btn",3,"click"],[1,"card-image","text-center"],[3,"src"],[1,"red","mini-text"],[1,"green","mini-text"],[1,"row","fadeIn"],[1,"col","text-center"],[1,"text-center"],["mat-button","","target","_blank",1,"text-center",3,"href"]],template:function(t,a){1&t&&(e._UZ(0,"app-moderators-menu",0),e.YNc(1,Ut,1,0,"mat-spinner",1),e.TgZ(2,"div",2),e.YNc(3,Qt,3,2,"div",3),e.YNc(4,jt,5,0,"div",4),e.YNc(5,Rt,8,3,"div",4),e.YNc(6,Gt,6,1,"div",4),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",a.loadingPendingPages),e.xp6(2),e.Q6J("ngIf",!a.loadingInsertPageIntoIndex),e.xp6(1),e.Q6J("ngIf",a.loadingInsertPageIntoIndex&&!a.insertPageTxMessage&&!a.insertPageTxErrorMessage),e.xp6(1),e.Q6J("ngIf",a.insertPageTxMessage),e.xp6(1),e.Q6J("ngIf",a.insertPageTxErrorMessage))},directives:[S,m.O5,N.Ou,m.sg,Q.a8,T.rH,j.N,P.Hw,w.zs,R.gM,T.yS],pipes:[q.X$,m.uU],styles:[".page-container[_ngcontent-%COMP%]{min-height:600px}.w70[_ngcontent-%COMP%]{width:70%}.ml10[_ngcontent-%COMP%]{margin-left:10px}.w100[_ngcontent-%COMP%]{width:100%}.w50[_ngcontent-%COMP%]{width:50%}.card-page[_ngcontent-%COMP%]{margin-bottom:40px}.approve-btn[_ngcontent-%COMP%]{background-color:#63c642;color:#fff}.link[_ngcontent-%COMP%]{cursor:pointer}.mini-text[_ngcontent-%COMP%]{font-size:12px}.mbt20[_ngcontent-%COMP%]{margin-bottom:20px;margin-top:20px}.card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.card-btn[_ngcontent-%COMP%]{margin-left:5px;margin-bottom:5px}"]}),i})()},{path:"add-admin",component:xe},{path:"view-admin-list",component:we},{path:"",redirectTo:"pending",pathMatch:"full"}]}];let $t=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[T.Bz.forChild(Bt)],T.Bz]}),i})(),Ht=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[m.ez,$t,F.m]]}),i})()}}]);